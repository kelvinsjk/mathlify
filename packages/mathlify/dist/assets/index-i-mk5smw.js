var _r=Object.defineProperty;var qr=(e,t,r)=>t in e?_r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var V=(e,t,r)=>(qr(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();class Oe{constructor(t){this.name=t}toString(){return this.name}clone(){return new Oe(this.name)}}function me(...e){if(e.length===0)throw new Error("no arguments provided to gcd function");if(e.length===1){const s=e[0];if(!Number.isInteger(s))throw new Error(`non-integer ${s} received in gcd function`);if(s===0)throw new Error("gcd(0) is undefined");return Math.abs(s)}if(e.length===2)return ht(e[0],e[1]);const[t,r,...n]=e;return t===0&&r===0?me(0,...n):me(ht(t,r),...n)}function ht(e,t){if(!Number.isInteger(e)||!Number.isInteger(t))throw new Error(`Non-integers (${e}, ${t}) received in gcd function`);if(e=Math.abs(e),t=Math.abs(t),e===0&&t===0)throw new Error("gcd(0,0) not defined");if(e===0||t===0)return Math.max(e,t);for(;t!==0;)[e,t]=[t,e%t];return e}function We(e,t){if(!Number.isInteger(e)||!Number.isInteger(t))throw new Error(`Non-integers (${e}, ${t}) received in lcm function`);if(e===0||t===0)throw new Error("lcm(0) is undefined");const r=me(e,t);return Math.abs(e*t)/r}class U{constructor(t,r=1){V(this,"num");V(this,"den");V(this,"is",{positive:()=>this.valueOf()>0,negative:()=>this.valueOf()<0,zero:()=>this.valueOf()===0,nonzero:()=>!this.is.zero(),integer:()=>Number.isInteger(this.valueOf()),nonnegative:()=>this.valueOf()>=0,one:()=>this.num===this.den,negative_one:()=>this.num===-this.den});if(r===0)throw new RangeError("0 denominator received in fraction constructor");if(!Number.isInteger(t)||!Number.isInteger(r))throw console.error(`numerator and denominators should be integers. ${t} and ${r} received.`),new RangeError("non-integers received in Fraction constructor");this.num=t,this.den=r}_hoist_negative(){return this.den<0&&(this.num*=-1,this.den*=-1),this}simplify(){this._hoist_negative();const t=me(this.num,this.den);return this.num/=t,this.den/=t,this}clone(){return new U(this.num,this.den)}valueOf(){return this.num/this.den}toString(){const t=this.num<0?`- ${-this.num}`:`${this.num}`;if(this.den===1)return t;if(this.den<0){const r=`- ${-this.den}`;return`\\frac{${t}}{${r}}`}else{const r=U.sign(this)===1?"":"- ",n=Math.abs(this.num);return`${r}\\frac{${n}}{${this.den}}`}}toFixed(t){return this.valueOf().toFixed(t)}toPrecision(t){return this.valueOf().toPrecision(t)}plus(t){const r=new U(this.num*t.den+t.num*this.den,this.den*t.den);return r.simplify(),r}times(t){const r=new U(this.num*t.num,this.den*t.den);return r.simplify(),r}abs(){return new U(Math.abs(this.num),Math.abs(this.den))}static sign(t){return Math.sign(t.valueOf())}static gcd(...t){if(t.length===0)throw new RangeError("no fractions received in gcd");if(t.length===1){const n=t[0];if(n.is.zero())throw new RangeError("gcd(0) is undefined");return n.abs()}if(t.length===2){const[n,s]=t;return new U(me(n.num,s.num),We(n.den,s.den)).simplify()}let r=t[0];t.shift();for(let n of t)r=U.gcd(r,n);return r}static lcm(...t){if(t.length===0)throw new RangeError("no fractions received in lcm");if(t.length===1){const n=t[0];if(n.is.zero())throw new RangeError("lcm(0) is undefined");return n.abs()}if(t.length===2){const[n,s]=t;return new U(We(n.num,s.num),me(n.den,s.den)).simplify()}let r=t[0];t.shift();for(let n of t)r=U.lcm(r,n);return r}}class N{constructor(t,r){V(this,"number");V(this,"is",{one:()=>this.number.is.one(),negative_one:()=>this.number.is.negative_one(),zero:()=>this.number.is.zero()});typeof t=="number"?t=new U(t):Array.isArray(t)?t=new U(t[0],t[1]):t=t.clone(),this.number=t;const{verbatim:n}={verbatim:!1,...r};n||this.simplify()}simplify(){return this.number.simplify(),this}toString(){return this.number.toString()}clone(){return new N(this.number.clone(),{verbatim:!0})}plus(t){return typeof t=="number"?t=new U(t):t instanceof N&&(t=t.number),new N(this.number.plus(t))}times(t){return typeof t=="number"?t=new U(t):t instanceof N&&(t=t.number),new N(this.number.times(t))}abs(){return new N(this.number.abs())}}class Q{constructor(...t){V(this,"coeff");V(this,"factors");V(this,"is",{negative:()=>this.coeff.number.is.negative()});if(t.length===0){this.coeff=new N(1),this.factors=[];return}let r=new N(1),n=t[0];(n instanceof U||typeof n=="number")&&(n=new N(n,{verbatim:!0})),n instanceof N&&(n=new z(n)),n instanceof z&&n.is.numeral()&&(r=n.try.into.numeral(),t.shift()),this.factors=t.map(s=>s instanceof z?s:new z(s)),this.coeff=r}toString(t){const{multiplicationSign:r}={multiplicationSign:"",...t};if(this.factors.length===0)return this.coeff.toString();let n=this.coeff.is.one()?"":this.coeff.is.negative_one()?"- ":`${this.coeff}`;r&&this.coeff.is.negative_one()&&(n="- 1");for(let s of this.factors){const i=s.expression,u=n===""?"":r;i instanceof N&&i.number.is.negative()||i instanceof ee&&i.terms.length>1?n+=`${u}\\left( ${s} \\right)`:n+=`${u}${s}`}return n}clone(){const t=this.factors.map(r=>r.clone());return new Q(this.coeff.clone(),...t)}simplify(t){const{product:r,numeral:n,sum:s}={product:!0,numeral:!0,sum:!0,...t};for(let i of this.factors)i.simplify({product:r,numeral:n,sum:s});return r&&(this._flatten(),this._extract_numerals()),this}_extract_numerals(){const t=[];let r=this.coeff;for(let n=0;n<this.factors.length;n++){const s=this.factors[n].expression;s instanceof N&&(t.push(n),r=r.times(s.number))}return t.length<=0?this:(this.factors=this.factors.filter((n,s)=>!t.includes(s)),this.coeff=r,this)}_flatten(){let t=this.coeff,r=[];for(const n of this.factors){const s=n.expression;s instanceof ee?(s._flatten(),r.push(n)):s instanceof Q?(s._flatten(),t=t.times(s.coeff),r=r.concat(s.factors)):r.push(n)}return this.factors=r,this.coeff=t,this}}class ee{constructor(...t){V(this,"terms");const r=t.map(n=>n instanceof z?n:new z(n));this.terms=r}toString(){if(this.terms.length===0)return"0";if(this.terms.length===1)return this.terms[0].toString();let r=`${this.terms[0]}`;for(let n of this.terms.slice(1)){const s=n.expression;s instanceof N&&s.number.is.negative()||s instanceof Q&&s.is.negative()?r+=` ${s}`:r+=` + ${n}`}return r}clone(){const t=this.terms.map(r=>r.clone());return new ee(...t)}simplify(t){const{product:r,numeral:n,sum:s}={product:!0,numeral:!0,sum:!0,...t};for(let i of this.terms)i.simplify({product:r,numeral:n,sum:s});return s&&(this._flatten(),this._combine_numerals(),this._remove_zeroes()),this}_combine_numerals(){const t=[];let r=new U(0);for(let s=0;s<this.terms.length;s++){const i=this.terms[s].expression;i instanceof N&&(t.push(s),r=r.plus(i.number))}if(t.length<=1)return this;const n=t[0];return this.terms[n].expression=new N(r),t.shift(),this.terms=this.terms.filter((s,i)=>!t.includes(i)),this}_remove_zeroes(){return this.terms=this.terms.filter(t=>{const r=t.expression;return r instanceof N?r.number.is.nonzero():!0}),this}_flatten(){const t=[];for(const r of this.terms){const n=r.expression;n instanceof ee?(n._flatten(),t.push(...n.terms)):(n instanceof Q&&n._flatten(),t.push(r))}return this.terms=t,this}}class Ce{constructor(t){V(this,"expression");this.expression=t instanceof z?t:new z(t)}toString(){return`\\left( ${this.expression} \\right)`}clone(){return new Ce(this.expression.clone())}}class ge{constructor(t){V(this,"fn");this.fn=t}toString(){return this.fn.toString()}clone(){return new ge(this.fn.clone())}}class z{constructor(t){V(this,"expression");V(this,"multiplicationSign","");V(this,"is",{sum:()=>this.expression instanceof ee,product:()=>this.expression instanceof Q,variable:()=>this.expression instanceof Oe,numeral:()=>this.expression instanceof N,brackets:()=>this.expression instanceof ge&&this.expression.fn instanceof Ce});V(this,"try",{into:{sum:()=>{if(this.is.sum())return this.expression;throw new Error("Cannot cast to Sum")},product:()=>{if(this.is.product())return this.expression;throw new Error("Cannot cast to Product")},variable:()=>{if(this.is.variable())return this.expression;throw new Error("Cannot cast to Variable")},numeral:()=>{if(this.is.numeral())return this.expression;throw new Error("Cannot cast to Numeral")},brackets:()=>{if(this.is.brackets())return this.expression.fn;throw new Error("Cannot cast to Brackets")}}});typeof t=="string"?t=new Oe(t):(typeof t=="number"||t instanceof U)&&(t=new N(t,{verbatim:!0})),this.expression=t}toString(t){return t={multiplicationSign:this.multiplicationSign,...t},this.expression.toString(t)}simplify(t){t===void 0&&(t={brackets:!0,product:!0,sum:!0,numeral:!0});const{brackets:r,product:n,sum:s,numeral:i}={brackets:!1,product:!1,sum:!1,numeral:!1,...t};return r&&this._remove_brackets(),i&&this.expression instanceof N&&this.expression.simplify(),(this.expression instanceof ee||this.expression instanceof Q)&&this.expression.simplify({product:n,sum:s,numeral:i}),this._remove_singletons({product:n,sum:s}),this}_remove_singletons(t){const{product:r,sum:n}={product:!0,sum:!0,...t};return n&&this.expression instanceof ee?this.expression.terms.length===0?this.expression=new N(0):this.expression.terms.length===1&&(this.expression=this.expression.terms[0].expression):r&&this.expression instanceof Q&&(this.expression.factors.length===0?this.expression=this.expression.coeff:this.expression.factors.length===1&&this.expression.coeff.is.one()&&(this.expression=this.expression.factors[0].expression)),this}_remove_brackets(){if(this.expression instanceof ee)for(const t of this.expression.terms)t._remove_brackets();else if(this.expression instanceof Q)for(const t of this.expression.factors)t._remove_brackets();return this.expression instanceof ge&&(this.expression=this.expression.fn.expression.expression),this}clone(){return new z(this.expression.clone())}static brackets(t){return new z(new ge(new Ce(t)))}static denominator_lcm(...t){if(t.length===0)throw new Error("Cannot find denominator lcm of empty array");if(t.length===1){let n=t[0];return n.expression instanceof N?new z(new N(n.expression.number.den).abs()):new z(1)}if(t.length===2){const[n,s]=t;return n.expression instanceof N?s.expression instanceof N?new z(new N(We(n.expression.number.den,s.expression.number.den))):z.denominator_lcm(n):s.expression instanceof N?z.denominator_lcm(s):new z(1)}let r=t[0];t.shift();for(let n of t)r=z.denominator_lcm(r,n);return r}}function Re(e,t=1,r){const n=new N([e,t],r);return new z(n)}function re(...e){const t=[];for(const r of e){const n=Zt(r);Array.isArray(n)?t.push(Tr(...n)):t.push(n)}return new z(new ee(...t))}function Tr(...e){const t=[];for(const r of e){const n=Zt(r);Array.isArray(n)?t.push(re(...n)):t.push(n)}return new z(new Q(...t))}function Zt(e){if(Array.isArray(e)){if(e.length===3&&e[1]==="/"&&typeof e[0]=="number"&&typeof e[2]=="number")return Re(e[0],e[2]);if(e.length===2&&e[0]==="()"){const t=e[1];if(Array.isArray(t)){if(t.length===3)return Re(t[0],t[2]);throw new Error("unexpected nested brackets")}else return z.brackets(t)}else{const t=[];for(const r of e)if(Array.isArray(r))if(r.length===3&&r[1]==="/"&&typeof r[0]=="number"&&typeof r[2]=="number")t.push(Re(r[0],r[2]));else if(r.length===2&&r[0]==="()"&&(r[1]instanceof z||typeof r[1]=="number"||typeof r[1]=="string"))t.push(z.brackets(r[1]));else throw new Error("unexpected nested product/sum");else t.push(r);return t}}else{if(e===void 0)throw new Error("invalid shorthand");return e}}class x{constructor(t,r){let n=" "+t,s;const i=r&&r.loc;if(i&&i.start<=i.end){const c=i.lexer.input;s=i.start;const h=i.end;s===c.length?n+=" at end of input: ":n+=" at position "+(s+1)+": ";const y=c.slice(s,h).replace(/[^]/g,"$&̲");let S;s>15?S="…"+c.slice(s-15,s):S=c.slice(0,s);let _;h+15<c.length?_=c.slice(h,h+15)+"…":_=c.slice(h),n+=S+y+_}const u=new Error(n);return u.name="ParseError",u.__proto__=x.prototype,u.position=s,u}}x.prototype.__proto__=Error.prototype;const $r=function(e,t){return e===void 0?t:e},Dr=/([A-Z])/g,Or=function(e){return e.replace(Dr,"-$1").toLowerCase()},Cr={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},Nr=/[&><"']/g;function Br(e){return String(e).replace(Nr,t=>Cr[t])}const be=function(e){return e.type==="ordgroup"||e.type==="color"?e.body.length===1?be(e.body[0]):e:e.type==="font"?be(e.body):e},Mr=function(e){const t=be(e);return t.type==="mathord"||t.type==="textord"||t.type==="atom"},Er=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e},zr=function(e){const t=/^\s*([^\\/#]*?)(?::|&#0*58|&#x0*3a)/i.exec(e);return t!=null?t[1]:"_relative"},Lr=function(e){return+e.toFixed(4)};var C={deflt:$r,escape:Br,hyphenate:Or,getBaseElem:be,isCharacterBox:Mr,protocolFromUrl:zr,round:Lr};class Ke{constructor(t){t=t||{},this.displayMode=C.deflt(t.displayMode,!1),this.annotate=C.deflt(t.annotate,!1),this.leqno=C.deflt(t.leqno,!1),this.throwOnError=C.deflt(t.throwOnError,!1),this.errorColor=C.deflt(t.errorColor,"#b22222"),this.macros=t.macros||{},this.wrap=C.deflt(t.wrap,"tex"),this.xml=C.deflt(t.xml,!1),this.colorIsTextColor=C.deflt(t.colorIsTextColor,!1),this.strict=C.deflt(t.strict,!1),this.trust=C.deflt(t.trust,!1),this.maxSize=t.maxSize===void 0?[1/0,1/0]:Array.isArray(t.maxSize)?t.maxSize:[1/0,1/0],this.maxExpand=Math.max(0,C.deflt(t.maxExpand,1e3))}isTrusted(t){return t.url&&!t.protocol&&(t.protocol=C.protocolFromUrl(t.url)),!!(typeof this.trust=="function"?this.trust(t):this.trust)}}const Xt={},Ne={};function k({type:e,names:t,props:r,handler:n,mathmlBuilder:s}){const i={type:e,numArgs:r.numArgs,argTypes:r.argTypes,allowedInArgument:!!r.allowedInArgument,allowedInText:!!r.allowedInText,allowedInMath:r.allowedInMath===void 0?!0:r.allowedInMath,numOptionalArgs:r.numOptionalArgs||0,infix:!!r.infix,primitive:!!r.primitive,handler:n};for(let u=0;u<t.length;++u)Xt[t[u]]=i;e&&s&&(Ne[e]=s)}function ce({type:e,mathmlBuilder:t}){k({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},mathmlBuilder:t})}const ye=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e},L=function(e){return e.type==="ordgroup"?e.body:[e]};class Je{constructor(t){this.children=t,this.classes=[],this.style={}}hasClass(t){return this.classes.includes(t)}toNode(){const t=document.createDocumentFragment();for(let r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t}toMarkup(){let t="";for(let r=0;r<this.children.length;r++)t+=this.children[r].toMarkup();return t}toText(){const t=r=>r.toText();return this.children.map(t).join("")}}const Be=function(e){return e.filter(t=>t).join(" ")},Ir=function(e,t){this.classes=e||[],this.attributes={},this.style=t||{}},Fr=function(e){const t=document.createElement(e);t.className=Be(this.classes);for(const r in this.style)Object.prototype.hasOwnProperty.call(this.style,r)&&(t.style[r]=this.style[r]);for(const r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&t.setAttribute(r,this.attributes[r]);for(let r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t},Pr=function(e){let t=`<${e}`;this.classes.length&&(t+=` class="${C.escape(Be(this.classes))}"`);let r="";for(const n in this.style)Object.prototype.hasOwnProperty.call(this.style,n)&&(r+=`${C.hyphenate(n)}:${this.style[n]};`);r&&(t+=` style="${r}"`);for(const n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(t+=` ${n}="${C.escape(this.attributes[n])}"`);t+=">";for(let n=0;n<this.children.length;n++)t+=this.children[n].toMarkup();return t+=`</${e}>`,t};class Yt{constructor(t,r,n){Ir.call(this,t,n),this.children=r||[]}setAttribute(t,r){this.attributes[t]=r}toNode(){return Fr.call(this,"span")}toMarkup(){return Pr.call(this,"span")}}class Gr{constructor(t){this.text=t}toNode(){return document.createTextNode(this.text)}toMarkup(){return C.escape(this.text)}}class Rr{constructor(t,r,n){this.alt=r,this.src=t,this.classes=["mord"],this.style=n}hasClass(t){return this.classes.includes(t)}toNode(){const t=document.createElement("img");t.src=this.src,t.alt=this.alt,t.className="mord";for(const r in this.style)Object.prototype.hasOwnProperty.call(this.style,r)&&(t.style[r]=this.style[r]);return t}toMarkup(){let t=`<img src='${this.src}' alt='${this.alt}'`,r="";for(const n in this.style)Object.prototype.hasOwnProperty.call(this.style,n)&&(r+=`${C.hyphenate(n)}:${this.style[n]};`);return r&&(t+=` style="${C.escape(r)}"`),t+=">",t}}function jr(e){return new Je(e)}class W{constructor(t,r,n,s){this.type=t,this.attributes={},this.children=r||[],this.classes=n||[],this.style=s||{}}setAttribute(t,r){this.attributes[t]=r}getAttribute(t){return this.attributes[t]}toNode(){const t=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(const r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&t.setAttribute(r,this.attributes[r]);this.classes.length>0&&(t.className=Be(this.classes));for(const r in this.style)Object.prototype.hasOwnProperty.call(this.style,r)&&(t.style[r]=this.style[r]);for(let r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t}toMarkup(){let t="<"+this.type;for(const n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(t+=" "+n+'="',t+=C.escape(this.attributes[n]),t+='"');this.classes.length>0&&(t+=` class="${C.escape(Be(this.classes))}"`);let r="";for(const n in this.style)Object.prototype.hasOwnProperty.call(this.style,n)&&(r+=`${C.hyphenate(n)}:${this.style[n]};`);r&&(t+=` style="${r}"`),t+=">";for(let n=0;n<this.children.length;n++)t+=this.children[n].toMarkup();return t+="</"+this.type+">",t}toText(){return this.children.map(t=>t.toText()).join("")}}class Kt{constructor(t){this.text=t}toNode(){return document.createTextNode(this.text)}toMarkup(){return C.escape(this.toText())}toText(){return this.text}}const Qe=e=>{let t;return e.length===1&&e[0].type==="mrow"?(t=e.pop(),t.type="mstyle"):t=new W("mstyle",e),t};var p={MathNode:W,TextNode:Kt,newDocumentFragment:jr};const fe=e=>{let t=0;if(e.body)for(const r of e.body)t+=fe(r);else if(e.type==="supsub")t+=fe(e.base),e.sub&&(t+=.7*fe(e.sub)),e.sup&&(t+=.7*fe(e.sup));else if(e.type==="mathord"||e.type==="textord")for(const r of e.text.split("")){const n=r.codePointAt(0);96<n&&n<123||944<n&&n<970?t+=.56:47<n&&n<58?t+=.5:t+=.92}else t+=1;return t},Ur={widehat:"^",widecheck:"ˇ",widetilde:"~",wideparen:"⏜",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",overparen:"⏜",undergroup:"⏡",underparen:"⏝",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xrightleftarrows:"⇄",yields:"→",yieldsLeft:"←",mesomerism:"↔",longrightharpoonup:"⇀",longleftharpoondown:"↽",eqrightharpoonup:"⇀",eqleftharpoondown:"↽","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},Jt=function(e){const t=new p.TextNode(Ur[e.slice(1)]),r=new p.MathNode("mo",[t]);return r.setAttribute("stretchy","true"),r},Vr=["\\widetilde","\\widehat","\\widecheck","\\utilde"],Wr=e=>{const t=Jt(e.label);if(Vr.includes(e.label)){const r=fe(e.base);1<r&&r<1.6?t.classes.push("tml-crooked-2"):1.6<=r&&r<2.5?t.classes.push("tml-crooked-3"):2.5<=r&&t.classes.push("tml-crooked-4")}return t};var ze={mathMLnode:Jt,accentNode:Wr};const Hr={bin:1,close:1,inner:1,open:1,punct:1,rel:1},Zr={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},P={math:{},text:{}};function o(e,t,r,n,s){P[e][n]={group:t,replace:r},s&&r&&(P[e][r]=P[e][n])}const a="math",f="text",D="accent-token",A="bin",I="close",de="inner",w="mathord",O="op-token",G="open",ke="punct",d="rel",se="spacing",m="textord";o(a,d,"≡","\\equiv",!0);o(a,d,"≺","\\prec",!0);o(a,d,"≻","\\succ",!0);o(a,d,"∼","\\sim",!0);o(a,d,"⟂","\\perp",!0);o(a,d,"⪯","\\preceq",!0);o(a,d,"⪰","\\succeq",!0);o(a,d,"≃","\\simeq",!0);o(a,d,"≌","\\backcong",!0);o(a,d,"|","\\mid",!0);o(a,d,"≪","\\ll",!0);o(a,d,"≫","\\gg",!0);o(a,d,"≍","\\asymp",!0);o(a,d,"∥","\\parallel");o(a,d,"⌣","\\smile",!0);o(a,d,"⊑","\\sqsubseteq",!0);o(a,d,"⊒","\\sqsupseteq",!0);o(a,d,"≐","\\doteq",!0);o(a,d,"⌢","\\frown",!0);o(a,d,"∋","\\ni",!0);o(a,d,"∌","\\notni",!0);o(a,d,"∝","\\propto",!0);o(a,d,"⊢","\\vdash",!0);o(a,d,"⊣","\\dashv",!0);o(a,d,"∋","\\owns");o(a,d,"≘","\\arceq",!0);o(a,d,"≙","\\wedgeq",!0);o(a,d,"≚","\\veeeq",!0);o(a,d,"≛","\\stareq",!0);o(a,d,"≝","\\eqdef",!0);o(a,d,"≞","\\measeq",!0);o(a,d,"≟","\\questeq",!0);o(a,d,"≠","\\ne",!0);o(a,d,"≠","\\neq");o(a,d,"⩵","\\eqeq",!0);o(a,d,"⩶","\\eqeqeq",!0);o(a,d,"∷","\\dblcolon",!0);o(a,d,"≔","\\coloneqq",!0);o(a,d,"≕","\\eqqcolon",!0);o(a,d,"∹","\\eqcolon",!0);o(a,d,"⩴","\\Coloneqq",!0);o(a,ke,".","\\ldotp");o(a,ke,"·","\\cdotp");o(a,m,"#","\\#");o(f,m,"#","\\#");o(a,m,"&","\\&");o(f,m,"&","\\&");o(a,m,"ℵ","\\aleph",!0);o(a,m,"∀","\\forall",!0);o(a,m,"ℏ","\\hbar",!0);o(a,m,"∃","\\exists",!0);o(a,A,"∇","\\nabla",!0);o(a,m,"♭","\\flat",!0);o(a,m,"ℓ","\\ell",!0);o(a,m,"♮","\\natural",!0);o(a,m,"Å","\\Angstrom",!0);o(f,m,"Å","\\Angstrom",!0);o(a,m,"♣","\\clubsuit",!0);o(a,m,"♧","\\varclubsuit",!0);o(a,m,"℘","\\wp",!0);o(a,m,"♯","\\sharp",!0);o(a,m,"♢","\\diamondsuit",!0);o(a,m,"♦","\\vardiamondsuit",!0);o(a,m,"ℜ","\\Re",!0);o(a,m,"♡","\\heartsuit",!0);o(a,m,"♥","\\varheartsuit",!0);o(a,m,"ℑ","\\Im",!0);o(a,m,"♠","\\spadesuit",!0);o(a,m,"♤","\\varspadesuit",!0);o(a,m,"♀","\\female",!0);o(a,m,"♂","\\male",!0);o(a,m,"§","\\S",!0);o(f,m,"§","\\S");o(a,m,"¶","\\P",!0);o(f,m,"¶","\\P");o(f,m,"☺","\\smiley",!0);o(a,m,"☺","\\smiley",!0);o(a,m,"†","\\dag");o(f,m,"†","\\dag");o(f,m,"†","\\textdagger");o(a,m,"‡","\\ddag");o(f,m,"‡","\\ddag");o(f,m,"‡","\\textdaggerdbl");o(a,I,"⎱","\\rmoustache",!0);o(a,G,"⎰","\\lmoustache",!0);o(a,I,"⟯","\\rgroup",!0);o(a,G,"⟮","\\lgroup",!0);o(a,A,"∓","\\mp",!0);o(a,A,"⊖","\\ominus",!0);o(a,A,"⊎","\\uplus",!0);o(a,A,"⊓","\\sqcap",!0);o(a,A,"∗","\\ast");o(a,A,"⊔","\\sqcup",!0);o(a,A,"◯","\\bigcirc",!0);o(a,A,"∙","\\bullet",!0);o(a,A,"‡","\\ddagger");o(a,A,"≀","\\wr",!0);o(a,A,"⨿","\\amalg");o(a,A,"&","\\And");o(a,A,"⫽","\\sslash",!0);o(a,d,"⟵","\\longleftarrow",!0);o(a,d,"⇐","\\Leftarrow",!0);o(a,d,"⟸","\\Longleftarrow",!0);o(a,d,"⟶","\\longrightarrow",!0);o(a,d,"⇒","\\Rightarrow",!0);o(a,d,"⟹","\\Longrightarrow",!0);o(a,d,"↔","\\leftrightarrow",!0);o(a,d,"⟷","\\longleftrightarrow",!0);o(a,d,"⇔","\\Leftrightarrow",!0);o(a,d,"⟺","\\Longleftrightarrow",!0);o(a,d,"↤","\\mapsfrom",!0);o(a,d,"↦","\\mapsto",!0);o(a,d,"⟼","\\longmapsto",!0);o(a,d,"↗","\\nearrow",!0);o(a,d,"↩","\\hookleftarrow",!0);o(a,d,"↪","\\hookrightarrow",!0);o(a,d,"↘","\\searrow",!0);o(a,d,"↼","\\leftharpoonup",!0);o(a,d,"⇀","\\rightharpoonup",!0);o(a,d,"↙","\\swarrow",!0);o(a,d,"↽","\\leftharpoondown",!0);o(a,d,"⇁","\\rightharpoondown",!0);o(a,d,"↖","\\nwarrow",!0);o(a,d,"⇌","\\rightleftharpoons",!0);o(a,w,"↯","\\lightning",!0);o(a,w,"∎","\\QED",!0);o(a,w,"‰","\\permil",!0);o(f,m,"‰","\\permil");o(a,w,"☉","\\astrosun",!0);o(a,w,"☼","\\sun",!0);o(a,w,"☾","\\leftmoon",!0);o(a,w,"☽","\\rightmoon",!0);o(a,d,"≮","\\nless",!0);o(a,d,"⪇","\\lneq",!0);o(a,d,"≨","\\lneqq",!0);o(a,d,"≨︀","\\lvertneqq");o(a,d,"⋦","\\lnsim",!0);o(a,d,"⪉","\\lnapprox",!0);o(a,d,"⊀","\\nprec",!0);o(a,d,"⋠","\\npreceq",!0);o(a,d,"⋨","\\precnsim",!0);o(a,d,"⪹","\\precnapprox",!0);o(a,d,"≁","\\nsim",!0);o(a,d,"∤","\\nmid",!0);o(a,d,"∤","\\nshortmid");o(a,d,"⊬","\\nvdash",!0);o(a,d,"⊭","\\nvDash",!0);o(a,d,"⋪","\\ntriangleleft");o(a,d,"⋬","\\ntrianglelefteq",!0);o(a,d,"⊄","\\nsubset",!0);o(a,d,"⊅","\\nsupset",!0);o(a,d,"⊊","\\subsetneq",!0);o(a,d,"⊊︀","\\varsubsetneq");o(a,d,"⫋","\\subsetneqq",!0);o(a,d,"⫋︀","\\varsubsetneqq");o(a,d,"≯","\\ngtr",!0);o(a,d,"⪈","\\gneq",!0);o(a,d,"≩","\\gneqq",!0);o(a,d,"≩︀","\\gvertneqq");o(a,d,"⋧","\\gnsim",!0);o(a,d,"⪊","\\gnapprox",!0);o(a,d,"⊁","\\nsucc",!0);o(a,d,"⋡","\\nsucceq",!0);o(a,d,"⋩","\\succnsim",!0);o(a,d,"⪺","\\succnapprox",!0);o(a,d,"≆","\\ncong",!0);o(a,d,"∦","\\nparallel",!0);o(a,d,"∦","\\nshortparallel");o(a,d,"⊯","\\nVDash",!0);o(a,d,"⋫","\\ntriangleright");o(a,d,"⋭","\\ntrianglerighteq",!0);o(a,d,"⊋","\\supsetneq",!0);o(a,d,"⊋","\\varsupsetneq");o(a,d,"⫌","\\supsetneqq",!0);o(a,d,"⫌︀","\\varsupsetneqq");o(a,d,"⊮","\\nVdash",!0);o(a,d,"⪵","\\precneqq",!0);o(a,d,"⪶","\\succneqq",!0);o(a,A,"⊴","\\unlhd");o(a,A,"⊵","\\unrhd");o(a,d,"↚","\\nleftarrow",!0);o(a,d,"↛","\\nrightarrow",!0);o(a,d,"⇍","\\nLeftarrow",!0);o(a,d,"⇏","\\nRightarrow",!0);o(a,d,"↮","\\nleftrightarrow",!0);o(a,d,"⇎","\\nLeftrightarrow",!0);o(a,d,"△","\\vartriangle");o(a,m,"ℏ","\\hslash");o(a,m,"▽","\\triangledown");o(a,m,"◊","\\lozenge");o(a,m,"Ⓢ","\\circledS");o(a,m,"®","\\circledR",!0);o(f,m,"®","\\circledR");o(f,m,"®","\\textregistered");o(a,m,"∡","\\measuredangle",!0);o(a,m,"∄","\\nexists");o(a,m,"℧","\\mho");o(a,m,"Ⅎ","\\Finv",!0);o(a,m,"⅁","\\Game",!0);o(a,m,"‵","\\backprime");o(a,m,"‶","\\backdprime");o(a,m,"‷","\\backtrprime");o(a,m,"▲","\\blacktriangle");o(a,m,"▼","\\blacktriangledown");o(a,m,"■","\\blacksquare");o(a,m,"⧫","\\blacklozenge");o(a,m,"★","\\bigstar");o(a,m,"∢","\\sphericalangle",!0);o(a,m,"∁","\\complement",!0);o(a,m,"ð","\\eth",!0);o(f,m,"ð","ð");o(a,m,"╱","\\diagup");o(a,m,"╲","\\diagdown");o(a,m,"□","\\square");o(a,m,"□","\\Box");o(a,m,"◊","\\Diamond");o(a,m,"¥","\\yen",!0);o(f,m,"¥","\\yen",!0);o(a,m,"✓","\\checkmark",!0);o(f,m,"✓","\\checkmark");o(a,m,"✗","\\ballotx",!0);o(f,m,"✗","\\ballotx");o(f,m,"•","\\textbullet");o(a,m,"ℶ","\\beth",!0);o(a,m,"ℸ","\\daleth",!0);o(a,m,"ℷ","\\gimel",!0);o(a,m,"ϝ","\\digamma",!0);o(a,m,"ϰ","\\varkappa");o(a,G,"⌜","\\ulcorner",!0);o(a,I,"⌝","\\urcorner",!0);o(a,G,"⌞","\\llcorner",!0);o(a,I,"⌟","\\lrcorner",!0);o(a,d,"≦","\\leqq",!0);o(a,d,"⩽","\\leqslant",!0);o(a,d,"⪕","\\eqslantless",!0);o(a,d,"≲","\\lesssim",!0);o(a,d,"⪅","\\lessapprox",!0);o(a,d,"≊","\\approxeq",!0);o(a,A,"⋖","\\lessdot");o(a,d,"⋘","\\lll",!0);o(a,d,"≶","\\lessgtr",!0);o(a,d,"⋚","\\lesseqgtr",!0);o(a,d,"⪋","\\lesseqqgtr",!0);o(a,d,"≑","\\doteqdot");o(a,d,"≓","\\risingdotseq",!0);o(a,d,"≒","\\fallingdotseq",!0);o(a,d,"∽","\\backsim",!0);o(a,d,"⋍","\\backsimeq",!0);o(a,d,"⫅","\\subseteqq",!0);o(a,d,"⋐","\\Subset",!0);o(a,d,"⊏","\\sqsubset",!0);o(a,d,"≼","\\preccurlyeq",!0);o(a,d,"⋞","\\curlyeqprec",!0);o(a,d,"≾","\\precsim",!0);o(a,d,"⪷","\\precapprox",!0);o(a,d,"⊲","\\vartriangleleft");o(a,d,"⊴","\\trianglelefteq");o(a,d,"⊨","\\vDash",!0);o(a,d,"⊫","\\VDash",!0);o(a,d,"⊪","\\Vvdash",!0);o(a,d,"⌣","\\smallsmile");o(a,d,"⌢","\\smallfrown");o(a,d,"≏","\\bumpeq",!0);o(a,d,"≎","\\Bumpeq",!0);o(a,d,"≧","\\geqq",!0);o(a,d,"⩾","\\geqslant",!0);o(a,d,"⪖","\\eqslantgtr",!0);o(a,d,"≳","\\gtrsim",!0);o(a,d,"⪆","\\gtrapprox",!0);o(a,A,"⋗","\\gtrdot");o(a,d,"⋙","\\ggg",!0);o(a,d,"≷","\\gtrless",!0);o(a,d,"⋛","\\gtreqless",!0);o(a,d,"⪌","\\gtreqqless",!0);o(a,d,"≖","\\eqcirc",!0);o(a,d,"≗","\\circeq",!0);o(a,d,"≜","\\triangleq",!0);o(a,d,"∼","\\thicksim");o(a,d,"≈","\\thickapprox");o(a,d,"⫆","\\supseteqq",!0);o(a,d,"⋑","\\Supset",!0);o(a,d,"⊐","\\sqsupset",!0);o(a,d,"≽","\\succcurlyeq",!0);o(a,d,"⋟","\\curlyeqsucc",!0);o(a,d,"≿","\\succsim",!0);o(a,d,"⪸","\\succapprox",!0);o(a,d,"⊳","\\vartriangleright");o(a,d,"⊵","\\trianglerighteq");o(a,d,"⊩","\\Vdash",!0);o(a,d,"∣","\\shortmid");o(a,d,"∥","\\shortparallel");o(a,d,"≬","\\between",!0);o(a,d,"⋔","\\pitchfork",!0);o(a,d,"∝","\\varpropto");o(a,d,"◀","\\blacktriangleleft");o(a,d,"∴","\\therefore",!0);o(a,d,"∍","\\backepsilon");o(a,d,"▶","\\blacktriangleright");o(a,d,"∵","\\because",!0);o(a,d,"⋘","\\llless");o(a,d,"⋙","\\gggtr");o(a,A,"⊲","\\lhd");o(a,A,"⊳","\\rhd");o(a,d,"≂","\\eqsim",!0);o(a,d,"≑","\\Doteq",!0);o(a,d,"⥽","\\strictif",!0);o(a,d,"⥼","\\strictfi",!0);o(a,A,"∔","\\dotplus",!0);o(a,A,"∖","\\smallsetminus");o(a,A,"⋒","\\Cap",!0);o(a,A,"⋓","\\Cup",!0);o(a,A,"⩞","\\doublebarwedge",!0);o(a,A,"⊟","\\boxminus",!0);o(a,A,"⊞","\\boxplus",!0);o(a,A,"⋇","\\divideontimes",!0);o(a,A,"⋉","\\ltimes",!0);o(a,A,"⋊","\\rtimes",!0);o(a,A,"⋋","\\leftthreetimes",!0);o(a,A,"⋌","\\rightthreetimes",!0);o(a,A,"⋏","\\curlywedge",!0);o(a,A,"⋎","\\curlyvee",!0);o(a,A,"⊝","\\circleddash",!0);o(a,A,"⊛","\\circledast",!0);o(a,A,"⊺","\\intercal",!0);o(a,A,"⋒","\\doublecap");o(a,A,"⋓","\\doublecup");o(a,A,"⊠","\\boxtimes",!0);o(a,A,"⋈","\\bowtie",!0);o(a,A,"⋈","\\Join");o(a,A,"⟕","\\leftouterjoin",!0);o(a,A,"⟖","\\rightouterjoin",!0);o(a,A,"⟗","\\fullouterjoin",!0);o(a,d,"⇢","\\dashrightarrow",!0);o(a,d,"⇠","\\dashleftarrow",!0);o(a,d,"⇇","\\leftleftarrows",!0);o(a,d,"⇆","\\leftrightarrows",!0);o(a,d,"⇚","\\Lleftarrow",!0);o(a,d,"↞","\\twoheadleftarrow",!0);o(a,d,"↢","\\leftarrowtail",!0);o(a,d,"↫","\\looparrowleft",!0);o(a,d,"⇋","\\leftrightharpoons",!0);o(a,d,"↶","\\curvearrowleft",!0);o(a,d,"↺","\\circlearrowleft",!0);o(a,d,"↰","\\Lsh",!0);o(a,d,"⇈","\\upuparrows",!0);o(a,d,"↿","\\upharpoonleft",!0);o(a,d,"⇃","\\downharpoonleft",!0);o(a,d,"⊶","\\origof",!0);o(a,d,"⊷","\\imageof",!0);o(a,d,"⊸","\\multimap",!0);o(a,d,"↭","\\leftrightsquigarrow",!0);o(a,d,"⇉","\\rightrightarrows",!0);o(a,d,"⇄","\\rightleftarrows",!0);o(a,d,"↠","\\twoheadrightarrow",!0);o(a,d,"↣","\\rightarrowtail",!0);o(a,d,"↬","\\looparrowright",!0);o(a,d,"↷","\\curvearrowright",!0);o(a,d,"↻","\\circlearrowright",!0);o(a,d,"↱","\\Rsh",!0);o(a,d,"⇊","\\downdownarrows",!0);o(a,d,"↾","\\upharpoonright",!0);o(a,d,"⇂","\\downharpoonright",!0);o(a,d,"⇝","\\rightsquigarrow",!0);o(a,d,"⇝","\\leadsto");o(a,d,"⇛","\\Rrightarrow",!0);o(a,d,"↾","\\restriction");o(a,m,"‘","`");o(a,m,"$","\\$");o(f,m,"$","\\$");o(f,m,"$","\\textdollar");o(a,m,"¢","\\cent");o(f,m,"¢","\\cent");o(a,m,"%","\\%");o(f,m,"%","\\%");o(a,m,"_","\\_");o(f,m,"_","\\_");o(f,m,"_","\\textunderscore");o(f,m,"␣","\\textvisiblespace",!0);o(a,m,"∠","\\angle",!0);o(a,m,"∞","\\infty",!0);o(a,m,"′","\\prime");o(a,m,"″","\\dprime");o(a,m,"‴","\\trprime");o(a,m,"⁗","\\qprime");o(a,m,"△","\\triangle");o(f,m,"Α","\\Alpha",!0);o(f,m,"Β","\\Beta",!0);o(f,m,"Γ","\\Gamma",!0);o(f,m,"Δ","\\Delta",!0);o(f,m,"Ε","\\Epsilon",!0);o(f,m,"Ζ","\\Zeta",!0);o(f,m,"Η","\\Eta",!0);o(f,m,"Θ","\\Theta",!0);o(f,m,"Ι","\\Iota",!0);o(f,m,"Κ","\\Kappa",!0);o(f,m,"Λ","\\Lambda",!0);o(f,m,"Μ","\\Mu",!0);o(f,m,"Ν","\\Nu",!0);o(f,m,"Ξ","\\Xi",!0);o(f,m,"Ο","\\Omicron",!0);o(f,m,"Π","\\Pi",!0);o(f,m,"Ρ","\\Rho",!0);o(f,m,"Σ","\\Sigma",!0);o(f,m,"Τ","\\Tau",!0);o(f,m,"Υ","\\Upsilon",!0);o(f,m,"Φ","\\Phi",!0);o(f,m,"Χ","\\Chi",!0);o(f,m,"Ψ","\\Psi",!0);o(f,m,"Ω","\\Omega",!0);o(a,w,"Α","\\Alpha",!0);o(a,w,"Β","\\Beta",!0);o(a,w,"Γ","\\Gamma",!0);o(a,w,"Δ","\\Delta",!0);o(a,w,"Ε","\\Epsilon",!0);o(a,w,"Ζ","\\Zeta",!0);o(a,w,"Η","\\Eta",!0);o(a,w,"Θ","\\Theta",!0);o(a,w,"Ι","\\Iota",!0);o(a,w,"Κ","\\Kappa",!0);o(a,w,"Λ","\\Lambda",!0);o(a,w,"Μ","\\Mu",!0);o(a,w,"Ν","\\Nu",!0);o(a,w,"Ξ","\\Xi",!0);o(a,w,"Ο","\\Omicron",!0);o(a,w,"Π","\\Pi",!0);o(a,w,"Ρ","\\Rho",!0);o(a,w,"Σ","\\Sigma",!0);o(a,w,"Τ","\\Tau",!0);o(a,w,"Υ","\\Upsilon",!0);o(a,w,"Φ","\\Phi",!0);o(a,w,"Χ","\\Chi",!0);o(a,w,"Ψ","\\Psi",!0);o(a,w,"Ω","\\Omega",!0);o(a,G,"¬","\\neg",!0);o(a,G,"¬","\\lnot");o(a,m,"⊤","\\top");o(a,m,"⊥","\\bot");o(a,m,"∅","\\emptyset");o(a,m,"⌀","\\varnothing");o(a,w,"α","\\alpha",!0);o(a,w,"β","\\beta",!0);o(a,w,"γ","\\gamma",!0);o(a,w,"δ","\\delta",!0);o(a,w,"ϵ","\\epsilon",!0);o(a,w,"ζ","\\zeta",!0);o(a,w,"η","\\eta",!0);o(a,w,"θ","\\theta",!0);o(a,w,"ι","\\iota",!0);o(a,w,"κ","\\kappa",!0);o(a,w,"λ","\\lambda",!0);o(a,w,"μ","\\mu",!0);o(a,w,"ν","\\nu",!0);o(a,w,"ξ","\\xi",!0);o(a,w,"ο","\\omicron",!0);o(a,w,"π","\\pi",!0);o(a,w,"ρ","\\rho",!0);o(a,w,"σ","\\sigma",!0);o(a,w,"τ","\\tau",!0);o(a,w,"υ","\\upsilon",!0);o(a,w,"ϕ","\\phi",!0);o(a,w,"χ","\\chi",!0);o(a,w,"ψ","\\psi",!0);o(a,w,"ω","\\omega",!0);o(a,w,"ε","\\varepsilon",!0);o(a,w,"ϑ","\\vartheta",!0);o(a,w,"ϖ","\\varpi",!0);o(a,w,"ϱ","\\varrho",!0);o(a,w,"ς","\\varsigma",!0);o(a,w,"φ","\\varphi",!0);o(a,w,"Ϙ","\\Coppa",!0);o(a,w,"ϙ","\\coppa",!0);o(a,w,"ϙ","\\varcoppa",!0);o(a,w,"Ϟ","\\Koppa",!0);o(a,w,"ϟ","\\koppa",!0);o(a,w,"Ϡ","\\Sampi",!0);o(a,w,"ϡ","\\sampi",!0);o(a,w,"Ϛ","\\Stigma",!0);o(a,w,"ϛ","\\stigma",!0);o(a,w,"⫫","\\Bot");o(a,A,"∗","∗",!0);o(a,A,"+","+");o(a,A,"*","*");o(a,A,"⁄","/",!0);o(a,A,"⁄","⁄");o(a,A,"−","-",!0);o(a,A,"⋅","\\cdot",!0);o(a,A,"∘","\\circ",!0);o(a,A,"÷","\\div",!0);o(a,A,"±","\\pm",!0);o(a,A,"×","\\times",!0);o(a,A,"∩","\\cap",!0);o(a,A,"∪","\\cup",!0);o(a,A,"∖","\\setminus",!0);o(a,A,"∧","\\land");o(a,A,"∨","\\lor");o(a,A,"∧","\\wedge",!0);o(a,A,"∨","\\vee",!0);o(a,G,"⟦","\\llbracket",!0);o(a,I,"⟧","\\rrbracket",!0);o(a,G,"⟨","\\langle",!0);o(a,G,"⟪","\\lAngle",!0);o(a,G,"⦉","\\llangle",!0);o(a,G,"|","\\lvert");o(a,G,"‖","\\lVert");o(a,m,"!","\\oc");o(a,m,"?","\\wn");o(a,m,"↓","\\shpos");o(a,m,"↕","\\shift");o(a,m,"↑","\\shneg");o(a,I,"?","?");o(a,I,"!","!");o(a,I,"‼","‼");o(a,I,"⟩","\\rangle",!0);o(a,I,"⟫","\\rAngle",!0);o(a,I,"⦊","\\rrangle",!0);o(a,I,"|","\\rvert");o(a,I,"‖","\\rVert");o(a,G,"⦃","\\lBrace",!0);o(a,I,"⦄","\\rBrace",!0);o(a,d,"=","\\equal",!0);o(a,d,":",":");o(a,d,"≈","\\approx",!0);o(a,d,"≅","\\cong",!0);o(a,d,"≥","\\ge");o(a,d,"≥","\\geq",!0);o(a,d,"←","\\gets");o(a,d,">","\\gt",!0);o(a,d,"∈","\\in",!0);o(a,d,"∉","\\notin",!0);o(a,d,"","\\@not");o(a,d,"⊂","\\subset",!0);o(a,d,"⊃","\\supset",!0);o(a,d,"⊆","\\subseteq",!0);o(a,d,"⊇","\\supseteq",!0);o(a,d,"⊈","\\nsubseteq",!0);o(a,d,"⊈","\\nsubseteqq");o(a,d,"⊉","\\nsupseteq",!0);o(a,d,"⊉","\\nsupseteqq");o(a,d,"⊨","\\models");o(a,d,"←","\\leftarrow",!0);o(a,d,"≤","\\le");o(a,d,"≤","\\leq",!0);o(a,d,"<","\\lt",!0);o(a,d,"→","\\rightarrow",!0);o(a,d,"→","\\to");o(a,d,"≱","\\ngeq",!0);o(a,d,"≱","\\ngeqq");o(a,d,"≱","\\ngeqslant");o(a,d,"≰","\\nleq",!0);o(a,d,"≰","\\nleqq");o(a,d,"≰","\\nleqslant");o(a,d,"⫫","\\Perp",!0);o(a,se," ","\\ ");o(a,se," ","\\space");o(a,se," ","\\nobreakspace");o(f,se," ","\\ ");o(f,se," "," ");o(f,se," ","\\space");o(f,se," ","\\nobreakspace");o(a,se,null,"\\nobreak");o(a,se,null,"\\allowbreak");o(a,ke,",",",");o(f,ke,":",":");o(a,ke,";",";");o(a,A,"⊼","\\barwedge",!0);o(a,A,"⊻","\\veebar",!0);o(a,A,"⊙","\\odot",!0);o(a,A,"⊕︎","\\oplus");o(a,A,"⊗","\\otimes",!0);o(a,m,"∂","\\partial",!0);o(a,A,"⊘","\\oslash",!0);o(a,A,"⊚","\\circledcirc",!0);o(a,A,"⊡","\\boxdot",!0);o(a,A,"△","\\bigtriangleup");o(a,A,"▽","\\bigtriangledown");o(a,A,"†","\\dagger");o(a,A,"⋄","\\diamond");o(a,A,"⋆","\\star");o(a,A,"◃","\\triangleleft");o(a,A,"▹","\\triangleright");o(a,G,"{","\\{");o(f,m,"{","\\{");o(f,m,"{","\\textbraceleft");o(a,I,"}","\\}");o(f,m,"}","\\}");o(f,m,"}","\\textbraceright");o(a,G,"{","\\lbrace");o(a,I,"}","\\rbrace");o(a,G,"[","\\lbrack",!0);o(f,m,"[","\\lbrack",!0);o(a,I,"]","\\rbrack",!0);o(f,m,"]","\\rbrack",!0);o(a,G,"(","\\lparen",!0);o(a,I,")","\\rparen",!0);o(a,G,"⦇","\\llparenthesis",!0);o(a,I,"⦈","\\rrparenthesis",!0);o(f,m,"<","\\textless",!0);o(f,m,">","\\textgreater",!0);o(a,G,"⌊","\\lfloor",!0);o(a,I,"⌋","\\rfloor",!0);o(a,G,"⌈","\\lceil",!0);o(a,I,"⌉","\\rceil",!0);o(a,m,"\\","\\backslash");o(a,m,"|","|");o(a,m,"|","\\vert");o(f,m,"|","\\textbar",!0);o(a,m,"‖","\\|");o(a,m,"‖","\\Vert");o(f,m,"‖","\\textbardbl");o(f,m,"~","\\textasciitilde");o(f,m,"\\","\\textbackslash");o(f,m,"^","\\textasciicircum");o(a,d,"↑","\\uparrow",!0);o(a,d,"⇑","\\Uparrow",!0);o(a,d,"↓","\\downarrow",!0);o(a,d,"⇓","\\Downarrow",!0);o(a,d,"↕","\\updownarrow",!0);o(a,d,"⇕","\\Updownarrow",!0);o(a,O,"∐","\\coprod");o(a,O,"⋁","\\bigvee");o(a,O,"⋀","\\bigwedge");o(a,O,"⨄","\\biguplus");o(a,O,"⋂","\\bigcap");o(a,O,"⋃","\\bigcup");o(a,O,"∫","\\int");o(a,O,"∫","\\intop");o(a,O,"∬","\\iint");o(a,O,"∭","\\iiint");o(a,O,"∏","\\prod");o(a,O,"∑","\\sum");o(a,O,"⨂","\\bigotimes");o(a,O,"⨁","\\bigoplus");o(a,O,"⨀","\\bigodot");o(a,O,"⨉","\\bigtimes");o(a,O,"∮","\\oint");o(a,O,"∯","\\oiint");o(a,O,"∰","\\oiiint");o(a,O,"∱","\\intclockwise");o(a,O,"∲","\\varointclockwise");o(a,O,"⨌","\\iiiint");o(a,O,"⨍","\\intbar");o(a,O,"⨎","\\intBar");o(a,O,"⨏","\\fint");o(a,O,"⨒","\\rppolint");o(a,O,"⨓","\\scpolint");o(a,O,"⨕","\\pointint");o(a,O,"⨖","\\sqint");o(a,O,"⨗","\\intlarhk");o(a,O,"⨘","\\intx");o(a,O,"⨙","\\intcap");o(a,O,"⨚","\\intcup");o(a,O,"⨅","\\bigsqcap");o(a,O,"⨆","\\bigsqcup");o(a,O,"∫","\\smallint");o(f,de,"…","\\textellipsis");o(a,de,"…","\\mathellipsis");o(f,de,"…","\\ldots",!0);o(a,de,"…","\\ldots",!0);o(a,de,"⋰","\\iddots",!0);o(a,de,"⋯","\\@cdots",!0);o(a,de,"⋱","\\ddots",!0);o(a,m,"⋮","\\varvdots");o(a,D,"ˊ","\\acute");o(a,D,"`","\\grave");o(a,D,"¨","\\ddot");o(a,D,"…","\\dddot");o(a,D,"….","\\ddddot");o(a,D,"~","\\tilde");o(a,D,"‾","\\bar");o(a,D,"˘","\\breve");o(a,D,"ˇ","\\check");o(a,D,"^","\\hat");o(a,D,"→","\\vec");o(a,D,"˙","\\dot");o(a,D,"˚","\\mathring");o(a,w,"ı","\\imath",!0);o(a,w,"ȷ","\\jmath",!0);o(a,m,"ı","ı");o(a,m,"ȷ","ȷ");o(f,m,"ı","\\i",!0);o(f,m,"ȷ","\\j",!0);o(f,m,"ß","\\ss",!0);o(f,m,"æ","\\ae",!0);o(f,m,"œ","\\oe",!0);o(f,m,"ø","\\o",!0);o(a,w,"ø","\\o",!0);o(f,m,"Æ","\\AE",!0);o(f,m,"Œ","\\OE",!0);o(f,m,"Ø","\\O",!0);o(a,w,"Ø","\\O",!0);o(f,D,"ˊ","\\'");o(f,D,"ˋ","\\`");o(f,D,"ˆ","\\^");o(f,D,"˜","\\~");o(f,D,"ˉ","\\=");o(f,D,"˘","\\u");o(f,D,"˙","\\.");o(f,D,"¸","\\c");o(f,D,"˚","\\r");o(f,D,"ˇ","\\v");o(f,D,"¨",'\\"');o(f,D,"˝","\\H");o(a,D,"ˊ","\\'");o(a,D,"ˋ","\\`");o(a,D,"ˆ","\\^");o(a,D,"˜","\\~");o(a,D,"ˉ","\\=");o(a,D,"˘","\\u");o(a,D,"˙","\\.");o(a,D,"¸","\\c");o(a,D,"˚","\\r");o(a,D,"ˇ","\\v");o(a,D,"¨",'\\"');o(a,D,"˝","\\H");const Xr={"--":!0,"---":!0,"``":!0,"''":!0};o(f,m,"–","--",!0);o(f,m,"–","\\textendash");o(f,m,"—","---",!0);o(f,m,"—","\\textemdash");o(f,m,"‘","`",!0);o(f,m,"‘","\\textquoteleft");o(f,m,"’","'",!0);o(f,m,"’","\\textquoteright");o(f,m,"“","``",!0);o(f,m,"“","\\textquotedblleft");o(f,m,"”","''",!0);o(f,m,"”","\\textquotedblright");o(a,m,"°","\\degree",!0);o(f,m,"°","\\degree");o(f,m,"°","\\textdegree",!0);o(a,m,"£","\\pounds");o(a,m,"£","\\mathsterling",!0);o(f,m,"£","\\pounds");o(f,m,"£","\\textsterling",!0);o(a,m,"✠","\\maltese");o(f,m,"✠","\\maltese");o(a,m,"€","\\euro",!0);o(f,m,"€","\\euro",!0);o(f,m,"€","\\texteuro");o(a,m,"©","\\copyright",!0);o(f,m,"©","\\textcopyright");o(a,m,"⌀","\\diameter",!0);o(f,m,"⌀","\\diameter");o(a,m,"𝛤","\\varGamma");o(a,m,"𝛥","\\varDelta");o(a,m,"𝛩","\\varTheta");o(a,m,"𝛬","\\varLambda");o(a,m,"𝛯","\\varXi");o(a,m,"𝛱","\\varPi");o(a,m,"𝛴","\\varSigma");o(a,m,"𝛶","\\varUpsilon");o(a,m,"𝛷","\\varPhi");o(a,m,"𝛹","\\varPsi");o(a,m,"𝛺","\\varOmega");o(f,m,"𝛤","\\varGamma");o(f,m,"𝛥","\\varDelta");o(f,m,"𝛩","\\varTheta");o(f,m,"𝛬","\\varLambda");o(f,m,"𝛯","\\varXi");o(f,m,"𝛱","\\varPi");o(f,m,"𝛴","\\varSigma");o(f,m,"𝛶","\\varUpsilon");o(f,m,"𝛷","\\varPhi");o(f,m,"𝛹","\\varPsi");o(f,m,"𝛺","\\varOmega");const pt='0123456789/@."';for(let e=0;e<pt.length;e++){const t=pt.charAt(e);o(a,m,t,t)}const ft='0123456789!@*()-=+";:?/.,';for(let e=0;e<ft.length;e++){const t=ft.charAt(e);o(f,m,t,t)}const Me="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let e=0;e<Me.length;e++){const t=Me.charAt(e);o(a,w,t,t),o(f,m,t,t)}const gt="ÇÐÞçþℂℍℕℙℚℝℤℎℏℊℋℌℐℑℒℓ℘ℛℜℬℰℱℳℭℨ";for(let e=0;e<gt.length;e++){const t=gt.charAt(e);o(a,w,t,t),o(f,m,t,t)}let q="";for(let e=0;e<Me.length;e++){q=String.fromCharCode(55349,56320+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56372+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56424+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56580+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56736+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56788+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56840+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56944+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,56632+e),o(a,w,q,q),o(f,m,q,q);const t=Me.charAt(e);q=String.fromCharCode(55349,56476+e),o(a,w,t,q),o(f,m,t,q)}for(let e=0;e<10;e++)q=String.fromCharCode(55349,57294+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,57314+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,57324+e),o(a,w,q,q),o(f,m,q,q),q=String.fromCharCode(55349,57334+e),o(a,w,q,q),o(f,m,q,q);const Yr="([{⌊⌈⟨⟮⎰⟦⦃",Kr=")]}⌋⌉⟩⟯⎱⟦⦄";function Jr(e,t,r){const n=[];let s=[],i=[],u=0,c=0,h=0;for(;c<e.length;){for(;e[c]instanceof Je;)e.splice(c,1,...e[c].children);const y=e[c];if(y.attributes&&y.attributes.linebreak&&y.attributes.linebreak==="newline"){i.length>0&&s.push(new p.MathNode("mrow",i)),s.push(y),i=[];const S=new p.MathNode("mtd",s);S.style.textAlign="left",n.push(new p.MathNode("mtr",[S])),s=[],c+=1;continue}if(i.push(y),y.type&&y.type==="mo"&&y.children.length===1&&!Object.hasOwn(y.attributes,"movablelimits")){const S=y.children[0].text;if(Yr.indexOf(S)>-1)h+=1;else if(Kr.indexOf(S)>-1)h-=1;else if(h===0&&t==="="&&S==="="){if(u+=1,u>1){i.pop();const _=new p.MathNode("mrow",i);s.push(_),i=[y]}}else if(h===0&&t==="tex"&&S!=="∇"){const _=c<e.length-1?e[c+1]:null;let g=!0;if(!(_&&_.type==="mtext"&&_.attributes.linebreak&&_.attributes.linebreak==="nobreak"))for(let v=c+1;v<e.length;v++){const $=e[v];if($.type&&$.type==="mspace"&&!($.attributes.linebreak&&$.attributes.linebreak==="newline"))i.push($),c+=1,$.attributes&&$.attributes.linebreak&&$.attributes.linebreak==="nobreak"&&(g=!1);else break}if(g){const v=new p.MathNode("mrow",i);s.push(v),i=[]}}}c+=1}if(i.length>0){const y=new p.MathNode("mrow",i);s.push(y)}if(n.length>0){const y=new p.MathNode("mtd",s);y.style.textAlign="left";const S=new p.MathNode("mtr",[y]);n.push(S);const _=new p.MathNode("mtable",n);return r||(_.setAttribute("columnalign","left"),_.setAttribute("rowspacing","0em")),_}return p.newDocumentFragment(s)}const X=function(e,t,r){return P[t][e]&&P[t][e].replace&&e.charCodeAt(0)!==55349&&!(Object.prototype.hasOwnProperty.call(Xr,e)&&r&&(r.fontFamily&&r.fontFamily.slice(4,6)==="tt"||r.font&&r.font.slice(4,6)==="tt"))&&(e=P[t][e].replace),new p.TextNode(e)},et=e=>{if(e.type!=="mrow"&&e.type!=="mstyle"||e.children.length===0||!e.children[0].attributes||e.children[0].type!=="mtext")return e;const t=e.children[0].attributes.mathvariant||"",r=new p.MathNode("mtext",[new p.TextNode(e.children[0].children[0].text)]);for(let s=1;s<e.children.length;s++){const i=e.children[s].attributes.mathvariant||"";if(e.children[s].type==="mrow"){const u=e.children[s];for(let c=0;c<u.children.length;c++){if((u.children[c].attributes.mathvariant||"")!==t||u.children[c].type!=="mtext")return e;r.children[0].text+=u.children[c].children[0].text}}else{if(i!==t||e.children[s].type!=="mtext")return e;r.children[0].text+=e.children[s].children[0].text}}r.children[0].text.charAt(0)===" "&&(r.children[0].text=" "+r.children[0].text.slice(1));const n=r.children[0].text.length;n>0&&r.children[0].text.charAt(n-1)===" "&&(r.children[0].text=r.children[0].text.slice(0,-1)+" ");for(const[s,i]of Object.entries(e.attributes))r.attributes[s]=i;return r},bt=/^[0-9]$/,Qr=e=>e.type==="atom"&&e.text===","||e.type==="textord"&&e.text===".",en=e=>{if(e.length<2)return;const t=[];let r=!1;for(let n=0;n<e.length;n++){const s=e[n];s.type==="textord"&&bt.test(s.text)?(r||t.push({start:n}),r=!0):(r&&(t[t.length-1].end=n-1),r=!1)}r&&(t[t.length-1].end=e.length-1);for(let n=t.length-1;n>0;n--)t[n-1].end===t[n].start-2&&Qr(e[t[n].start-1])&&(t[n-1].end=t[n].end,t.splice(n,1));for(let n=t.length-1;n>=0;n--){for(let s=t[n].start+1;s<=t[n].end;s++)e[t[n].start].text+=e[s].text;if(e.splice(t[n].start+1,t[n].end-t[n].start),e.length>t[n].start+1){const s=e[t[n].start+1];s.type==="supsub"&&s.base&&s.base.type==="textord"&&bt.test(s.base.text)&&(s.base.text=e[t[n].start].text+s.base.text,e.splice(t[n].start,1))}}},tt=function(e,t=!1){if(e.length===1&&!(e[0]instanceof Je))return e[0];if(!t){e[0]instanceof W&&e[0].type==="mo"&&!e[0].attributes.fence&&(e[0].attributes.lspace="0em",e[0].attributes.rspace="0em");const r=e.length-1;e[r]instanceof W&&e[r].type==="mo"&&!e[r].attributes.fence&&(e[r].attributes.lspace="0em",e[r].attributes.rspace="0em")}return new p.MathNode("mrow",e)},qe=e=>e.type==="atom"&&e.family==="rel"||e.type==="mclass"&&e.mclass==="mrel",H=function(e,t,r=!1){if(!r&&e.length===1){const s=B(e[0],t);return s instanceof W&&s.type==="mo"&&(s.setAttribute("lspace","0em"),s.setAttribute("rspace","0em")),[s]}en(e);const n=[];for(let s=0;s<e.length;s++){const i=B(e[s],t);s<e.length-1&&qe(e[s])&&qe(e[s+1])&&i.setAttribute("rspace","0em"),s>0&&qe(e[s])&&qe(e[s-1])&&i.setAttribute("lspace","0em"),n.push(i)}return n},ae=function(e,t,r=!1){return tt(H(e,t,r),r)},B=function(e,t){if(!e)return new p.MathNode("mrow");if(Ne[e.type])return Ne[e.type](e,t);throw new x("Got group of unknown type: '"+e.type+"'")},xt=e=>new p.MathNode("mtd",[],[],{padding:"0",width:"50%"}),tn=(e,t,r,n)=>{t=ae(t[0].body,r),t=et(t),t.classes.push("tml-tag"),e=new p.MathNode("mtd",[e]);const s=[xt(),e,xt()];s[n?0:2].classes.push(n?"tml-left":"tml-right"),s[n?0:2].children.push(t);const i=new p.MathNode("mtr",s,["tml-tageqn"]),u=new p.MathNode("mtable",[i]);return u.style.width="100%",u.setAttribute("displaystyle","true"),u};function rn(e,t,r,n){let s=null;e.length===1&&e[0].type==="tag"&&(s=e[0].tag,e=e[0].body);const i=H(e,r),u=n.displayMode||n.annotate?"none":n.wrap,c=i.length===0?null:i[0];let h=i.length===1&&s===null&&c instanceof W?i[0]:Jr(i,u,n.displayMode);if(s&&(h=tn(h,s,r,n.leqno)),n.annotate){const S=new p.MathNode("annotation",[new p.TextNode(t)]);S.setAttribute("encoding","application/x-tex"),h=new p.MathNode("semantics",[h,S])}const y=new p.MathNode("math",[h]);return n.xml&&y.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n.displayMode&&(y.setAttribute("display","block"),y.style.display="block math",y.classes=["tml-display"]),y}const nn="acegıȷmnopqrsuvwxyzαγεηικμνοπρςστυχωϕ𝐚𝐜𝐞𝐠𝐦𝐧𝐨𝐩𝐪𝐫𝐬𝐮𝐯𝐰𝐱𝐲𝐳",on="ABCDEFGHIJKLMNOPQRSTUVWXYZbdfhkltΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩβδλζφθψ𝐀𝐁𝐂𝐃𝐄𝐅𝐆𝐇𝐈𝐉𝐊𝐋𝐌𝐍𝐎𝐏𝐐𝐑𝐒𝐓𝐔𝐕𝐖𝐗𝐘𝐙𝐛𝐝𝐟𝐡𝐤𝐥𝐭",sn=new Set(["\\alpha","\\gamma","\\delta","\\epsilon","\\eta","\\iota","\\kappa","\\mu","\\nu","\\pi","\\rho","\\sigma","\\tau","\\upsilon","\\chi","\\psi","\\omega","\\imath","\\jmath"]),an=new Set(["\\Gamma","\\Delta","\\Sigma","\\Omega","\\beta","\\delta","\\lambda","\\theta","\\psi"]),Qt=(e,t)=>{const r=e.isStretchy?ze.accentNode(e):new p.MathNode("mo",[X(e.label,e.mode)]);if(e.label==="\\vec")r.style.transform="scale(0.75) translate(10%, 30%)";else if(r.style.mathStyle="normal",r.style.mathDepth="0",ln.has(e.label)&&C.isCharacterBox(e.base)){let s="";const i=e.base.text;(nn.indexOf(i)>-1||sn.has(i))&&(s="tml-xshift"),(on.indexOf(i)>-1||an.has(i))&&(s="tml-capshift"),s&&r.classes.push(s)}return e.isStretchy||r.setAttribute("stretchy","false"),new p.MathNode(e.label==="\\c"?"munder":"mover",[B(e.base,t),r])},un=new Set(["\\acute","\\grave","\\ddot","\\dddot","\\ddddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"]),ln=new Set(["\\acute","\\bar","\\breve","\\check","\\dot","\\ddot","\\grave","\\hat","\\mathring","\\'","\\^","\\~","\\=","\\u","\\.",'\\"',"\\r","\\H","\\v"]);k({type:"accent",names:["\\acute","\\grave","\\ddot","\\dddot","\\ddddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\overparen","\\widecheck","\\widehat","\\wideparen","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(e,t)=>{const r=ye(t[0]),n=!un.has(e.funcName);return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:n,base:r}},mathmlBuilder:Qt});k({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\c","\\u","\\.",'\\"',"\\r","\\H","\\v"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(e,t)=>{const r=ye(t[0]),n=e.parser.mode;return n==="math"&&e.parser.settings.strict&&console.log(`Temml parse error: Command ${e.funcName} is invalid in math mode.`),{type:"accent",mode:n,label:e.funcName,isStretchy:!1,base:r}},mathmlBuilder:Qt});k({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underparen","\\utilde"],props:{numArgs:1},handler:({parser:e,funcName:t},r)=>{const n=r[0];return{type:"accentUnder",mode:e.mode,label:t,base:n}},mathmlBuilder:(e,t)=>{const r=ze.accentNode(e);return r.style["math-depth"]=0,new p.MathNode("munder",[B(e.base,t),r])}});const yt={pt:800/803,pc:12*800/803,dd:1238/1157*800/803,cc:14856/1157*800/803,nd:685/642*800/803,nc:1370/107*800/803,sp:1/65536*800/803,mm:25.4/72,cm:2.54/72,in:1/72,px:96/72},cn=["em","ex","mu","pt","mm","cm","in","px","bp","pc","dd","cc","nd","nc","sp"],er=function(e){return typeof e!="string"&&(e=e.unit),cn.indexOf(e)>-1},tr=e=>{const t=Math.max(e-1,0);return[1,.7,.5][t]},oe=function(e,t){let r=e.number;if(t.maxSize[0]<0&&r>0)return{number:0,unit:"em"};const n=e.unit;switch(n){case"mm":case"cm":case"in":case"px":return r*yt[n]>t.maxSize[1]?{number:t.maxSize[1],unit:"pt"}:{number:r,unit:n};case"em":case"ex":return n==="ex"&&(r*=.431),r=Math.min(r/tr(t.level),t.maxSize[0]),{number:C.round(r),unit:"em"};case"bp":return r>t.maxSize[1]&&(r=t.maxSize[1]),{number:r,unit:"pt"};case"pt":case"pc":case"dd":case"cc":case"nd":case"nc":case"sp":return r=Math.min(r*yt[n],t.maxSize[1]),{number:C.round(r),unit:"pt"};case"mu":return r=Math.min(r/18,t.maxSize[0]),{number:C.round(r),unit:"em"};default:throw new x("Invalid unit: '"+n+"'")}},ne=e=>{const t=new p.MathNode("mspace");return t.setAttribute("width",e+"em"),t},Te=(e,t=.3,r=0)=>{if(e==null&&r===0)return ne(t);const n=e?[e]:[];return t!==0&&n.unshift(ne(t)),r>0&&n.push(ne(r)),new p.MathNode("mrow",n)},je=(e,t)=>Number(e)/tr(t),He=(e,t,r,n)=>{const s=ze.mathMLnode(e),i=e.slice(1,3)==="eq",u=e.charAt(1)==="x"?"1.75":e.slice(2,4)==="cd"?"3.0":i?"1.0":"2.0";s.setAttribute("lspace","0"),s.setAttribute("rspace",i?"0.5em":"0");const c=n.withLevel(n.level<2?2:3),h=je(u,c.level),y=je(u,3),S=Te(null,h.toFixed(4),0),_=Te(null,y.toFixed(4),0),g=je(i?0:.3,c.level).toFixed(4);let v,$;const j=t&&t.body&&(t.body.body||t.body.length>0);if(j){let R=B(t,c);R=Te(R,g,g),v=new p.MathNode("mover",[R,_])}const J=r&&r.body&&(r.body.body||r.body.length>0);if(J){let R=B(r,c);R=Te(R,g,g),$=new p.MathNode("munder",[R,_])}let E;return!j&&!J?E=new p.MathNode("mover",[s,S]):j&&J?E=new p.MathNode("munderover",[s,$,v]):j?E=new p.MathNode("mover",[s,v]):E=new p.MathNode("munder",[s,$]),u==="3.0"&&(E.style.height="1em"),E.setAttribute("accent","false"),E};k({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\yields","\\yieldsLeft","\\mesomerism","\\longrightharpoonup","\\longleftharpoondown","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler({parser:e,funcName:t},r,n){return{type:"xArrow",mode:e.mode,name:t,body:r[0],below:n[0]}},mathmlBuilder(e,t){const n=[He(e.name,e.body,e.below,t)];return n.unshift(ne(.2778)),n.push(ne(.2778)),new p.MathNode("mrow",n)}});const wt={"\\xtofrom":["\\xrightarrow","\\xleftarrow"],"\\xleftrightharpoons":["\\xleftharpoonup","\\xrightharpoondown"],"\\xrightleftharpoons":["\\xrightharpoonup","\\xleftharpoondown"],"\\yieldsLeftRight":["\\yields","\\yieldsLeft"],"\\equilibrium":["\\longrightharpoonup","\\longleftharpoondown"],"\\equilibriumRight":["\\longrightharpoonup","\\eqleftharpoondown"],"\\equilibriumLeft":["\\eqrightharpoonup","\\longleftharpoondown"]};k({type:"stackedArrow",names:["\\xtofrom","\\xleftrightharpoons","\\xrightleftharpoons","\\yieldsLeftRight","\\equilibrium","\\equilibriumRight","\\equilibriumLeft"],props:{numArgs:1,numOptionalArgs:1},handler({parser:e,funcName:t},r,n){const s=r[0]?{type:"hphantom",mode:e.mode,body:r[0]}:null,i=n[0]?{type:"hphantom",mode:e.mode,body:n[0]}:null;return{type:"stackedArrow",mode:e.mode,name:t,body:r[0],upperArrowBelow:i,lowerArrowBody:s,below:n[0]}},mathmlBuilder(e,t){const r=wt[e.name][0],n=wt[e.name][1],s=He(r,e.body,e.upperArrowBelow,t),i=He(n,e.lowerArrowBody,e.below,t);let u;const c=new p.MathNode("mpadded",[s]);if(c.setAttribute("voffset","0.3em"),c.setAttribute("height","+0.3em"),c.setAttribute("depth","-0.3em"),e.name==="\\equilibriumLeft"){const h=new p.MathNode("mpadded",[i]);h.setAttribute("width","0.5em"),u=new p.MathNode("mpadded",[ne(.2778),h,c,ne(.2778)])}else c.setAttribute("width",e.name==="\\equilibriumRight"?"0.5em":"0"),u=new p.MathNode("mpadded",[ne(.2778),c,i,ne(.2778)]);return u.setAttribute("voffset","-0.18em"),u.setAttribute("height","-0.18em"),u.setAttribute("depth","+0.18em"),u}});function T(e,t){if(!e||e.type!==t)throw new Error(`Expected node of type ${t}, but got `+(e?`node of type ${e.type}`:String(e)));return e}function rt(e){const t=Le(e);if(!t)throw new Error("Expected node of symbol group type, but got "+(e?`node of type ${e.type}`:String(e)));return t}function Le(e){return e&&(e.type==="atom"||Object.prototype.hasOwnProperty.call(Zr,e.type))?e:null}const dn={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},vt=()=>({type:"styling",body:[],mode:"math",scriptLevel:"display"}),kt=e=>e.type==="textord"&&e.text==="@",mn=(e,t)=>(e.type==="mathord"||e.type==="atom")&&e.text===t;function hn(e,t,r){const n=dn[e];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return r.callFunction(n,[t[0]],[t[1]]);case"\\uparrow":case"\\downarrow":{const s=r.callFunction("\\\\cdleft",[t[0]],[]),i={type:"atom",text:n,mode:"math",family:"rel"},u=r.callFunction("\\Big",[i],[]),c=r.callFunction("\\\\cdright",[t[1]],[]),h={type:"ordgroup",mode:"math",body:[s,u,c],semisimple:!0};return r.callFunction("\\\\cdparent",[h],[])}case"\\\\cdlongequal":return r.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{const s={type:"textord",text:"\\Vert",mode:"math"};return r.callFunction("\\Big",[s],[])}default:return{type:"textord",text:" ",mode:"math"}}}function pn(e){const t=[];for(e.gullet.beginGroup(),e.gullet.macros.set("\\cr","\\\\\\relax"),e.gullet.beginGroup();;){t.push(e.parseExpression(!1,"\\\\")),e.gullet.endGroup(),e.gullet.beginGroup();const s=e.fetch().text;if(s==="&"||s==="\\\\")e.consume();else if(s==="\\end"){t[t.length-1].length===0&&t.pop();break}else throw new x("Expected \\\\ or \\cr or \\end",e.nextToken)}let r=[];const n=[r];for(let s=0;s<t.length;s++){const i=t[s];let u=vt();for(let c=0;c<i.length;c++)if(!kt(i[c]))u.body.push(i[c]);else{r.push(u),c+=1;const h=rt(i[c]).text,y=new Array(2);if(y[0]={type:"ordgroup",mode:"math",body:[]},y[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(h)>-1))if("<>AV".indexOf(h)>-1)for(let _=0;_<2;_++){let g=!0;for(let v=c+1;v<i.length;v++){if(mn(i[v],h)){g=!1,c=v;break}if(kt(i[v]))throw new x("Missing a "+h+" character to complete a CD arrow.",i[v]);y[_].body.push(i[v])}if(g)throw new x("Missing a "+h+" character to complete a CD arrow.",i[c])}else throw new x('Expected one of "<>AV=|." after @.');const S=hn(h,y,e);r.push(S),u=vt()}s%2===0?r.push(u):r.shift(),r=[],n.push(r)}return n.pop(),e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:"math",body:n,envClasses:["jot","cd"],cols:[],hLinesBeforeRow:new Array(n.length+1).fill([])}}k({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler({parser:e,funcName:t},r){return{type:"cdlabel",mode:e.mode,side:t.slice(4),label:r[0]}},mathmlBuilder(e,t){let r=new p.MathNode("mrow",[B(e.label,t)]);return r=new p.MathNode("mpadded",[r]),r.setAttribute("width","0"),e.side==="left"&&r.setAttribute("lspace","-1width"),r.setAttribute("voffset","0.7em"),r=new p.MathNode("mstyle",[r]),r.setAttribute("displaystyle","false"),r.setAttribute("scriptlevel","1"),r}});k({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler({parser:e},t){return{type:"cdlabelparent",mode:e.mode,fragment:t[0]}},mathmlBuilder(e,t){return new p.MathNode("mrow",[B(e.fragment,t)])}});k({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler({parser:e,token:t},r){const s=T(r[0],"ordgroup").body;let i="";for(let c=0;c<s.length;c++){const h=T(s[c],"textord");i+=h.text}const u=parseInt(i);if(isNaN(u))throw new x(`\\@char has non-numeric argument ${i}`,t);return{type:"textord",mode:e.mode,text:String.fromCodePoint(u)}}});const fn=/^(#[a-f0-9]{3}|#?[a-f0-9]{6})$/i,gn=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i,bn=/^ *\d{1,3} *(?:, *\d{1,3} *){2}$/,xn=/^ *[10](?:\.\d*)? *(?:, *[10](?:\.\d*)? *){2}$/,yn=/^[a-f0-9]{6}$/i,At=e=>{let t=e.toString(16);return t.length===1&&(t="0"+t),t},St=JSON.parse(`{
  "Apricot": "#ffb484",
  "Aquamarine": "#08b4bc",
  "Bittersweet": "#c84c14",
  "blue": "#0000FF",
  "Blue": "#303494",
  "BlueGreen": "#08b4bc",
  "BlueViolet": "#503c94",
  "BrickRed": "#b8341c",
  "brown": "#BF8040",
  "Brown": "#802404",
  "BurntOrange": "#f8941c",
  "CadetBlue": "#78749c",
  "CarnationPink": "#f884b4",
  "Cerulean": "#08a4e4",
  "CornflowerBlue": "#40ace4",
  "cyan": "#00FFFF",
  "Cyan": "#08acec",
  "Dandelion": "#ffbc44",
  "darkgray": "#404040",
  "DarkOrchid": "#a8548c",
  "Emerald": "#08ac9c",
  "ForestGreen": "#089c54",
  "Fuchsia": "#90348c",
  "Goldenrod": "#ffdc44",
  "gray": "#808080",
  "Gray": "#98949c",
  "green": "#00FF00",
  "Green": "#08a44c",
  "GreenYellow": "#e0e474",
  "JungleGreen": "#08ac9c",
  "Lavender": "#f89cc4",
  "lightgray": "#c0c0c0",
  "lime": "#BFFF00",
  "LimeGreen": "#90c43c",
  "magenta": "#FF00FF",
  "Magenta": "#f0048c",
  "Mahogany": "#b0341c",
  "Maroon": "#b03434",
  "Melon": "#f89c7c",
  "MidnightBlue": "#086494",
  "Mulberry": "#b03c94",
  "NavyBlue": "#086cbc",
  "olive": "#7F7F00",
  "OliveGreen": "#407c34",
  "orange": "#FF8000",
  "Orange": "#f8843c",
  "OrangeRed": "#f0145c",
  "Orchid": "#b074ac",
  "Peach": "#f8945c",
  "Periwinkle": "#8074bc",
  "PineGreen": "#088c74",
  "pink": "#ff7f7f",
  "Plum": "#98248c",
  "ProcessBlue": "#08b4ec",
  "purple": "#BF0040",
  "Purple": "#a0449c",
  "RawSienna": "#983c04",
  "red": "#ff0000",
  "Red": "#f01c24",
  "RedOrange": "#f86434",
  "RedViolet": "#a0246c",
  "Rhodamine": "#f0549c",
  "Royallue": "#0874bc",
  "RoyalPurple": "#683c9c",
  "RubineRed": "#f0047c",
  "Salmon": "#f8948c",
  "SeaGreen": "#30bc9c",
  "Sepia": "#701404",
  "SkyBlue": "#48c4dc",
  "SpringGreen": "#c8dc64",
  "Tan": "#e09c74",
  "teal": "#007F7F",
  "TealBlue": "#08acb4",
  "Thistle": "#d884b4",
  "Turquoise": "#08b4cc",
  "violet": "#800080",
  "Violet": "#60449c",
  "VioletRed": "#f054a4",
  "WildStrawberry": "#f0246c",
  "yellow": "#FFFF00",
  "Yellow": "#fff404",
  "YellowGreen": "#98cc6c",
  "YellowOrange": "#ffa41c"
}`),he=(e,t)=>{let r="";if(e==="HTML"){if(!fn.test(t))throw new x("Invalid HTML input.");r=t}else if(e==="RGB"){if(!bn.test(t))throw new x("Invalid RGB input.");t.split(",").map(n=>{r+=At(Number(n.trim()))})}else{if(!xn.test(t))throw new x("Invalid rbg input.");t.split(",").map(n=>{const s=Number(n.trim());if(s>1)throw new x("Color rgb input must be < 1.");r+=At(Number((s*255).toFixed(0)))})}return r.charAt(0)!=="#"&&(r="#"+r),r},we=(e,t,r)=>{const n=`\\\\color@${e}`;if(!gn.exec(e))throw new x("Invalid color: '"+e+"'",r);return yn.test(e)?"#"+e:(e.charAt(0)==="#"||(t.has(n)?e=t.get(n).tokens[0].text:St[e]&&(e=St[e])),e)},rr=(e,t)=>{let r=H(e.body,t.withColor(e.color));return r=r.map(n=>(n.style.color=e.color,n)),p.newDocumentFragment(r)};k({type:"color",names:["\\textcolor"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw","original"]},handler({parser:e,token:t},r,n){const s=n[0]&&T(n[0],"raw").string;let i="";if(s){const c=T(r[0],"raw").string;i=he(s,c)}else i=we(T(r[0],"raw").string,e.gullet.macros,t);const u=r[1];return{type:"color",mode:e.mode,color:i,body:L(u)}},mathmlBuilder:rr});k({type:"color",names:["\\color"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw"]},handler({parser:e,breakOnTokenText:t,token:r},n,s){const i=s[0]&&T(s[0],"raw").string;let u="";if(i){const h=T(n[0],"raw").string;u=he(i,h)}else u=we(T(n[0],"raw").string,e.gullet.macros,r);const c=e.parseExpression(!0,t,!0);return{type:"color",mode:e.mode,color:u,body:c}},mathmlBuilder:rr});k({type:"color",names:["\\definecolor"],props:{numArgs:3,allowedInText:!0,argTypes:["raw","raw","raw"]},handler({parser:e,funcName:t,token:r},n){const s=T(n[0],"raw").string;if(!/^[A-Za-z]+$/.test(s))throw new x("Color name must be latin letters.",r);const i=T(n[1],"raw").string;if(!["HTML","RGB","rgb"].includes(i))throw new x("Color model must be HTML, RGB, or rgb.",r);const u=T(n[2],"raw").string,c=he(i,u);return e.gullet.macros.set(`\\\\color@${s}`,{tokens:[{text:c}],numArgs:0}),{type:"internal",mode:e.mode}}});k({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler({parser:e},t,r){const n=e.gullet.future().text==="["?e.parseSizeGroup(!0):null,s=!e.settings.displayMode;return{type:"cr",mode:e.mode,newLine:s,size:n&&T(n,"size").value}},mathmlBuilder(e,t){const r=new p.MathNode("mo");if(e.newLine&&(r.setAttribute("linebreak","newline"),e.size)){const n=oe(e.size,t);r.setAttribute("height",n.number+n.unit)}return r}});const Ze={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},Ee=e=>{const t=e.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(t))throw new x("Expected a control sequence",e);return t},wn=e=>{let t=e.gullet.popToken();return t.text==="="&&(t=e.gullet.popToken(),t.text===" "&&(t=e.gullet.popToken())),t},nr=(e,t,r,n)=>{let s=e.gullet.macros.get(r.text);s==null&&(r.noexpand=!0,s={tokens:[r],numArgs:0,unexpandable:!e.gullet.isExpandable(r.text)}),e.gullet.macros.set(t,s,n)};k({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler({parser:e,funcName:t}){e.consumeSpaces();const r=e.fetch();if(Ze[r.text])return(t==="\\global"||t==="\\\\globallong")&&(r.text=Ze[r.text]),T(e.parseFunction(),"internal");throw new x("Invalid token after macro prefix",r)}});k({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:e,funcName:t}){let r=e.gullet.popToken();const n=r.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(n))throw new x("Expected a control sequence",r);let s=0,i;const u=[[]];for(;e.gullet.future().text!=="{";)if(r=e.gullet.popToken(),r.text==="#"){if(e.gullet.future().text==="{"){i=e.gullet.future(),u[s].push("{");break}if(r=e.gullet.popToken(),!/^[1-9]$/.test(r.text))throw new x(`Invalid argument number "${r.text}"`);if(parseInt(r.text)!==s+1)throw new x(`Argument number "${r.text}" out of order`);s++,u.push([])}else{if(r.text==="EOF")throw new x("Expected a macro definition");u[s].push(r.text)}let{tokens:c}=e.gullet.consumeArg();return i&&c.unshift(i),(t==="\\edef"||t==="\\xdef")&&(c=e.gullet.expandTokens(c),c.reverse()),e.gullet.macros.set(n,{tokens:c,numArgs:s,delimiters:u},t===Ze[t]),{type:"internal",mode:e.mode}}});k({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:e,funcName:t}){const r=Ee(e.gullet.popToken());e.gullet.consumeSpaces();const n=wn(e);return nr(e,r,n,t==="\\\\globallet"),{type:"internal",mode:e.mode}}});k({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:e,funcName:t}){const r=Ee(e.gullet.popToken()),n=e.gullet.popToken(),s=e.gullet.popToken();return nr(e,r,s,t==="\\\\globalfuture"),e.gullet.pushToken(s),e.gullet.pushToken(n),{type:"internal",mode:e.mode}}});k({type:"internal",names:["\\newcommand","\\renewcommand","\\providecommand"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({parser:e,funcName:t}){let r="";const n=e.gullet.popToken();n.text==="{"?(r=Ee(e.gullet.popToken()),e.gullet.popToken()):r=Ee(n);const s=e.gullet.isDefined(r);if(s&&t==="\\newcommand")throw new x(`\\newcommand{${r}} attempting to redefine ${r}; use \\renewcommand`);if(!s&&t==="\\renewcommand")throw new x(`\\renewcommand{${r}} when command ${r} does not yet exist; use \\newcommand`);let i=0;if(e.gullet.future().text==="["){let c=e.gullet.popToken();if(c=e.gullet.popToken(),!/^[0-9]$/.test(c.text))throw new x(`Invalid number of arguments: "${c.text}"`);if(i=parseInt(c.text),c=e.gullet.popToken(),c.text!=="]")throw new x(`Invalid argument "${c.text}"`)}const{tokens:u}=e.gullet.consumeArg();return e.gullet.macros.set(r,{tokens:u,numArgs:i},!e.settings.strict),{type:"internal",mode:e.mode}}});const Xe={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},or=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","⦇","\\llparenthesis","⦈","\\rrparenthesis","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lAngle","⟪","\\rAngle","⟫","\\llangle","⦉","\\rrangle","⦊","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","\\llbracket","\\rrbracket","⟦","⟦","\\lBrace","\\rBrace","⦃","⦄","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."],vn=["}","\\left","\\middle","\\right"],Ie=e=>e.length>0&&(or.includes(e)||Xe[e]||vn.includes(e)),_t=[0,1.2,1.8,2.4,3];function ve(e,t){const r=Le(e);if(r&&or.includes(r.text))return["/","⁄"].includes(r.text)&&(r.text="∕"),["<","\\lt"].includes(r.text)&&(r.text="⟨"),[">","\\gt"].includes(r.text)&&(r.text="⟩"),r.text==="\\backslash"&&(r.text="∖"),r;throw r?new x(`Invalid delimiter '${r.text}' after '${t.funcName}'`,e):new x(`Invalid delimiter type '${e.type}'`,e)}k({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{const r=ve(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:Xe[e.funcName].size,mclass:Xe[e.funcName].mclass,delim:r.text}},mathmlBuilder:e=>{const t=[];e.delim==="."&&(e.delim=""),t.push(X(e.delim,e.mode));const r=new p.MathNode("mo",t);return e.mclass==="mopen"||e.mclass==="mclose"?r.setAttribute("fence","true"):r.setAttribute("fence","false"),(e.delim==="∖"||e.delim==="\\vert"||e.delim==="|"||e.delim.indexOf("arrow")>-1)&&r.setAttribute("stretchy","true"),r.setAttribute("symmetric","true"),r.setAttribute("minsize",_t[e.size]+"em"),r.setAttribute("maxsize",_t[e.size]+"em"),r}});function kn(e){if(!e.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}k({type:"leftright-right",names:["\\right"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>({type:"leftright-right",mode:e.parser.mode,delim:ve(t[0],e).text})});k({type:"leftright",names:["\\left"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{const r=ve(t[0],e),n=e.parser;++n.leftrightDepth;let s=n.parseExpression(!1,null,!0),i=n.fetch();for(;i.text==="\\middle";){n.consume();const c=n.fetch().text;if(!P.math[c])throw new x(`Invalid delimiter '${c}' after '\\middle'`);ve({type:"atom",mode:"math",text:c},{funcName:"\\middle"}),s.push({type:"middle",mode:"math",delim:c}),n.consume(),s=s.concat(n.parseExpression(!1,null,!0)),i=n.fetch()}--n.leftrightDepth,n.expect("\\right",!1);const u=T(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:s,left:r.text,right:u.delim}},mathmlBuilder:(e,t)=>{kn(e);const r=H(e.body,t);e.left==="."&&(e.left="");const n=new p.MathNode("mo",[X(e.left,e.mode)]);n.setAttribute("fence","true"),n.setAttribute("form","prefix"),(e.left==="∖"||e.left.indexOf("arrow")>-1)&&n.setAttribute("stretchy","true"),r.unshift(n),e.right==="."&&(e.right="");const s=new p.MathNode("mo",[X(e.right,e.mode)]);return s.setAttribute("fence","true"),s.setAttribute("form","postfix"),(e.right==="∖"||e.right.indexOf("arrow")>-1)&&s.setAttribute("stretchy","true"),r.push(s),tt(r)}});k({type:"middle",names:["\\middle"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{const r=ve(t[0],e);if(!e.parser.leftrightDepth)throw new x("\\middle without preceding \\left",r);return{type:"middle",mode:e.parser.mode,delim:r.text}},mathmlBuilder:(e,t)=>{const r=X(e.delim,e.mode),n=new p.MathNode("mo",[r]);return n.setAttribute("fence","true"),e.delim.indexOf("arrow")>-1&&n.setAttribute("stretchy","true"),n.setAttribute("form","prefix"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});const qt=e=>{const t=new p.MathNode("mspace");return t.setAttribute("width","3pt"),t},Fe=(e,t)=>{let r;switch(e.label.indexOf("colorbox")>-1||e.label==="\\boxed"?r=new p.MathNode("mrow",[qt(),B(e.body,t),qt()]):r=new p.MathNode("mrow",[B(e.body,t)]),e.label){case"\\overline":r.style.padding="0.1em 0 0 0",r.style.borderTop="0.065em solid";break;case"\\underline":r.style.padding="0 0 0.1em 0",r.style.borderBottom="0.065em solid";break;case"\\cancel":r.classes.push("tml-cancel");break;case"\\bcancel":r.classes.push("tml-bcancel");break;case"\\angl":r.style.padding="0.03889em 0.03889em 0 0.03889em",r.style.borderTop="0.049em solid",r.style.borderRight="0.049em solid",r.style.marginRight="0.03889em";break;case"\\sout":r.style.backgroundImage="linear-gradient(black, black)",r.style.backgroundRepeat="no-repeat",r.style.backgroundSize="100% 1.5px",r.style.backgroundPosition="0 center";break;case"\\boxed":r.style={padding:"3pt 0 3pt 0",border:"1px solid"},r.setAttribute("scriptlevel","0"),r.setAttribute("displaystyle","true");break;case"\\fbox":r.style={padding:"3pt",border:"1px solid"};break;case"\\fcolorbox":case"\\colorbox":{const n={padding:"3pt 0 3pt 0"};e.label==="\\fcolorbox"&&(n.border="0.06em solid "+String(e.borderColor)),r.style=n;break}case"\\xcancel":r.classes.push("tml-xcancel");break}return e.backgroundColor&&r.setAttribute("mathbackground",e.backgroundColor),r};k({type:"enclose",names:["\\colorbox"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw","text"]},handler({parser:e,funcName:t},r,n){const s=n[0]&&T(n[0],"raw").string;let i="";if(s){const c=T(r[0],"raw").string;i=he(s,c)}else i=we(T(r[0],"raw").string,e.gullet.macros);const u=r[1];return{type:"enclose",mode:e.mode,label:t,backgroundColor:i,body:u}},mathmlBuilder:Fe});k({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,numOptionalArgs:1,allowedInText:!0,argTypes:["raw","raw","raw","text"]},handler({parser:e,funcName:t},r,n){const s=n[0]&&T(n[0],"raw").string;let i="",u;if(s){const h=T(r[0],"raw").string,y=T(r[0],"raw").string;i=he(s,h),u=he(s,y)}else i=we(T(r[0],"raw").string,e.gullet.macros),u=we(T(r[1],"raw").string,e.gullet.macros);const c=r[2];return{type:"enclose",mode:e.mode,label:t,backgroundColor:u,borderColor:i,body:c}},mathmlBuilder:Fe});k({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler({parser:e},t){return{type:"enclose",mode:e.mode,label:"\\fbox",body:t[0]}}});k({type:"enclose",names:["\\angl","\\cancel","\\bcancel","\\xcancel","\\sout","\\overline","\\boxed"],props:{numArgs:1},handler({parser:e,funcName:t},r){const n=r[0];return{type:"enclose",mode:e.mode,label:t,body:n}},mathmlBuilder:Fe});k({type:"enclose",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler({parser:e,funcName:t},r){const n=r[0];return{type:"enclose",mode:e.mode,label:t,body:n}},mathmlBuilder:Fe});const sr={};function Y({type:e,names:t,props:r,handler:n,mathmlBuilder:s}){const i={type:e,numArgs:r.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:n};for(let u=0;u<t.length;++u)sr[t[u]]=i;s&&(Ne[e]=s)}const F={DISPLAY:0,TEXT:1,SCRIPT:2,SCRIPTSCRIPT:3};function Tt(e){const t=[];e.consumeSpaces();let r=e.fetch().text;for(r==="\\relax"&&(e.consume(),e.consumeSpaces(),r=e.fetch().text);r==="\\hline"||r==="\\hdashline";)e.consume(),t.push(r==="\\hdashline"),e.consumeSpaces(),r=e.fetch().text;return t}const Ae=e=>{if(!e.parser.settings.displayMode)throw new x(`{${e.envName}} can be used only in display mode.`)},An=(e,t,r)=>{let n;const s=e.tags.shift();if(s)if(s.body)n=ae(s.body,t,!0),n.classes=["tml-tag"];else return n=new p.MathNode("mtext",[],[]),n;else{if(e.envClasses.includes("multline")&&(e.leqno&&r!==0||!e.leqno&&r!==e.body.length-1))return n=new p.MathNode("mtext",[],[]),n;n=new p.MathNode("mtext",[new Yt(["tml-eqn"])])}return n};function ie(e,{cols:t,envClasses:r,addEqnNum:n,singleRow:s,emptySingleRow:i,maxNumCols:u,leqno:c},h){e.gullet.beginGroup(),s||e.gullet.macros.set("\\cr","\\\\\\relax"),n&&(e.gullet.macros.set("\\tag","\\@ifstar\\envtag@literal\\envtag@paren"),e.gullet.macros.set("\\envtag@paren","\\env@tag{{(\\text{#1})}}"),e.gullet.macros.set("\\envtag@literal","\\env@tag{\\text{#1}}"),e.gullet.macros.set("\\notag","\\env@notag"),e.gullet.macros.set("\\nonumber","\\env@notag")),e.gullet.beginGroup();let y=[];const S=[y],_=[],g=[];let v;const $=[];for($.push(Tt(e));;){let j=e.parseExpression(!1,s?"\\end":"\\\\");if(n&&!v){for(let E=0;E<j.length;E++)if(j[E].type==="envTag"||j[E].type==="noTag"){v=j[E].type==="envTag"?j.splice(E,1)[0].body.body[0]:{body:null};break}}e.gullet.endGroup(),e.gullet.beginGroup(),j={type:"ordgroup",mode:e.mode,body:j,semisimple:!0},y.push(j);const J=e.fetch().text;if(J==="&"){if(u&&y.length===u)if(r.includes("array")){if(e.settings.strict)throw new x("Too few columns specified in the {array} column argument.",e.nextToken)}else throw u===2?new x("The split environment accepts no more than two columns",e.nextToken):new x("The equation environment accepts only one column",e.nextToken);e.consume()}else if(J==="\\end"){y.length===1&&j.body.length===0&&(S.length>1||!i)&&S.pop(),$.length<S.length+1&&$.push([]);break}else if(J==="\\\\"){e.consume();let E;e.gullet.future().text!==" "&&(E=e.parseSizeGroup(!0)),_.push(E?E.value:null),g.push(v),$.push(Tt(e)),y=[],v=null,S.push(y)}else throw new x("Expected & or \\\\ or \\cr or \\end",e.nextToken)}return e.gullet.endGroup(),e.gullet.endGroup(),g.push(v),{type:"array",mode:e.mode,body:S,cols:t,rowGaps:_,hLinesBeforeRow:$,envClasses:r,addEqnNum:n,scriptLevel:h,tags:g,leqno:c}}function ar(e){return e.slice(0,1)==="d"?"display":"text"}const Sn={c:"center ",l:"left ",r:"right "},$t=e=>{const t=new p.MathNode("mtd",[]);return t.style={padding:"0",width:"50%"},e.envClasses.includes("multline")&&(t.style.width="7.5%"),t},K=function(e,t){const r=[],n=e.body.length,s=e.hLinesBeforeRow;for(let c=0;c<n;c++){const h=e.body[c],y=[],S=e.scriptLevel==="text"?F.TEXT:e.scriptLevel==="script"?F.SCRIPT:F.DISPLAY;for(let g=0;g<h.length;g++){const v=new p.MathNode("mtd",[B(h[g],t.withLevel(S))]);if(e.envClasses.includes("multline")){const $=c===0?"left":c===n-1?"right":"center";v.setAttribute("columnalign",$),$!=="center"&&v.classes.push("tml-"+$)}y.push(v)}if(e.addEqnNum){y.unshift($t(e)),y.push($t(e));const g=An(e,t.withLevel(S),c);e.leqno?(y[0].children.push(g),y[0].classes.push("tml-left")):(y[y.length-1].children.push(g),y[y.length-1].classes.push("tml-right"))}const _=new p.MathNode("mtr",y,[]);c===0&&s[0].length>0&&(s[0].length===2?_.children.forEach(g=>{g.style.borderTop="0.15em double"}):_.children.forEach(g=>{g.style.borderTop=s[0][0]?"0.06em dashed":"0.06em solid"})),s[c+1].length>0&&(s[c+1].length===2?_.children.forEach(g=>{g.style.borderBottom="0.15em double"}):_.children.forEach(g=>{g.style.borderBottom=s[c+1][0]?"0.06em dashed":"0.06em solid"})),r.push(_)}if(e.envClasses.length>0){const c=e.envClasses.includes("jot")?"0.7":e.envClasses.includes("small")?"0.35":"0.5",h=e.envClasses.includes("abut")||e.envClasses.includes("cases")?"0":e.envClasses.includes("small")?"0.1389":e.envClasses.includes("cd")?"0.25":"0.4",y=r.length===0?0:r[0].children.length,S=(g,v)=>g===0&&v===0||g===y-1&&v===1?"0":e.envClasses[0]!=="align"?h:v===1?"0":e.addEqnNum?g%2?"1":"0":g%2?"0":"1";for(let g=0;g<r.length;g++)for(let v=0;v<r[g].children.length;v++)r[g].children[v].style.padding=`${c}ex ${S(v,1)}em ${c}ex ${S(v,0)}em`;const _=e.envClasses.includes("align")||e.envClasses.includes("alignat");for(let g=0;g<r.length;g++){const v=r[g];if(_){for(let $=0;$<v.children.length;$++)v.children[$].classes=["tml-"+($%2?"left":"right")];if(e.addEqnNum){const $=e.leqno?0:v.children.length-1;v.children[$].classes=["tml-"+(e.leqno?"left":"right")]}}if(v.children.length>1&&e.envClasses.includes("cases")&&(v.children[1].style.padding=v.children[1].style.padding.replace(/0em$/,"1em")),e.envClasses.includes("cases")||e.envClasses.includes("subarray"))for(const $ of v.children)$.classes.push("tml-left")}}else for(let c=0;c<r.length;c++)r[c].children[0].style.paddingLeft="0em",r[c].children.length===r[0].children.length&&(r[c].children[r[c].children.length-1].style.paddingRight="0em");let i=new p.MathNode("mtable",r);e.scriptLevel==="display"&&i.setAttribute("displaystyle","true"),(e.addEqnNum||e.envClasses.includes("multline"))&&(i.style.width="100%");let u="";if(e.cols&&e.cols.length>0){const c=e.cols;let h=!1,y=0,S=c.length;for(;c[y].type==="separator";)y+=1;for(;c[S-1].type==="separator";)S-=1;if(c[0].type==="separator"){const g=c[1].type==="separator"?"0.15em double":c[0].separator==="|"?"0.06em solid ":"0.06em dashed ";for(const v of i.children)v.children[0].style.borderLeft=g}let _=e.addEqnNum?0:-1;for(let g=y;g<S;g++)if(c[g].type==="align"){const v=Sn[c[g].align];u+=v,_+=1;for(const $ of i.children)v.trim()!=="center"&&_<$.children.length&&($.children[_].classes=["tml-"+v.trim()]);h=!0}else if(c[g].type==="separator"){if(h){const v=c[g+1].type==="separator"?"0.15em double":c[g].separator==="|"?"0.06em solid":"0.06em dashed";for(const $ of i.children)_<$.children.length&&($.children[_].style.borderRight=v)}h=!1}if(c[c.length-1].type==="separator"){const g=c[c.length-2].type==="separator"?"0.15em double":c[c.length-1].separator==="|"?"0.06em solid":"0.06em dashed";for(const v of i.children)v.children[v.children.length-1].style.borderRight=g,v.children[v.children.length-1].style.paddingRight="0.4em"}}return e.addEqnNum&&(u="left "+(u.length>0?u:"center ")+"right "),u&&i.setAttribute("columnalign",u.trim()),e.envClasses.includes("small")&&(i=new p.MathNode("mstyle",[i]),i.setAttribute("scriptlevel","1")),i},ir=function(e,t){e.envName.indexOf("ed")===-1&&Ae(e);const r=[],n=ie(e.parser,{cols:r,addEqnNum:e.envName==="align"||e.envName==="alignat",emptySingleRow:!0,envClasses:["abut","jot"],maxNumCols:e.envName==="split"?2:void 0,leqno:e.parser.settings.leqno},"display");let s,i=0;const u=e.envName.indexOf("at")>-1;if(t[0]&&u){let c="";for(let h=0;h<t[0].body.length;h++){const y=T(t[0].body[h],"textord");c+=y.text}if(isNaN(c))throw new x("The alignat enviroment requires a numeric first argument.");s=Number(c),i=s*2}n.body.forEach(function(c){if(u){const h=c.length/2;if(s<h)throw new x(`Too many math in a row: expected ${s}, but got ${h}`,c[0])}else i<c.length&&(i=c.length)});for(let c=0;c<i;++c){let h="r";c%2===1&&(h="l"),r[c]={type:"align",align:h}}return e.envName==="split"||(u?n.envClasses.push("alignat"):n.envClasses[0]="align"),n};Y({type:"array",names:["array","darray"],props:{numArgs:1},handler(e,t){const s=(Le(t[0])?[t[0]]:T(t[0],"ordgroup").body).map(function(u){const h=rt(u).text;if("lcr".indexOf(h)!==-1)return{type:"align",align:h};if(h==="|")return{type:"separator",separator:"|"};if(h===":")return{type:"separator",separator:":"};throw new x("Unknown column alignment: "+h,u)}),i={cols:s,envClasses:["array"],maxNumCols:s.length};return ie(e.parser,i,ar(e.envName))},mathmlBuilder:K});Y({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(e){const t={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[e.envName.replace("*","")];let r="c";const n={envClasses:[],cols:[]};if(e.envName.charAt(e.envName.length-1)==="*"){const i=e.parser;if(i.consumeSpaces(),i.fetch().text==="["){if(i.consume(),i.consumeSpaces(),r=i.fetch().text,"lcr".indexOf(r)===-1)throw new x("Expected l or c or r",i.nextToken);i.consume(),i.consumeSpaces(),i.expect("]"),i.consume(),n.cols=[]}}const s=ie(e.parser,n,"text");return s.cols=new Array(s.body[0].length).fill({type:"align",align:r}),t?{type:"leftright",mode:e.mode,body:[s],left:t[0],right:t[1],rightColor:void 0}:s},mathmlBuilder:K});Y({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){const t={type:"small"},r=ie(e.parser,t,"script");return r.envClasses=["small"],r},mathmlBuilder:K});Y({type:"array",names:["subarray"],props:{numArgs:1},handler(e,t){const s=(Le(t[0])?[t[0]]:T(t[0],"ordgroup").body).map(function(u){const h=rt(u).text;if("lc".indexOf(h)!==-1)return{type:"align",align:h};throw new x("Unknown column alignment: "+h,u)});if(s.length>1)throw new x("{subarray} can contain only one column");let i={cols:s,envClasses:["small"]};if(i=ie(e.parser,i,"script"),i.body.length>0&&i.body[0].length>1)throw new x("{subarray} can contain only one column");return i},mathmlBuilder:K});Y({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){const t={cols:[],envClasses:["cases"]},r=ie(e.parser,t,ar(e.envName));return{type:"leftright",mode:e.mode,body:[r],left:e.envName.indexOf("r")>-1?".":"\\{",right:e.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},mathmlBuilder:K});Y({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:ir,mathmlBuilder:K});Y({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:ir,mathmlBuilder:K});Y({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){e.envName!=="gathered"&&Ae(e);const t={cols:[],envClasses:["abut","jot"],addEqnNum:e.envName==="gather",emptySingleRow:!0,leqno:e.parser.settings.leqno};return ie(e.parser,t,"display")},mathmlBuilder:K});Y({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){Ae(e);const t={addEqnNum:e.envName==="equation",emptySingleRow:!0,singleRow:!0,maxNumCols:1,envClasses:["align"],leqno:e.parser.settings.leqno};return ie(e.parser,t,"display")},mathmlBuilder:K});Y({type:"array",names:["multline","multline*"],props:{numArgs:0},handler(e){Ae(e);const t={addEqnNum:e.envName==="multline",maxNumCols:1,envClasses:["jot","multline"],leqno:e.parser.settings.leqno};return ie(e.parser,t,"display")},mathmlBuilder:K});Y({type:"array",names:["CD"],props:{numArgs:0},handler(e){return Ae(e),pn(e.parser)},mathmlBuilder:K});k({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(e,t){throw new x(`${e.funcName} valid only within array environment`)}});const Dt=sr;k({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler({parser:e,funcName:t},r){const n=r[0];if(n.type!=="ordgroup")throw new x("Invalid environment name",n);let s="";for(let i=0;i<n.body.length;++i)s+=T(n.body[i],"textord").text;if(t==="\\begin"){if(!Object.prototype.hasOwnProperty.call(Dt,s))throw new x("No such environment: "+s,n);const i=Dt[s],{args:u,optArgs:c}=e.parseArguments("\\begin{"+s+"}",i),h={mode:e.mode,envName:s,parser:e},y=i.handler(h,u,c);e.expect("\\end",!1);const S=e.nextToken,_=T(e.parseFunction(),"environment");if(_.name!==s)throw new x(`Mismatch: \\begin{${s}} matched by \\end{${_.name}}`,S);return y}return{type:"environment",mode:e.mode,name:s,nameGroup:n}}});k({type:"envTag",names:["\\env@tag"],props:{numArgs:1,argTypes:["math"]},handler({parser:e},t){return{type:"envTag",mode:e.mode,body:t[0]}},mathmlBuilder(e,t){return new p.MathNode("mrow")}});k({type:"noTag",names:["\\env@notag"],props:{numArgs:0},handler({parser:e}){return{type:"noTag",mode:e.mode}},mathmlBuilder(e,t){return new p.MathNode("mrow")}});const ur=(e,t)=>{const r=e.font,n=t.withFont(r),s=B(e.body,n);if(s.children.length===0)return s;if(r==="boldsymbol"&&["mo","mpadded","mrow"].includes(s.type))return s.style.fontWeight="bold",s;let i=s.children[0].type==="mo";for(let c=1;c<s.children.length;c++)s.children[c].type==="mo"&&r==="boldsymbol"&&(s.children[c].style.fontWeight="bold"),s.children[c].type!=="mi"&&(i=!1),(s.children[c].attributes&&s.children[c].attributes.mathvariant||"")!=="normal"&&(i=!1);if(!i)return s;const u=s.children[0];for(let c=1;c<s.children.length;c++)u.children.push(s.children[c].children[0]);if(u.attributes.mathvariant&&u.attributes.mathvariant==="normal"){const c=new p.MathNode("mtext",new p.TextNode("​"));return new p.MathNode("mrow",[c,u])}return u},Ot={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};k({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\up@greek","\\boldsymbol","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bm","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:({parser:e,funcName:t},r)=>{const n=ye(r[0]);let s=t;return s in Ot&&(s=Ot[s]),{type:"font",mode:e.mode,font:s.slice(1),body:n}},mathmlBuilder:ur});k({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:({parser:e,funcName:t,breakOnTokenText:r},n)=>{const{mode:s}=e,i=e.parseExpression(!0,r,!0),u=`math${t.slice(1)}`;return{type:"font",mode:s,font:u,body:{type:"ordgroup",mode:e.mode,body:i}}},mathmlBuilder:ur});const Ct=["display","text","script","scriptscript"],_n={auto:-1,display:0,text:0,script:1,scriptscript:2},nt=(e,t)=>{const r=e.scriptLevel==="auto"?t.incrementLevel():e.scriptLevel==="display"?t.withLevel(F.TEXT):e.scriptLevel==="text"?t.withLevel(F.SCRIPT):t.withLevel(F.SCRIPTSCRIPT);let n=new p.MathNode("mfrac",[B(e.numer,r),B(e.denom,r)]);if(!e.hasBarLine)n.setAttribute("linethickness","0px");else if(e.barSize){const s=oe(e.barSize,t);n.setAttribute("linethickness",s.number+s.unit)}if(e.leftDelim!=null||e.rightDelim!=null){const s=[];if(e.leftDelim!=null){const i=new p.MathNode("mo",[new p.TextNode(e.leftDelim.replace("\\",""))]);i.setAttribute("fence","true"),s.push(i)}if(s.push(n),e.rightDelim!=null){const i=new p.MathNode("mo",[new p.TextNode(e.rightDelim.replace("\\",""))]);i.setAttribute("fence","true"),s.push(i)}n=tt(s)}return e.scriptLevel!=="auto"&&(n=new p.MathNode("mstyle",[n]),n.setAttribute("displaystyle",String(e.scriptLevel==="display")),n.setAttribute("scriptlevel",_n[e.scriptLevel])),n};k({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:({parser:e,funcName:t},r)=>{const n=r[0],s=r[1];let i=!1,u=null,c=null,h="auto";switch(t){case"\\dfrac":case"\\frac":case"\\tfrac":i=!0;break;case"\\\\atopfrac":i=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":u="(",c=")";break;case"\\\\bracefrac":u="\\{",c="\\}";break;case"\\\\brackfrac":u="[",c="]";break;default:throw new Error("Unrecognized genfrac command")}switch(t){case"\\dfrac":case"\\dbinom":h="display";break;case"\\tfrac":case"\\tbinom":h="text";break}return{type:"genfrac",mode:e.mode,continued:!1,numer:n,denom:s,hasBarLine:i,leftDelim:u,rightDelim:c,scriptLevel:h,barSize:null}},mathmlBuilder:nt});k({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:({parser:e,funcName:t},r)=>{const n=r[0],s=r[1];return{type:"genfrac",mode:e.mode,continued:!0,numer:n,denom:s,hasBarLine:!0,leftDelim:null,rightDelim:null,scriptLevel:"display",barSize:null}}});k({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler({parser:e,funcName:t,token:r}){let n;switch(t){case"\\over":n="\\frac";break;case"\\choose":n="\\binom";break;case"\\atop":n="\\\\atopfrac";break;case"\\brace":n="\\\\bracefrac";break;case"\\brack":n="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:n,token:r}}});const Nt=function(e){let t=null;return e.length>0&&(t=e,t=t==="."?null:t),t};k({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler({parser:e},t){const r=t[4],n=t[5],s=ye(t[0]),i=s.type==="atom"&&s.family==="open"?Nt(s.text):null,u=ye(t[1]),c=u.type==="atom"&&u.family==="close"?Nt(u.text):null,h=T(t[2],"size");let y,S=null;h.isBlank?y=!0:(S=h.value,y=S.number>0);let _="auto",g=t[3];if(g.type==="ordgroup"){if(g.body.length>0){const v=T(g.body[0],"textord");_=Ct[Number(v.text)]}}else g=T(g,"textord"),_=Ct[Number(g.text)];return{type:"genfrac",mode:e.mode,numer:r,denom:n,continued:!1,hasBarLine:y,barSize:S,leftDelim:i,rightDelim:c,scriptLevel:_}},mathmlBuilder:nt});k({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler({parser:e,funcName:t,token:r},n){return{type:"infix",mode:e.mode,replaceWith:"\\\\abovefrac",barSize:T(n[0],"size").value,token:r}}});k({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:({parser:e,funcName:t},r)=>{const n=r[0],s=Er(T(r[1],"infix").barSize),i=r[2],u=s.number>0;return{type:"genfrac",mode:e.mode,numer:n,denom:i,continued:!1,hasBarLine:u,barSize:s,leftDelim:null,rightDelim:null,scriptLevel:"auto"}},mathmlBuilder:nt});k({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["hbox"],allowedInArgument:!0,allowedInText:!1},handler({parser:e},t){return{type:"hbox",mode:e.mode,body:L(t[0])}},mathmlBuilder(e,t){const r=t.withLevel(F.TEXT),n=ae(e.body,r);return et(n)}});const qn=(e,t)=>{const r=ze.mathMLnode(e.label);return r.style["math-depth"]=0,new p.MathNode(e.isOver?"mover":"munder",[B(e.base,t),r])};k({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler({parser:e,funcName:t},r){return{type:"horizBrace",mode:e.mode,label:t,isOver:/^\\over/.test(t),base:r[0]}},mathmlBuilder:qn});k({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:({parser:e,token:t},r)=>{const n=r[1],s=T(r[0],"url").url;if(!e.settings.isTrusted({command:"\\href",url:s}))throw new x('Function "\\href" is not trusted',t);return{type:"href",mode:e.mode,href:s,body:L(n)}},mathmlBuilder:(e,t)=>{let r=ae(e.body,t);return r instanceof W||(r=new W("mrow",[r])),r.setAttribute("href",e.href),r}});k({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:({parser:e,token:t},r)=>{const n=T(r[0],"url").url;if(!e.settings.isTrusted({command:"\\url",url:n}))throw new x('Function "\\url" is not trusted',t);const s=[];for(let u=0;u<n.length;u++){let c=n[u];c==="~"&&(c="\\textasciitilde"),s.push({type:"textord",mode:"text",text:c})}const i={type:"text",mode:e.mode,font:"\\texttt",body:s};return{type:"href",mode:e.mode,href:n,body:L(i)}}});k({type:"html",names:["\\class","\\id","\\style","\\data"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:({parser:e,funcName:t,token:r},n)=>{const s=T(n[0],"raw").string,i=n[1];if(e.settings.strict)throw new x(`Function "${t}" is disabled in strict mode`,r);let u;const c={};switch(t){case"\\class":c.class=s,u={command:"\\class",class:s};break;case"\\id":c.id=s,u={command:"\\id",id:s};break;case"\\style":c.style=s,u={command:"\\style",style:s};break;case"\\data":{const h=s.split(",");for(let y=0;y<h.length;y++){const S=h[y].split("=");if(S.length!==2)throw new x("Error parsing key-value for \\data");c["data-"+S[0].trim()]=S[1].trim()}u={command:"\\data",attributes:c};break}default:throw new Error("Unrecognized html command")}if(!e.settings.isTrusted(u))throw new x(`Function "${t}" is not trusted`,r);return{type:"html",mode:e.mode,attributes:c,body:L(i)}},mathmlBuilder:(e,t)=>{const r=ae(e.body,t),n=[];e.attributes.class&&n.push(...e.attributes.class.trim().split(/\s+/)),r.classes=n;for(const s in e.attributes)s!=="class"&&Object.prototype.hasOwnProperty.call(e.attributes,s)&&r.setAttribute(s,e.attributes[s]);return r}});const Ue=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};{const t=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!t)throw new x("Invalid size: '"+e+"' in \\includegraphics");const r={number:+(t[1]+t[2]),unit:t[3]};if(!er(r))throw new x("Invalid unit: '"+r.unit+"' in \\includegraphics.");return r}};k({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:({parser:e,token:t},r,n)=>{let s={number:0,unit:"em"},i={number:.9,unit:"em"},u={number:0,unit:"em"},c="";if(n[0]){const S=T(n[0],"raw").string.split(",");for(let _=0;_<S.length;_++){const g=S[_].split("=");if(g.length===2){const v=g[1].trim();switch(g[0].trim()){case"alt":c=v;break;case"width":s=Ue(v);break;case"height":i=Ue(v);break;case"totalheight":u=Ue(v);break;default:throw new x("Invalid key: '"+g[0]+"' in \\includegraphics.")}}}}const h=T(r[0],"url").url;if(c===""&&(c=h,c=c.replace(/^.*[\\/]/,""),c=c.substring(0,c.lastIndexOf("."))),!e.settings.isTrusted({command:"\\includegraphics",url:h}))throw new x('Function "\\includegraphics" is not trusted',t);return{type:"includegraphics",mode:e.mode,alt:c,width:s,height:i,totalheight:u,src:h}},mathmlBuilder:(e,t)=>{const r=oe(e.height,t),n={number:0,unit:"em"};e.totalheight.number>0&&e.totalheight.unit===r.unit&&e.totalheight.number>r.number&&(n.number=e.totalheight.number-r.number,n.unit=r.unit);let s=0;e.width.number>0&&(s=oe(e.width,t));const i={height:r.number+n.number+"em"};s.number>0&&(i.width=s.number+s.unit),n.number>0&&(i.verticalAlign=-n.number+n.unit);const u=new Rr(e.src,e.alt,i);return u.height=r,u.depth=n,new p.MathNode("mtext",[u])}});k({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler({parser:e,funcName:t,token:r},n){const s=T(n[0],"size");if(e.settings.strict){const i=t[1]==="m",u=s.value.unit==="mu";if(i){if(!u)throw new x(`LaTeX's ${t} supports only mu units, not ${s.value.unit} units`,r);if(e.mode!=="math")throw new x(`LaTeX's ${t} works only in math mode`,r)}else if(u)throw new x(`LaTeX's ${t} doesn't support mu units`,r)}return{type:"kern",mode:e.mode,dimension:s.value}},mathmlBuilder(e,t){const r=oe(e.dimension,t),n=r.unit==="em"?lr(r.number):"";if(e.mode==="text"&&n.length>0){const s=new p.TextNode(n);return new p.MathNode("mtext",[s])}else{const s=new p.MathNode("mspace");return s.setAttribute("width",r.number+r.unit),r.number<0&&(s.style.marginLeft=r.number+r.unit),s}}});const lr=function(e){return e>=.05555&&e<=.05556?" ":e>=.1666&&e<=.1667?" ":e>=.2222&&e<=.2223?" ":e>=.2777&&e<=.2778?"  ":""},cr=/[^A-Za-z_0-9-]/g;k({type:"label",names:["\\label"],props:{numArgs:1,argTypes:["raw"]},handler({parser:e},t){return{type:"label",mode:e.mode,string:t[0].string.replace(cr,"")}},mathmlBuilder(e,t){const r=new p.MathNode("mrow",[],["tml-label"]);return e.string.length>0&&r.setAttribute("id",e.string),r}});const Tn=["\\clap","\\llap","\\rlap"];k({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap","\\clap","\\llap","\\rlap"],props:{numArgs:1,allowedInText:!0},handler:({parser:e,funcName:t,token:r},n)=>{if(Tn.includes(t)){if(e.settings.strict&&e.mode!=="text")throw new x(`{${t}} can be used only in text mode.
 Try \\math${t.slice(1)}`,r);t=t.slice(1)}else t=t.slice(5);const s=n[0];return{type:"lap",mode:e.mode,alignment:t,body:s}},mathmlBuilder:(e,t)=>{let r;if(e.alignment==="llap"){const i=H(L(e.body),t),u=new p.MathNode("mphantom",i);r=new p.MathNode("mpadded",[u]),r.setAttribute("width","0px")}const n=B(e.body,t);let s;if(e.alignment==="llap"?(n.style.position="absolute",n.style.right="0",n.style.bottom="0",s=new p.MathNode("mpadded",[r,n])):s=new p.MathNode("mpadded",[n]),e.alignment==="rlap")e.body.body.length>0&&e.body.body[0].type==="genfrac"&&s.setAttribute("lspace","0.16667em");else{const i=e.alignment==="llap"?"-1":"-0.5";s.setAttribute("lspace",i+"width"),e.alignment==="llap"?s.style.position="relative":(s.style.display="flex",s.style.justifyContent="center")}return s.setAttribute("width","0px"),s}});k({type:"ordgroup",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler({funcName:e,parser:t},r){const n=t.mode;t.switchMode("math");const s=e==="\\("?"\\)":"$",i=t.parseExpression(!1,s);return t.expect(s),t.switchMode(n),{type:"ordgroup",mode:t.mode,body:i}}});k({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){throw new x(`Mismatched ${e.funcName}`,t)}});const $n=(e,t)=>{switch(t.level){case F.DISPLAY:return e.display;case F.TEXT:return e.text;case F.SCRIPT:return e.script;case F.SCRIPTSCRIPT:return e.scriptscript;default:return e.text}};k({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:({parser:e},t)=>({type:"mathchoice",mode:e.mode,display:L(t[0]),text:L(t[1]),script:L(t[2]),scriptscript:L(t[3])}),mathmlBuilder:(e,t)=>{const r=$n(e,t);return ae(r,t)}});const Dn=["text","textord","mathord","atom"],ue=e=>{const t=new p.MathNode("mspace");return t.setAttribute("width",e+"em"),t};function dr(e,t){let r;const n=H(e.body,t);if(e.mclass==="minner")r=new p.MathNode("mpadded",n);else if(e.mclass==="mord")e.isCharacterBox||n[0].type==="mathord"?(r=n[0],r.type="mi",r.children.length===1&&r.children[0].text&&r.children[0].text==="∇"&&r.setAttribute("mathvariant","normal")):r=new p.MathNode("mi",n);else{r=new p.MathNode("mrow",n),e.mustPromote?(r=n[0],r.type="mo",e.isCharacterBox&&e.body[0].text&&/[A-Za-z]/.test(e.body[0].text)&&r.setAttribute("mathvariant","italic")):r=new p.MathNode("mrow",n);const s=t.level<2;r.type==="mrow"?s&&(e.mclass==="mbin"?(r.children.unshift(ue(.2222)),r.children.push(ue(.2222))):e.mclass==="mrel"?(r.children.unshift(ue(.2778)),r.children.push(ue(.2778))):e.mclass==="mpunct"?r.children.push(ue(.1667)):e.mclass==="minner"&&(r.children.unshift(ue(.0556)),r.children.push(ue(.0556)))):e.mclass==="mbin"?(r.attributes.lspace=s?"0.2222em":"0",r.attributes.rspace=s?"0.2222em":"0"):e.mclass==="mrel"?(r.attributes.lspace=s?"0.2778em":"0",r.attributes.rspace=s?"0.2778em":"0"):e.mclass==="mpunct"?(r.attributes.lspace="0em",r.attributes.rspace=s?"0.1667em":"0"):e.mclass==="mopen"||e.mclass==="mclose"?(r.attributes.lspace="0em",r.attributes.rspace="0em"):e.mclass==="minner"&&s&&(r.attributes.lspace="0.0556em",r.attributes.width="+0.1111em"),e.mclass==="mopen"||e.mclass==="mclose"||(delete r.attributes.stretchy,delete r.attributes.form)}return r}k({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler({parser:e,funcName:t},r){const n=r[0],s=C.isCharacterBox(n);let i=!0;const u={type:"mathord",text:"",mode:e.mode},c=n.body?n.body:[n];for(const h of c)if(Dn.includes(h.type))P[e.mode][h.text]?u.text+=P[e.mode][h.text].replace:h.text?u.text+=h.text:h.body&&h.body.map(y=>{u.text+=y.text});else{i=!1;break}return{type:"mclass",mode:e.mode,mclass:"m"+t.slice(5),body:L(i?u:n),isCharacterBox:s,mustPromote:i}},mathmlBuilder:dr});const On=e=>{const t=e.type==="ordgroup"&&e.body.length?e.body[0]:e;return t.type==="atom"&&(t.family==="bin"||t.family==="rel")?"m"+t.family:"mord"};k({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler({parser:e},t){return{type:"mclass",mode:e.mode,mclass:On(t[0]),body:L(t[1]),isCharacterBox:C.isCharacterBox(t[1])}}});k({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler({parser:e,funcName:t},r){const n=r[1],s=r[0],i={type:"op",mode:n.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,stack:!0,suppressBaseShift:t!=="\\stackrel",body:L(n)};return{type:"supsub",mode:s.mode,base:i,sup:t==="\\underset"?null:s,sub:t==="\\underset"?s:null}},mathmlBuilder:dr});const $e=(e,t,r)=>{if(!e)return r;const n=B(e,t);return n.type==="mrow"&&n.children.length===0?r:n};k({type:"multiscript",names:["\\sideset","\\pres@cript"],props:{numArgs:3},handler({parser:e,funcName:t,token:r},n){if(n[2].body.length===0)throw new x(t+"cannot parse an empty base.");const s=n[2].body[0];if(e.settings.strict&&t==="\\sideset"&&!s.symbol)throw new x("The base of \\sideset must be a big operator. Try \\prescript.");if(n[0].body.length>0&&n[0].body[0].type!=="supsub"||n[1].body.length>0&&n[1].body[0].type!=="supsub")throw new x("\\sideset can parse only subscripts and superscripts in its first two arguments",r);const i=n[0].body.length>0?n[0].body[0]:null,u=n[1].body.length>0?n[1].body[0]:null;return!i&&!u?s:i?{type:"multiscript",mode:e.mode,isSideset:t==="\\sideset",prescripts:i,postscripts:u,base:s}:{type:"styling",mode:e.mode,scriptLevel:"text",body:[{type:"supsub",mode:e.mode,base:s,sup:u.sup,sub:u.sub}]}},mathmlBuilder(e,t){const r=B(e.base,t),n=new p.MathNode("mprescripts"),s=new p.MathNode("none");let i=[];const u=$e(e.prescripts.sub,t,s),c=$e(e.prescripts.sup,t,s);if(e.isSideset&&(u.setAttribute("style","text-align: left;"),c.setAttribute("style","text-align: left;")),e.postscripts){const h=$e(e.postscripts.sub,t,s),y=$e(e.postscripts.sup,t,s);i=[r,h,y,n,u,c]}else i=[r,n,u,c];return new p.MathNode("mmultiscripts",i)}});k({type:"not",names:["\\not"],props:{numArgs:1,primitive:!0,allowedInText:!1},handler({parser:e},t){const r=C.isCharacterBox(t[0]);let n;return r?(n=L(t[0]),n[0].text.charAt(0)==="\\"&&(n[0].text=P.math[n[0].text].replace),n[0].text=n[0].text.slice(0,1)+"̸"+n[0].text.slice(1)):n=[{type:"textord",mode:"math",text:"̸"},{type:"kern",mode:"math",dimension:{number:-.6,unit:"em"}},t[0]],{type:"not",mode:e.mode,body:n,isCharacterBox:r}},mathmlBuilder(e,t){return e.isCharacterBox?H(e.body,t,!0)[0]:ae(e.body,t)}});const Cn=["textord","mathord","atom"],Nn=["\\smallint"],ot=["textord","mathord","ordgroup","close","leftright"],Bt=e=>{e.attributes.lspace="0.1667em",e.attributes.rspace="0.1667em"},Se=(e,t)=>{let r;if(e.symbol)r=new W("mo",[X(e.name,e.mode)]),Nn.includes(e.name)?r.setAttribute("largeop","false"):r.setAttribute("movablelimits","false"),e.fromMathOp&&Bt(r);else if(e.body)r=new W("mo",H(e.body,t)),e.fromMathOp&&Bt(r);else if(r=new W("mi",[new Kt(e.name.slice(1))]),!e.parentIsSupSub){const n=new W("mo",[X("⁡","text")]),s=[r,n];if(e.needsLeadingSpace){const i=new W("mspace");i.setAttribute("width","0.1667em"),s.unshift(i)}if(!e.isFollowedByDelimiter){const i=new W("mspace");i.setAttribute("width","0.1667em"),s.push(i)}r=new W("mrow",s)}return r},Bn={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨅":"\\bigsqcap","⨆":"\\bigsqcup","⨉":"\\bigtimes"};k({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcap","\\bigsqcup","\\bigtimes","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:({parser:e,funcName:t},r)=>{let n=t;return n.length===1&&(n=Bn[n]),{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!0,stack:!1,name:n}},mathmlBuilder:Se});k({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:({parser:e},t)=>{const r=t[0],n=r.body?r.body:[r],s=n.length===1&&Cn.includes(n[0].type);return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:s,fromMathOp:!0,stack:!1,name:s?n[0].text:null,body:s?null:L(r)}},mathmlBuilder:Se});const Mn={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint","∱":"\\intclockwise","∲":"\\varointclockwise","⨌":"\\iiiint","⨍":"\\intbar","⨎":"\\intBar","⨏":"\\fint","⨒":"\\rppolint","⨓":"\\scpolint","⨕":"\\pointint","⨖":"\\sqint","⨗":"\\intlarhk","⨘":"\\intx","⨙":"\\intcap","⨚":"\\intcup"};k({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\sgn","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler({parser:e,funcName:t}){const r=e.prevAtomType,n=e.gullet.future().text;return{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!1,stack:!1,isFollowedByDelimiter:Ie(n),needsLeadingSpace:r.length>0&&ot.includes(r),name:t}},mathmlBuilder:Se});k({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler({parser:e,funcName:t}){const r=e.prevAtomType,n=e.gullet.future().text;return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!1,stack:!1,isFollowedByDelimiter:Ie(n),needsLeadingSpace:r.length>0&&ot.includes(r),name:t}},mathmlBuilder:Se});k({type:"op",names:["\\int","\\iint","\\iiint","\\iiiint","\\oint","\\oiint","\\oiiint","\\intclockwise","\\varointclockwise","\\intbar","\\intBar","\\fint","\\rppolint","\\scpolint","\\pointint","\\sqint","\\intlarhk","\\intx","\\intcap","\\intcup","∫","∬","∭","∮","∯","∰","∱","∲","⨌","⨍","⨎","⨏","⨒","⨓","⨕","⨖","⨗","⨘","⨙","⨚"],props:{numArgs:0},handler({parser:e,funcName:t}){let r=t;return r.length===1&&(r=Mn[r]),{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!0,stack:!1,name:r}},mathmlBuilder:Se});const mr={};function l(e,t){mr[e]=t}const En=(e,t)=>{let r=H(e.body,t.withFont("mathrm")),n=!0;for(let i=0;i<r.length;i++){let u=r[i];if(u instanceof p.MathNode)switch(u.type==="mrow"&&u.children.length===1&&u.children[0]instanceof p.MathNode&&(u=u.children[0]),u.type){case"mi":case"mn":case"ms":case"mtext":break;case"mspace":if(u.attributes.width){const c=u.attributes.width.replace("em",""),h=lr(Number(c));h===""?n=!1:r[i]=new p.MathNode("mtext",[new p.TextNode(h)])}break;case"mo":{const c=u.children[0];u.children.length===1&&c instanceof p.TextNode?c.text=c.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):n=!1;break}default:n=!1}else n=!1}if(n){const i=r.map(u=>u.toText()).join("");r=[new p.TextNode(i)]}else if(r.length===1&&["mover","munder"].includes(r[0].type)&&(r[0].children[0].type==="mi"||r[0].children[0].type==="mtext")){if(r[0].children[0].type="mi",e.parentIsSupSub)return new p.MathNode("mrow",r);{const i=new p.MathNode("mo",[X("⁡","text")]);return p.newDocumentFragment([r[0],i])}}let s;if(n?(s=new p.MathNode("mi",r),r[0].text.length===1&&s.setAttribute("mathvariant","normal")):s=new p.MathNode("mrow",r),!e.parentIsSupSub){const i=new p.MathNode("mo",[X("⁡","text")]),u=[s,i];if(e.needsLeadingSpace){const c=new p.MathNode("mspace");c.setAttribute("width","0.1667em"),u.unshift(c)}if(!e.isFollowedByDelimiter){const c=new p.MathNode("mspace");c.setAttribute("width","0.1667em"),u.push(c)}return p.newDocumentFragment(u)}return s};k({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1,allowedInArgument:!0},handler:({parser:e,funcName:t},r)=>{const n=r[0],s=e.prevAtomType,i=e.gullet.future().text;return{type:"operatorname",mode:e.mode,body:L(n),alwaysHandleSupSub:t==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1,isFollowedByDelimiter:Ie(i),needsLeadingSpace:s.length>0&&ot.includes(s)}},mathmlBuilder:En});l("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");ce({type:"ordgroup",mathmlBuilder(e,t){return ae(e.body,t,e.semisimple)}});k({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:({parser:e},t)=>{const r=t[0];return{type:"phantom",mode:e.mode,body:L(r)}},mathmlBuilder:(e,t)=>{const r=H(e.body,t);return new p.MathNode("mphantom",r)}});k({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:({parser:e},t)=>{const r=t[0];return{type:"hphantom",mode:e.mode,body:r}},mathmlBuilder:(e,t)=>{const r=H(L(e.body),t),n=new p.MathNode("mphantom",r),s=new p.MathNode("mpadded",[n]);return s.setAttribute("height","0px"),s.setAttribute("depth","0px"),s}});k({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:({parser:e},t)=>{const r=t[0];return{type:"vphantom",mode:e.mode,body:r}},mathmlBuilder:(e,t)=>{const r=H(L(e.body),t),n=new p.MathNode("mphantom",r),s=new p.MathNode("mpadded",[n]);return s.setAttribute("width","0px"),s}});k({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler({parser:e},t){return{type:"pmb",mode:e.mode,body:L(t[0])}},mathmlBuilder(e,t){const r=H(e.body,t),n=Qe(r);return n.setAttribute("style","font-weight:bold"),n}});const hr=(e,t)=>{const r=t.withLevel(F.TEXT),n=new p.MathNode("mpadded",[B(e.body,r)]),s=oe(e.dy,t);return n.setAttribute("voffset",s.number+s.unit),s.number>0?n.style.padding=s.number+s.unit+" 0 0 0":n.style.padding="0 0 "+Math.abs(s.number)+s.unit+" 0",n};k({type:"raise",names:["\\raise","\\lower"],props:{numArgs:2,argTypes:["size","primitive"],primitive:!0},handler({parser:e,funcName:t},r){const n=T(r[0],"size").value;t==="\\lower"&&(n.number*=-1);const s=r[1];return{type:"raise",mode:e.mode,dy:n,body:s}},mathmlBuilder:hr});k({type:"raise",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler({parser:e,funcName:t},r){const n=T(r[0],"size").value,s=r[1];return{type:"raise",mode:e.mode,dy:n,body:s}},mathmlBuilder:hr});k({type:"ref",names:["\\ref","\\eqref"],props:{numArgs:1,argTypes:["raw"]},handler({parser:e,funcName:t},r){return{type:"ref",mode:e.mode,funcName:t,string:r[0].string.replace(cr,"")}},mathmlBuilder(e,t){const r=e.funcName==="\\ref"?["tml-ref"]:["tml-ref","tml-eqref"],n=new p.MathNode("mtext",[new p.TextNode("")],r);return n.setAttribute("href","#"+e.string),n}});k({type:"reflect",names:["\\reflectbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler({parser:e},t){return{type:"reflect",mode:e.mode,body:t[0]}},mathmlBuilder(e,t){const r=B(e.body,t);return r.style.transform="scaleX(-1)",r}});k({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler({parser:e}){return{type:"internal",mode:e.mode}}});k({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler({parser:e},t,r){const n=r[0],s=T(t[0],"size"),i=T(t[1],"size");return{type:"rule",mode:e.mode,shift:n&&T(n,"size").value,width:s.value,height:i.value}},mathmlBuilder(e,t){const r=oe(e.width,t),n=oe(e.height,t),s=e.shift?oe(e.shift,t):{number:0,unit:"em"},i=t.color&&t.getColor()||"black",u=new p.MathNode("mspace");if(r.number>0&&n.number>0&&u.setAttribute("mathbackground",i),u.setAttribute("width",r.number+r.unit),u.setAttribute("height",n.number+n.unit),s.number===0)return u;const c=new p.MathNode("mpadded",[u]);return s.number>=0?c.setAttribute("height","+"+s.number+s.unit):(c.setAttribute("height",s.number+s.unit),c.setAttribute("depth","+"+-s.number+s.unit)),c.setAttribute("voffset",s.number+s.unit),c}});const Mt={"\\tiny":.5,"\\sixptsize":.6,"\\Tiny":.6,"\\scriptsize":.7,"\\footnotesize":.8,"\\small":.9,"\\normalsize":1,"\\large":1.2,"\\Large":1.44,"\\LARGE":1.728,"\\huge":2.074,"\\Huge":2.488};k({type:"sizing",names:["\\tiny","\\sixptsize","\\Tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],props:{numArgs:0,allowedInText:!0},handler:({breakOnTokenText:e,funcName:t,parser:r},n)=>{r.settings.strict&&r.mode==="math"&&console.log(`Temml strict-mode warning: Command ${t} is invalid in math mode.`);const s=r.parseExpression(!1,e,!0);return{type:"sizing",mode:r.mode,funcName:t,body:s}},mathmlBuilder:(e,t)=>{const r=t.withFontSize(Mt[e.funcName]),n=H(e.body,r),s=Qe(n),i=(Mt[e.funcName]/t.fontSize).toFixed(4);return s.setAttribute("mathsize",i+"em"),s}});k({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:({parser:e},t,r)=>{let n=!1,s=!1;const i=r[0]&&T(r[0],"ordgroup");if(i){let c="";for(let h=0;h<i.body.length;++h)if(c=i.body[h].text,c==="t")n=!0;else if(c==="b")s=!0;else{n=!1,s=!1;break}}else n=!0,s=!0;const u=t[0];return{type:"smash",mode:e.mode,body:u,smashHeight:n,smashDepth:s}},mathmlBuilder:(e,t)=>{const r=new p.MathNode("mpadded",[B(e.body,t)]);return e.smashHeight&&r.setAttribute("height","0px"),e.smashDepth&&r.setAttribute("depth","0px"),r}});k({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler({parser:e},t,r){const n=r[0],s=t[0];return{type:"sqrt",mode:e.mode,body:s,index:n}},mathmlBuilder(e,t){const{body:r,index:n}=e;return n?new p.MathNode("mroot",[B(r,t),B(n,t.incrementLevel())]):new p.MathNode("msqrt",[B(r,t)])}});const zn={display:0,text:1,script:2,scriptscript:3},Ln={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]};k({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler({breakOnTokenText:e,funcName:t,parser:r},n){const s=r.parseExpression(!0,e,!0),i=t.slice(1,t.length-5);return{type:"styling",mode:r.mode,scriptLevel:i,body:s}},mathmlBuilder(e,t){const r=t.withLevel(zn[e.scriptLevel]),n=H(e.body,r),s=Qe(n),i=Ln[e.scriptLevel];return s.setAttribute("scriptlevel",i[0]),s.setAttribute("displaystyle",i[1]),s}});const In=/^m(over|under|underover)$/;ce({type:"supsub",mathmlBuilder(e,t){let r=!1,n,s,i=!1,u=!1,c=!1;e.base&&e.base.type==="horizBrace"&&(s=!!e.sup,s===e.base.isOver&&(r=!0,n=e.base.isOver)),e.base&&!e.base.stack&&(e.base.type==="op"||e.base.type==="operatorname")&&(e.base.parentIsSupSub=!0,i=!e.base.symbol,u=i&&!e.isFollowedByDelimiter,c=e.base.needsLeadingSpace);const h=e.base&&e.base.stack?[B(e.base.body[0],t)]:[B(e.base,t)],y=t.inSubOrSup();if(e.sub&&h.push(B(e.sub,y)),e.sup){const g=B(e.sup,y),v=g.type==="mrow"?g.children[0]:g;v.type==="mo"&&v.classes.includes("tml-prime")&&e.base&&e.base.text&&e.base.text==="f"&&v.classes.push("prime-pad"),h.push(g)}let S;if(r)S=n?"mover":"munder";else if(e.sub)if(e.sup){const g=e.base;g&&(g.type==="op"&&g.limits||g.type==="multiscript")&&(t.level===F.DISPLAY||g.alwaysHandleSupSub)||g&&g.type==="operatorname"&&g.alwaysHandleSupSub&&(t.level===F.DISPLAY||g.limits)?S="munderover":S="msubsup"}else{const g=e.base;g&&g.type==="op"&&g.limits&&(t.level===F.DISPLAY||g.alwaysHandleSupSub)||g&&g.type==="operatorname"&&g.alwaysHandleSupSub&&(g.limits||t.level===F.DISPLAY)?S="munder":S="msub"}else{const g=e.base;g&&g.type==="op"&&g.limits&&(t.level===F.DISPLAY||g.alwaysHandleSupSub)||g&&g.type==="operatorname"&&g.alwaysHandleSupSub&&(g.limits||t.level===F.DISPLAY)?S="mover":S="msup"}let _=new p.MathNode(S,h);if(i){const g=new p.MathNode("mo",[X("⁡","text")]);if(c){const v=new p.MathNode("mspace");v.setAttribute("width","0.1667em"),_=p.newDocumentFragment([v,_,g])}else _=p.newDocumentFragment([_,g]);if(u){const v=new p.MathNode("mspace");v.setAttribute("width","0.1667em"),_.children.push(v)}}else In.test(S)&&(_=new p.MathNode("mrow",[_]));return _}});const Fn=["\\shortmid","\\nshortmid","\\shortparallel","\\nshortparallel","\\smallsetminus"],Pn=["\\Rsh","\\Lsh","\\restriction"],Gn=e=>{if(e.length===1){const t=e.codePointAt(0);return 8591<t&&t<8704}return e.indexOf("arrow")>-1||e.indexOf("harpoon")>-1||Pn.includes(e)};ce({type:"atom",mathmlBuilder(e,t){const r=new p.MathNode("mo",[X(e.text,e.mode)]);return e.family==="punct"?r.setAttribute("separator","true"):e.family==="open"||e.family==="close"?e.family==="open"?(r.setAttribute("form","prefix"),r.setAttribute("stretchy","false")):e.family==="close"&&(r.setAttribute("form","postfix"),r.setAttribute("stretchy","false")):e.text==="\\mid"?(r.setAttribute("lspace","0.22em"),r.setAttribute("rspace","0.22em"),r.setAttribute("stretchy","false")):e.family==="rel"&&Gn(e.text)?r.setAttribute("stretchy","false"):Fn.includes(e.text)?r.setAttribute("mathsize","70%"):e.text===":"&&(r.attributes.lspace="0.2222em",r.attributes.rspace="0.2222em"),r}});const Et={mathbf:"bold",mathrm:"normal",textit:"italic",mathit:"italic",mathnormal:"italic",mathbb:"double-struck",mathcal:"script",mathfrak:"fraktur",mathscr:"script",mathsf:"sans-serif",mathtt:"monospace"},pr=function(e,t){if(t.fontFamily==="texttt")return"monospace";if(t.fontFamily==="textsc")return"normal";if(t.fontFamily==="textsf")return t.fontShape==="textit"&&t.fontWeight==="textbf"?"sans-serif-bold-italic":t.fontShape==="textit"?"sans-serif-italic":t.fontWeight==="textbf"?"sans-serif-bold":"sans-serif";if(t.fontShape==="textit"&&t.fontWeight==="textbf")return"bold-italic";if(t.fontShape==="textit")return"italic";if(t.fontWeight==="textbf")return"bold";const r=t.font;if(!r||r==="mathnormal")return null;const n=e.mode;switch(r){case"mathit":return"italic";case"mathrm":{const i=e.text.codePointAt(0);return 939<i&&i<975?"italic":"normal"}case"greekItalic":return"italic";case"up@greek":return"normal";case"boldsymbol":case"mathboldsymbol":return"bold-italic";case"mathbf":return"bold";case"mathbb":return"double-struck";case"mathfrak":return"fraktur";case"mathscr":case"mathcal":return"script";case"mathsf":return"sans-serif";case"mathtt":return"monospace"}let s=e.text;return P[n][s]&&P[n][s].replace&&(s=P[n][s].replace),Object.prototype.hasOwnProperty.call(Et,r)?Et[r]:null},zt=Object.freeze({B:8426,E:8427,F:8427,H:8387,I:8391,L:8390,M:8422,R:8393,e:8394,g:8355,o:8389}),Rn=Object.freeze({C:8426,H:8388,I:8392,R:8394,Z:8398}),jn=Object.freeze({C:8383,H:8389,N:8391,P:8393,Q:8393,R:8395,Z:8394}),fr=Object.freeze({"ϵ":119527,ϑ:119564,ϰ:119534,φ:119577,ϱ:119535,ϖ:119563}),Un=Object.freeze({"ϵ":119643,ϑ:119680,ϰ:119650,φ:119693,ϱ:119651,ϖ:119679}),Lt=Object.freeze({"ϵ":119701,ϑ:119738,ϰ:119708,φ:119751,ϱ:119709,ϖ:119737}),Vn=Object.freeze({"ϵ":119759,ϑ:119796,ϰ:119766,φ:119809,ϱ:119767,ϖ:119795}),Wn=Object.freeze({upperCaseLatin:{normal:e=>0,bold:e=>119743,italic:e=>119795,"bold-italic":e=>119847,script:e=>zt[e]||119899,"script-bold":e=>119951,fraktur:e=>Rn[e]||120003,"fraktur-bold":e=>120107,"double-struck":e=>jn[e]||120055,"sans-serif":e=>120159,"sans-serif-bold":e=>120211,"sans-serif-italic":e=>120263,"sans-serif-bold-italic":e=>120380,monospace:e=>120367},lowerCaseLatin:{normal:e=>0,bold:e=>119737,italic:e=>e==="h"?8358:119789,"bold-italic":e=>119841,script:e=>zt[e]||119893,"script-bold":e=>119945,fraktur:e=>119997,"fraktur-bold":e=>120101,"double-struck":e=>120049,"sans-serif":e=>120153,"sans-serif-bold":e=>120205,"sans-serif-italic":e=>120257,"sans-serif-bold-italic":e=>120309,monospace:e=>120361},upperCaseGreek:{normal:e=>0,bold:e=>119575,italic:e=>119633,"bold-italic":e=>119575,script:e=>0,"script-bold":e=>0,fraktur:e=>0,"fraktur-bold":e=>0,"double-struck":e=>0,"sans-serif":e=>119749,"sans-serif-bold":e=>119749,"sans-serif-italic":e=>0,"sans-serif-bold-italic":e=>119807,monospace:e=>0},lowerCaseGreek:{normal:e=>0,bold:e=>119569,italic:e=>119627,"bold-italic":e=>e==="ϕ"?119678:119685,script:e=>0,"script-bold":e=>0,fraktur:e=>0,"fraktur-bold":e=>0,"double-struck":e=>0,"sans-serif":e=>119743,"sans-serif-bold":e=>119743,"sans-serif-italic":e=>0,"sans-serif-bold-italic":e=>119801,monospace:e=>0},varGreek:{normal:e=>0,bold:e=>fr[e]||-51,italic:e=>0,"bold-italic":e=>Un[e]||58,script:e=>0,"script-bold":e=>0,fraktur:e=>0,"fraktur-bold":e=>0,"double-struck":e=>0,"sans-serif":e=>Lt[e]||116,"sans-serif-bold":e=>Lt[e]||116,"sans-serif-italic":e=>0,"sans-serif-bold-italic":e=>Vn[e]||174,monospace:e=>0},numeral:{normal:e=>0,bold:e=>120734,italic:e=>0,"bold-italic":e=>0,script:e=>0,"script-bold":e=>0,fraktur:e=>0,"fraktur-bold":e=>0,"double-struck":e=>120744,"sans-serif":e=>120754,"sans-serif-bold":e=>120764,"sans-serif-italic":e=>0,"sans-serif-bold-italic":e=>0,monospace:e=>120774}}),xe=(e,t)=>{const r=e.codePointAt(0),n=64<r&&r<91?"upperCaseLatin":96<r&&r<123?"lowerCaseLatin":912<r&&r<938?"upperCaseGreek":944<r&&r<970||e==="ϕ"?"lowerCaseGreek":120545<r&&r<120572||fr[e]?"varGreek":47<r&&r<58?"numeral":"other";return n==="other"?e:String.fromCodePoint(r+Wn[n][t](e))},Hn=Object.freeze({a:"ᴀ",b:"ʙ",c:"ᴄ",d:"ᴅ",e:"ᴇ",f:"ꜰ",g:"ɢ",h:"ʜ",i:"ɪ",j:"ᴊ",k:"ᴋ",l:"ʟ",m:"ᴍ",n:"ɴ",o:"ᴏ",p:"ᴘ",q:"ǫ",r:"ʀ",s:"s",t:"ᴛ",u:"ᴜ",v:"ᴠ",w:"ᴡ",x:"x",y:"ʏ",z:"ᴢ"}),Zn=/^\d(?:[\d,.]*\d)?$/,Xn=/[A-Ba-z]/,Yn=new Set(["\\prime","\\dprime","\\trprime","\\qprime","\\backprime","\\backdprime","\\backtrprime"]),Kn=(e,t,r)=>{const n=new p.MathNode(r,[e]),s=new p.MathNode("mstyle",[n]);return s.style["font-style"]="italic",s.style["font-family"]="Cambria, 'Times New Roman', serif",t==="bold-italic"&&(s.style["font-weight"]="bold"),s};ce({type:"mathord",mathmlBuilder(e,t){const r=X(e.text,e.mode,t),n=r.text.codePointAt(0),s=912<n&&n<938?"normal":"italic",i=pr(e,t)||s;if(i==="script")return r.text=xe(r.text,i),new p.MathNode("mi",[r],[t.font]);i!=="italic"&&(r.text=xe(r.text,i));let u=new p.MathNode("mi",[r]);return i==="normal"&&(u.setAttribute("mathvariant","normal"),r.text.length===1&&(u=new p.MathNode("mrow",[u]))),u}});ce({type:"textord",mathmlBuilder(e,t){let r=e.text;const n=r.codePointAt(0);t.fontFamily==="textsc"&&96<n&&n<123&&(r=Hn[r]);const s=X(r,e.mode,t),i=pr(e,t)||"normal";let u;if(Zn.test(e.text)){const c=e.mode==="text"?"mtext":"mn";if(i==="italic"||i==="bold-italic")return Kn(s,i,c);i!=="normal"&&(s.text=s.text.split("").map(h=>xe(h,i)).join("")),u=new p.MathNode(c,[s])}else if(e.mode==="text")i!=="normal"&&(s.text=xe(s.text,i)),u=new p.MathNode("mtext",[s]);else if(Yn.has(e.text))u=new p.MathNode("mo",[s]),u.classes.push("tml-prime");else{const c=s.text;i!=="italic"&&(s.text=xe(s.text,i)),u=new p.MathNode("mi",[s]),s.text===c&&Xn.test(c)&&u.setAttribute("mathvariant","italic")}return u}});const Jn={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},Qn={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};ce({type:"spacing",mathmlBuilder(e,t){let r;if(Object.prototype.hasOwnProperty.call(Qn,e.text))r=new p.MathNode("mtext",[new p.TextNode(" ")]);else if(Object.prototype.hasOwnProperty.call(Jn,e.text))r=new p.MathNode("mo"),e.text==="\\nobreak"&&r.setAttribute("linebreak","nobreak");else throw new x(`Unknown type of space "${e.text}"`);return r}});ce({type:"tag"});const It={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm","\\textsc":"textsc"},Ft={"\\textbf":"textbf","\\textmd":"textmd"},eo={"\\textit":"textit","\\textup":"textup"},to=(e,t)=>{const r=e.font;return r?It[r]?t.withTextFontFamily(It[r]):Ft[r]?t.withTextFontWeight(Ft[r]):t.withTextFontShape(eo[r]):t};k({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textsc","\\textbf","\\textmd","\\textit","\\textup"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler({parser:e,funcName:t},r){const n=r[0];return{type:"text",mode:e.mode,body:L(n),font:t}},mathmlBuilder(e,t){const r=to(e,t),n=ae(e.body,r);return et(n)}});k({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(e,t,r){throw new x("\\verb ended by end of line instead of matching delimiter")},mathmlBuilder(e,t){const r=new p.TextNode(ro(e)),n=new p.MathNode("mtext",[r]);return n.setAttribute("mathvariant","monospace"),n}});const ro=e=>e.body.replace(/ /g,e.star?"␣":" "),le=Xt;class Z{constructor(t,r,n){this.lexer=t,this.start=r,this.end=n}static range(t,r){return r?!t||!t.loc||!r.loc||t.loc.lexer!==r.loc.lexer?null:new Z(t.loc.lexer,t.loc.start,r.loc.end):t&&t.loc}}class te{constructor(t,r){this.text=t,this.loc=r}range(t,r){return new te(r,Z.range(this,t))}}const gr=`[ \r
	]`,no="\\\\[a-zA-Z@]+",oo="\\\\[^\uD800-\uDFFF]",so=`(${no})${gr}*`,ao=`\\\\(
|[ \r	]+
?)[ \r	]*`,Ye="[̀-ͯ]",io=new RegExp(`${Ye}+$`),uo=`(${gr}+)|${ao}|([!-\\[\\]-‧‪-퟿豈-￿]${Ye}*|[\uD800-\uDBFF][\uDC00-\uDFFF]${Ye}*|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5|${so}|${oo})`;class Pt{constructor(t,r){this.input=t,this.settings=r,this.tokenRegex=new RegExp(uo,"g"),this.catcodes={"%":14,"~":13}}setCatcode(t,r){this.catcodes[t]=r}lex(){const t=this.input,r=this.tokenRegex.lastIndex;if(r===t.length)return new te("EOF",new Z(this,r,r));const n=this.tokenRegex.exec(t);if(n===null||n.index!==r)throw new x(`Unexpected character: '${t[r]}'`,new te(t[r],new Z(this,r,r+1)));const s=n[6]||n[3]||(n[2]?"\\ ":" ");if(this.catcodes[s]===14){const i=t.indexOf(`
`,this.tokenRegex.lastIndex);if(i===-1){if(this.tokenRegex.lastIndex=t.length,this.settings.strict)throw new x("% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode")}else this.tokenRegex.lastIndex=i+1;return this.lex()}return new te(s,new Z(this,r,this.tokenRegex.lastIndex))}}class lo{constructor(t={},r={}){this.current=r,this.builtins=t,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new x("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");const t=this.undefStack.pop();for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]===void 0?delete this.current[r]:this.current[r]=t[r])}has(t){return Object.prototype.hasOwnProperty.call(this.current,t)||Object.prototype.hasOwnProperty.call(this.builtins,t)}get(t){return Object.prototype.hasOwnProperty.call(this.current,t)?this.current[t]:this.builtins[t]}set(t,r,n=!1){if(n){for(let s=0;s<this.undefStack.length;s++)delete this.undefStack[s][t];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][t]=r)}else{const s=this.undefStack[this.undefStack.length-1];s&&!Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=this.current[t])}this.current[t]=r}}const co=mr;l("\\noexpand",function(e){const t=e.popToken();return e.isExpandable(t.text)&&(t.noexpand=!0,t.treatAsRelax=!0),{tokens:[t],numArgs:0}});l("\\expandafter",function(e){const t=e.popToken();return e.expandOnce(!0),{tokens:[t],numArgs:0}});l("\\@firstoftwo",function(e){return{tokens:e.consumeArgs(2)[0],numArgs:0}});l("\\@secondoftwo",function(e){return{tokens:e.consumeArgs(2)[1],numArgs:0}});l("\\@ifnextchar",function(e){const t=e.consumeArgs(3);e.consumeSpaces();const r=e.future();return t[0].length===1&&t[0][0].text===r.text?{tokens:t[1],numArgs:0}:{tokens:t[2],numArgs:0}});l("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");l("\\TextOrMath",function(e){const t=e.consumeArgs(2);return e.mode==="text"?{tokens:t[0],numArgs:0}:{tokens:t[1],numArgs:0}});const mo=e=>{let t="";for(let r=e.length-1;r>-1;r--)t+=e[r].text;return t},st={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15},Gt=e=>{const t=e.future().text;return t==="EOF"?[null,""]:[st[t.charAt(0)],t]},Rt=(e,t,r)=>{for(let n=1;n<t.length;n++){const s=st[t.charAt(n)];e*=r,e+=s}return e};l("\\char",function(e){let t=e.popToken(),r,n="";if(t.text==="'")r=8,t=e.popToken();else if(t.text==='"')r=16,t=e.popToken();else if(t.text==="`")if(t=e.popToken(),t.text[0]==="\\")n=t.text.charCodeAt(1);else{if(t.text==="EOF")throw new x("\\char` missing argument");n=t.text.charCodeAt(0)}else r=10;if(r){let s=t.text;if(n=st[s.charAt(0)],n==null||n>=r)throw new x(`Invalid base-${r} digit ${t.text}`);n=Rt(n,s,r);let i;for([i,s]=Gt(e);i!=null&&i<r;)n*=r,n+=i,n=Rt(n,s,r),e.popToken(),[i,s]=Gt(e)}return`\\@char{${n}}`});function at(e){const t=e.consumeArgs(1)[0];let r="",n=t[t.length-1].loc.start;for(let s=t.length-1;s>=0;s--){const i=t[s].loc.start;i>n&&(r+=" ",n=i),r+=t[s].text,n+=t[s].text.length}return r}l("\\surd","\\sqrt{\\vphantom{|}}");l("⊕","\\oplus");l("\\long","");l("\\bgroup","{");l("\\egroup","}");l("~","\\nobreakspace");l("\\lq","`");l("\\rq","'");l("\\aa","\\r a");l("\\Bbbk","\\Bbb{k}");l("\\mathstrut","\\vphantom{(}");l("\\underbar","\\underline{\\text{#1}}");l("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");l("⋮","\\vdots");l("\\substack","\\begin{subarray}{c}#1\\end{subarray}");l("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");l("\\implies","\\DOTSB\\;\\Longrightarrow\\;");l("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");const jt={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcap":"\\dotsb","\\bigsqcup":"\\dotsb","\\bigtimes":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};l("\\dots",function(e){let t="\\dotso";const r=e.expandAfterFuture().text;return r in jt?t=jt[r]:(r.slice(0,4)==="\\not"||r in P.math&&["bin","rel"].includes(P.math[r].group))&&(t="\\dotsb"),t});const it={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};l("\\dotso",function(e){return e.future().text in it?"\\ldots\\,":"\\ldots"});l("\\dotsc",function(e){const t=e.future().text;return t in it&&t!==","?"\\ldots\\,":"\\ldots"});l("\\cdots",function(e){return e.future().text in it?"\\@cdots\\,":"\\@cdots"});l("\\dotsb","\\cdots");l("\\dotsm","\\cdots");l("\\dotsi","\\!\\cdots");l("\\idotsint","\\dotsi");l("\\dotsx","\\ldots\\,");l("\\DOTSI","\\relax");l("\\DOTSB","\\relax");l("\\DOTSX","\\relax");l("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");l("\\,","{\\tmspace+{3mu}{.1667em}}");l("\\thinspace","\\,");l("\\>","\\mskip{4mu}");l("\\:","{\\tmspace+{4mu}{.2222em}}");l("\\medspace","\\:");l("\\;","{\\tmspace+{5mu}{.2777em}}");l("\\thickspace","\\;");l("\\!","{\\tmspace-{3mu}{.1667em}}");l("\\negthinspace","\\!");l("\\negmedspace","{\\tmspace-{4mu}{.2222em}}");l("\\negthickspace","{\\tmspace-{5mu}{.277em}}");l("\\enspace","\\kern.5em ");l("\\enskip","\\hskip.5em\\relax");l("\\quad","\\hskip1em\\relax");l("\\qquad","\\hskip2em\\relax");l("\\AA","\\TextOrMath{\\Angstrom}{\\mathring{A}}\\relax");l("\\tag","\\@ifstar\\tag@literal\\tag@paren");l("\\tag@paren","\\tag@literal{({#1})}");l("\\tag@literal",e=>{if(e.macros.get("\\df@tag"))throw new x("Multiple \\tag");return"\\def\\df@tag{\\text{#1}}"});l("\\bmod","\\mathbin{\\text{mod}}");l("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");l("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");l("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");l("\\newline","\\\\\\relax");l("\\TeX","\\textrm{T}\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125em\\textrm{X}");l("\\LaTeX","\\textrm{L}\\kern-.35em\\raisebox{0.2em}{\\scriptstyle A}\\kern-.15em\\TeX");l("\\Temml","\\textrm{T}\\kern-0.2em\\lower{0.2em}{\\textrm{E}}\\kern-0.08em{\\textrm{M}\\kern-0.08em\\raise{0.2em}\\textrm{M}\\kern-0.08em\\textrm{L}}");l("\\hspace","\\@ifstar\\@hspacer\\@hspace");l("\\@hspace","\\hskip #1\\relax");l("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");l("\\colon",'\\mathpunct{\\char"3a}');l("\\prescript","\\pres@cript{_{#1}^{#2}}{}{#3}");l("\\ordinarycolon",'\\char"3a');l("\\vcentcolon","\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}}");l("\\coloneq",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"2212}');l("\\Coloneq",'\\mathrel{\\char"2237\\char"2212}');l("\\Eqqcolon",'\\mathrel{\\char"3d\\char"2237}');l("\\Eqcolon",'\\mathrel{\\char"2212\\char"2237}');l("\\colonapprox",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"2248}');l("\\Colonapprox",'\\mathrel{\\char"2237\\char"2248}');l("\\colonsim",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"223c}');l("\\Colonsim",'\\mathrel{\\raisebox{0.035em}{\\ordinarycolon}\\char"223c}');l("\\ratio","\\vcentcolon");l("\\coloncolon","\\dblcolon");l("\\colonequals","\\coloneqq");l("\\coloncolonequals","\\Coloneqq");l("\\equalscolon","\\eqqcolon");l("\\equalscoloncolon","\\Eqqcolon");l("\\colonminus","\\coloneq");l("\\coloncolonminus","\\Coloneq");l("\\minuscolon","\\eqcolon");l("\\minuscoloncolon","\\Eqcolon");l("\\coloncolonapprox","\\Colonapprox");l("\\coloncolonsim","\\Colonsim");l("\\notni","\\mathrel{\\char`∌}");l("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");l("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");l("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");l("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");l("\\varlimsup","\\DOTSB\\operatorname*{\\overline{\\text{lim}}}");l("\\varliminf","\\DOTSB\\operatorname*{\\underline{\\text{lim}}}");l("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{\\text{lim}}}");l("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{\\text{lim}}}");l("\\centerdot","{\\medspace\\rule{0.167em}{0.189em}\\medspace}");l("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");l("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");l("\\plim","\\DOTSB\\operatorname*{plim}");l("\\leftmodels","\\mathop{\\reflectbox{$\\models$}}");l("\\bra","\\mathinner{\\langle{#1}|}");l("\\ket","\\mathinner{|{#1}\\rangle}");l("\\braket","\\mathinner{\\langle{#1}\\rangle}");l("\\Bra","\\left\\langle#1\\right|");l("\\Ket","\\left|#1\\right\\rangle");const br=(e,t)=>{const n=`}\\,\\middle${t[0]==="|"?"\\vert":"\\Vert"}\\,{`;return e.slice(0,t.index)+n+e.slice(t.index+t[0].length)};l("\\Braket",function(e){let t=at(e);const r=/\|\||\||\\\|/g;let n;for(;(n=r.exec(t))!==null;)t=br(t,n);return"\\left\\langle{"+t+"}\\right\\rangle"});l("\\Set",function(e){let t=at(e);const r=/\|\||\||\\\|/.exec(t);return r&&(t=br(t,r)),"\\left\\{\\:{"+t+"}\\:\\right\\}"});l("\\set",function(e){return"\\{{"+at(e).replace(/\|/,"}\\mid{")+"}\\}"});l("\\angln","{\\angl n}");l("\\odv","\\@ifstar\\odv@next\\odv@numerator");l("\\odv@numerator","\\frac{\\mathrm{d}#1}{\\mathrm{d}#2}");l("\\odv@next","\\frac{\\mathrm{d}}{\\mathrm{d}#2}#1");l("\\pdv","\\@ifstar\\pdv@next\\pdv@numerator");const xr=e=>{const t=e[0][0].text,r=mo(e[1]).split(","),n=String(r.length),s=n==="1"?"\\partial":`\\partial^${n}`;let i="";return r.map(u=>{i+="\\partial "+u.trim()+"\\,"}),[t,s,i.replace(/\\,$/,"")]};l("\\pdv@numerator",function(e){const[t,r,n]=xr(e.consumeArgs(2));return`\\frac{${r} ${t}}{${n}}`});l("\\pdv@next",function(e){const[t,r,n]=xr(e.consumeArgs(2));return`\\frac{${r}}{${n}} ${t}`});l("\\upalpha","\\up@greek{\\alpha}");l("\\upbeta","\\up@greek{\\beta}");l("\\upgamma","\\up@greek{\\gamma}");l("\\updelta","\\up@greek{\\delta}");l("\\upepsilon","\\up@greek{\\epsilon}");l("\\upzeta","\\up@greek{\\zeta}");l("\\upeta","\\up@greek{\\eta}");l("\\uptheta","\\up@greek{\\theta}");l("\\upiota","\\up@greek{\\iota}");l("\\upkappa","\\up@greek{\\kappa}");l("\\uplambda","\\up@greek{\\lambda}");l("\\upmu","\\up@greek{\\mu}");l("\\upnu","\\up@greek{\\nu}");l("\\upxi","\\up@greek{\\xi}");l("\\upomicron","\\up@greek{\\omicron}");l("\\uppi","\\up@greek{\\pi}");l("\\upalpha","\\up@greek{\\alpha}");l("\\uprho","\\up@greek{\\rho}");l("\\upsigma","\\up@greek{\\sigma}");l("\\uptau","\\up@greek{\\tau}");l("\\upupsilon","\\up@greek{\\upsilon}");l("\\upphi","\\up@greek{\\phi}");l("\\upchi","\\up@greek{\\chi}");l("\\uppsi","\\up@greek{\\psi}");l("\\upomega","\\up@greek{\\omega}");l("\\invamp",'\\mathbin{\\char"214b}');l("\\parr",'\\mathbin{\\char"214b}');l("\\with",'\\mathbin{\\char"26}');l("\\multimapinv",'\\mathrel{\\char"27dc}');l("\\multimapboth",'\\mathrel{\\char"29df}');l("\\scoh",'{\\mkern5mu\\char"2322\\mkern5mu}');l("\\sincoh",'{\\mkern5mu\\char"2323\\mkern5mu}');l("\\coh",`{\\mkern5mu\\rule{}{0.7em}\\mathrlap{\\smash{\\raise2mu{\\char"2322}}}
{\\smash{\\lower4mu{\\char"2323}}}\\mkern5mu}`);l("\\incoh",`{\\mkern5mu\\rule{}{0.7em}\\mathrlap{\\smash{\\raise2mu{\\char"2323}}}
{\\smash{\\lower4mu{\\char"2322}}}\\mkern5mu}`);l("\\standardstate","\\text{\\tiny\\char`⦵}");l("\\ce",function(e){return yr(e.consumeArgs(1)[0],"ce")});l("\\pu",function(e){return yr(e.consumeArgs(1)[0],"pu")});l("\\uniDash","{\\rule{0.672em}{0.06em}}");l("\\triDash","{\\rule{0.15em}{0.06em}\\kern2mu\\rule{0.15em}{0.06em}\\kern2mu\\rule{0.15em}{0.06em}}");l("\\tripleDash","\\kern0.075em\\raise0.25em{\\triDash}\\kern0.075em");l("\\tripleDashOverLine","\\kern0.075em\\mathrlap{\\raise0.125em{\\uniDash}}\\raise0.34em{\\triDash}\\kern0.075em");l("\\tripleDashOverDoubleLine","\\kern0.075em\\mathrlap{\\mathrlap{\\raise0.48em{\\triDash}}\\raise0.27em{\\uniDash}}{\\raise0.05em{\\uniDash}}\\kern0.075em");l("\\tripleDashBetweenDoubleLine","\\kern0.075em\\mathrlap{\\mathrlap{\\raise0.48em{\\uniDash}}\\raise0.27em{\\triDash}}{\\raise0.05em{\\uniDash}}\\kern0.075em");var yr=function(e,t){for(var r="",n=e.length&&e[e.length-1].loc.start,s=e.length-1;s>=0;s--)e[s].loc.start>n&&(r+=" ",n=e[s].loc.start),r+=e[s].text,n+=e[s].text.length;var i=M.go(b.go(r,t));return i},b={go:function(e,t){if(!e)return[];t===void 0&&(t="ce");var r="0",n={};n.parenthesisLevel=0,e=e.replace(/\n/g," "),e=e.replace(/[\u2212\u2013\u2014\u2010]/g,"-"),e=e.replace(/[\u2026]/g,"...");for(var s,i=10,u=[];;){s!==e?(i=10,s=e):i--;var c=b.stateMachines[t],h=c.transitions[r]||c.transitions["*"];e:for(var y=0;y<h.length;y++){var S=b.patterns.match_(h[y].pattern,e);if(S){for(var _=h[y].task,g=0;g<_.action_.length;g++){var v;if(c.actions[_.action_[g].type_])v=c.actions[_.action_[g].type_](n,S.match_,_.action_[g].option);else if(b.actions[_.action_[g].type_])v=b.actions[_.action_[g].type_](n,S.match_,_.action_[g].option);else throw["MhchemBugA","mhchem bug A. Please report. ("+_.action_[g].type_+")"];b.concatArray(u,v)}if(r=_.nextState||r,e.length>0){if(_.revisit||(e=S.remainder),!_.toContinue)break e}else return u}}if(i<=0)throw["MhchemBugU","mhchem bug U. Please report."]}},concatArray:function(e,t){if(t)if(Array.isArray(t))for(var r=0;r<t.length;r++)e.push(t[r]);else e.push(t)},patterns:{patterns:{empty:/^$/,else:/^./,else2:/^./,space:/^\s/,"space A":/^\s(?=[A-Z\\$])/,space$:/^\s$/,"a-z":/^[a-z]/,x:/^x/,x$:/^x$/,i$:/^i$/,letters:/^(?:[a-zA-Z\u03B1-\u03C9\u0391-\u03A9?@]|(?:\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))))+/,"\\greek":/^\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))/,"one lowercase latin letter $":/^(?:([a-z])(?:$|[^a-zA-Z]))$/,"$one lowercase latin letter$ $":/^\$(?:([a-z])(?:$|[^a-zA-Z]))\$$/,"one lowercase greek letter $":/^(?:\$?[\u03B1-\u03C9]\$?|\$?\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega)\s*\$?)(?:\s+|\{\}|(?![a-zA-Z]))$/,digits:/^[0-9]+/,"-9.,9":/^[+\-]?(?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))/,"-9.,9 no missing 0":/^[+\-]?[0-9]+(?:[.,][0-9]+)?/,"(-)(9.,9)(e)(99)":function(e){var t=e.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))?(\((?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))\))?(?:([eE]|\s*(\*|x|\\times|\u00D7)\s*10\^)([+\-]?[0-9]+|\{[+\-]?[0-9]+\}))?/);return t&&t[0]?{match_:t.splice(1),remainder:e.substr(t[0].length)}:null},"(-)(9)^(-9)":function(e){var t=e.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+)?)\^([+\-]?[0-9]+|\{[+\-]?[0-9]+\})/);return t&&t[0]?{match_:t.splice(1),remainder:e.substr(t[0].length)}:null},"state of aggregation $":function(e){var t=b.patterns.findObserveGroups(e,"",/^\([a-z]{1,3}(?=[\),])/,")","");if(t&&t.remainder.match(/^($|[\s,;\)\]\}])/))return t;var r=e.match(/^(?:\((?:\\ca\s?)?\$[amothc]\$\))/);return r?{match_:r[0],remainder:e.substr(r[0].length)}:null},"_{(state of aggregation)}$":/^_\{(\([a-z]{1,3}\))\}/,"{[(":/^(?:\\\{|\[|\()/,")]}":/^(?:\)|\]|\\\})/,", ":/^[,;]\s*/,",":/^[,;]/,".":/^[.]/,". ":/^([.\u22C5\u00B7\u2022])\s*/,"...":/^\.\.\.(?=$|[^.])/,"* ":/^([*])\s*/,"^{(...)}":function(e){return b.patterns.findObserveGroups(e,"^{","","","}")},"^($...$)":function(e){return b.patterns.findObserveGroups(e,"^","$","$","")},"^a":/^\^([0-9]+|[^\\_])/,"^\\x{}{}":function(e){return b.patterns.findObserveGroups(e,"^",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"^\\x{}":function(e){return b.patterns.findObserveGroups(e,"^",/^\\[a-zA-Z]+\{/,"}","")},"^\\x":/^\^(\\[a-zA-Z]+)\s*/,"^(-1)":/^\^(-?\d+)/,"'":/^'/,"_{(...)}":function(e){return b.patterns.findObserveGroups(e,"_{","","","}")},"_($...$)":function(e){return b.patterns.findObserveGroups(e,"_","$","$","")},_9:/^_([+\-]?[0-9]+|[^\\])/,"_\\x{}{}":function(e){return b.patterns.findObserveGroups(e,"_",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"_\\x{}":function(e){return b.patterns.findObserveGroups(e,"_",/^\\[a-zA-Z]+\{/,"}","")},"_\\x":/^_(\\[a-zA-Z]+)\s*/,"^_":/^(?:\^(?=_)|\_(?=\^)|[\^_]$)/,"{}":/^\{\}/,"{...}":function(e){return b.patterns.findObserveGroups(e,"","{","}","")},"{(...)}":function(e){return b.patterns.findObserveGroups(e,"{","","","}")},"$...$":function(e){return b.patterns.findObserveGroups(e,"","$","$","")},"${(...)}$":function(e){return b.patterns.findObserveGroups(e,"${","","","}$")},"$(...)$":function(e){return b.patterns.findObserveGroups(e,"$","","","$")},"=<>":/^[=<>]/,"#":/^[#\u2261]/,"+":/^\+/,"-$":/^-(?=[\s_},;\]/]|$|\([a-z]+\))/,"-9":/^-(?=[0-9])/,"- orbital overlap":/^-(?=(?:[spd]|sp)(?:$|[\s,;\)\]\}]))/,"-":/^-/,"pm-operator":/^(?:\\pm|\$\\pm\$|\+-|\+\/-)/,operator:/^(?:\+|(?:[\-=<>]|<<|>>|\\approx|\$\\approx\$)(?=\s|$|-?[0-9]))/,arrowUpDown:/^(?:v|\(v\)|\^|\(\^\))(?=$|[\s,;\)\]\}])/,"\\bond{(...)}":function(e){return b.patterns.findObserveGroups(e,"\\bond{","","","}")},"->":/^(?:<->|<-->|->|<-|<=>>|<<=>|<=>|[\u2192\u27F6\u21CC])/,CMT:/^[CMT](?=\[)/,"[(...)]":function(e){return b.patterns.findObserveGroups(e,"[","","","]")},"1st-level escape":/^(&|\\\\|\\hline)\s*/,"\\,":/^(?:\\[,\ ;:])/,"\\x{}{}":function(e){return b.patterns.findObserveGroups(e,"",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"\\x{}":function(e){return b.patterns.findObserveGroups(e,"",/^\\[a-zA-Z]+\{/,"}","")},"\\ca":/^\\ca(?:\s+|(?![a-zA-Z]))/,"\\x":/^(?:\\[a-zA-Z]+\s*|\\[_&{}%])/,orbital:/^(?:[0-9]{1,2}[spdfgh]|[0-9]{0,2}sp)(?=$|[^a-zA-Z])/,others:/^[\/~|]/,"\\frac{(...)}":function(e){return b.patterns.findObserveGroups(e,"\\frac{","","","}","{","","","}")},"\\overset{(...)}":function(e){return b.patterns.findObserveGroups(e,"\\overset{","","","}","{","","","}")},"\\underset{(...)}":function(e){return b.patterns.findObserveGroups(e,"\\underset{","","","}","{","","","}")},"\\underbrace{(...)}":function(e){return b.patterns.findObserveGroups(e,"\\underbrace{","","","}_","{","","","}")},"\\color{(...)}0":function(e){return b.patterns.findObserveGroups(e,"\\color{","","","}")},"\\color{(...)}{(...)}1":function(e){return b.patterns.findObserveGroups(e,"\\color{","","","}","{","","","}")},"\\color(...){(...)}2":function(e){return b.patterns.findObserveGroups(e,"\\color","\\","",/^(?=\{)/,"{","","","}")},"\\ce{(...)}":function(e){return b.patterns.findObserveGroups(e,"\\ce{","","","}")},oxidation$:/^(?:[+-][IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"d-oxidation$":/^(?:[+-]?\s?[IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"roman numeral":/^[IVX]+/,"1/2$":/^[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+(?:\$[a-z]\$|[a-z])?$/,amount:function(e){var t;if(t=e.match(/^(?:(?:(?:\([+\-]?[0-9]+\/[0-9]+\)|[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+|[+\-]?[0-9]+[.,][0-9]+|[+\-]?\.[0-9]+|[+\-]?[0-9]+)(?:[a-z](?=\s*[A-Z]))?)|[+\-]?[a-z](?=\s*[A-Z])|\+(?!\s))/),t)return{match_:t[0],remainder:e.substr(t[0].length)};var r=b.patterns.findObserveGroups(e,"","$","$","");return r&&(t=r.match_.match(/^\$(?:\(?[+\-]?(?:[0-9]*[a-z]?[+\-])?[0-9]*[a-z](?:[+\-][0-9]*[a-z]?)?\)?|\+|-)\$$/),t)?{match_:t[0],remainder:e.substr(t[0].length)}:null},amount2:function(e){return this.amount(e)},"(KV letters),":/^(?:[A-Z][a-z]{0,2}|i)(?=,)/,formula$:function(e){if(e.match(/^\([a-z]+\)$/))return null;var t=e.match(/^(?:[a-z]|(?:[0-9\ \+\-\,\.\(\)]+[a-z])+[0-9\ \+\-\,\.\(\)]*|(?:[a-z][0-9\ \+\-\,\.\(\)]+)+[a-z]?)$/);return t?{match_:t[0],remainder:e.substr(t[0].length)}:null},uprightEntities:/^(?:pH|pOH|pC|pK|iPr|iBu)(?=$|[^a-zA-Z])/,"/":/^\s*(\/)\s*/,"//":/^\s*(\/\/)\s*/,"*":/^\s*[*.]\s*/},findObserveGroups:function(e,t,r,n,s,i,u,c,h,y){var S=function(E,R){if(typeof R=="string")return E.indexOf(R)!==0?null:R;var _e=E.match(R);return _e?_e[0]:null},_=function(E,R,_e){for(var pe=0;R<E.length;){var dt=E.charAt(R),mt=S(E.substr(R),_e);if(mt!==null&&pe===0)return{endMatchBegin:R,endMatchEnd:R+mt.length};if(dt==="{")pe++;else if(dt==="}"){if(pe===0)throw["ExtraCloseMissingOpen","Extra close brace or missing open brace"];pe--}R++}return pe>0,null},g=S(e,t);if(g===null||(e=e.substr(g.length),g=S(e,r),g===null))return null;var v=_(e,g.length,n||s);if(v===null)return null;var $=e.substring(0,n?v.endMatchEnd:v.endMatchBegin);if(i||u){var j=this.findObserveGroups(e.substr(v.endMatchEnd),i,u,c,h);if(j===null)return null;var J=[$,j.match_];return{match_:y?J.join(""):J,remainder:j.remainder}}else return{match_:$,remainder:e.substr(v.endMatchEnd)}},match_:function(e,t){var r=b.patterns.patterns[e];if(r===void 0)throw["MhchemBugP","mhchem bug P. Please report. ("+e+")"];if(typeof r=="function")return b.patterns.patterns[e](t);var n=t.match(r);if(n){var s;return n[2]?s=[n[1],n[2]]:n[1]?s=n[1]:s=n[0],{match_:s,remainder:t.substr(n[0].length)}}return null}},actions:{"a=":function(e,t){e.a=(e.a||"")+t},"b=":function(e,t){e.b=(e.b||"")+t},"p=":function(e,t){e.p=(e.p||"")+t},"o=":function(e,t){e.o=(e.o||"")+t},"q=":function(e,t){e.q=(e.q||"")+t},"d=":function(e,t){e.d=(e.d||"")+t},"rm=":function(e,t){e.rm=(e.rm||"")+t},"text=":function(e,t){e.text_=(e.text_||"")+t},insert:function(e,t,r){return{type_:r}},"insert+p1":function(e,t,r){return{type_:r,p1:t}},"insert+p1+p2":function(e,t,r){return{type_:r,p1:t[0],p2:t[1]}},copy:function(e,t){return t},rm:function(e,t){return{type_:"rm",p1:t||""}},text:function(e,t){return b.go(t,"text")},"{text}":function(e,t){var r=["{"];return b.concatArray(r,b.go(t,"text")),r.push("}"),r},"tex-math":function(e,t){return b.go(t,"tex-math")},"tex-math tight":function(e,t){return b.go(t,"tex-math tight")},bond:function(e,t,r){return{type_:"bond",kind_:r||t}},"color0-output":function(e,t){return{type_:"color0",color:t[0]}},ce:function(e,t){return b.go(t)},"1/2":function(e,t){var r=[];t.match(/^[+\-]/)&&(r.push(t.substr(0,1)),t=t.substr(1));var n=t.match(/^([0-9]+|\$[a-z]\$|[a-z])\/([0-9]+)(\$[a-z]\$|[a-z])?$/);return n[1]=n[1].replace(/\$/g,""),r.push({type_:"frac",p1:n[1],p2:n[2]}),n[3]&&(n[3]=n[3].replace(/\$/g,""),r.push({type_:"tex-math",p1:n[3]})),r},"9,9":function(e,t){return b.go(t,"9,9")}},createTransitions:function(e){var t,r,n,s,i={};for(t in e)for(r in e[t])for(n=r.split("|"),e[t][r].stateArray=n,s=0;s<n.length;s++)i[n[s]]=[];for(t in e)for(r in e[t])for(n=e[t][r].stateArray||[],s=0;s<n.length;s++){var u=e[t][r];if(u.action_){u.action_=[].concat(u.action_);for(var c=0;c<u.action_.length;c++)typeof u.action_[c]=="string"&&(u.action_[c]={type_:u.action_[c]})}else u.action_=[];for(var h=t.split("|"),y=0;y<h.length;y++)if(n[s]==="*")for(var S in i)i[S].push({pattern:h[y],task:u});else i[n[s]].push({pattern:h[y],task:u})}return i},stateMachines:{}};b.stateMachines={ce:{transitions:b.createTransitions({empty:{"*":{action_:"output"}},else:{"0|1|2":{action_:"beginsWithBond=false",revisit:!0,toContinue:!0}},oxidation$:{0:{action_:"oxidation-output"}},CMT:{r:{action_:"rdt=",nextState:"rt"},rd:{action_:"rqt=",nextState:"rdt"}},arrowUpDown:{"0|1|2|as":{action_:["sb=false","output","operator"],nextState:"1"}},uprightEntities:{"0|1|2":{action_:["o=","output"],nextState:"1"}},orbital:{"0|1|2|3":{action_:"o=",nextState:"o"}},"->":{"0|1|2|3":{action_:"r=",nextState:"r"},"a|as":{action_:["output","r="],nextState:"r"},"*":{action_:["output","r="],nextState:"r"}},"+":{o:{action_:"d= kv",nextState:"d"},"d|D":{action_:"d=",nextState:"d"},q:{action_:"d=",nextState:"qd"},"qd|qD":{action_:"d=",nextState:"qd"},dq:{action_:["output","d="],nextState:"d"},3:{action_:["sb=false","output","operator"],nextState:"0"}},amount:{"0|2":{action_:"a=",nextState:"a"}},"pm-operator":{"0|1|2|a|as":{action_:["sb=false","output",{type_:"operator",option:"\\pm"}],nextState:"0"}},operator:{"0|1|2|a|as":{action_:["sb=false","output","operator"],nextState:"0"}},"-$":{"o|q":{action_:["charge or bond","output"],nextState:"qd"},d:{action_:"d=",nextState:"d"},D:{action_:["output",{type_:"bond",option:"-"}],nextState:"3"},q:{action_:"d=",nextState:"qd"},qd:{action_:"d=",nextState:"qd"},"qD|dq":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},"-9":{"3|o":{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"3"}},"- orbital overlap":{o:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},d:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"}},"-":{"0|1|2":{action_:[{type_:"output",option:1},"beginsWithBond=true",{type_:"bond",option:"-"}],nextState:"3"},3:{action_:{type_:"bond",option:"-"}},a:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},as:{action_:[{type_:"output",option:2},{type_:"bond",option:"-"}],nextState:"3"},b:{action_:"b="},o:{action_:{type_:"- after o/d",option:!1},nextState:"2"},q:{action_:{type_:"- after o/d",option:!1},nextState:"2"},"d|qd|dq":{action_:{type_:"- after o/d",option:!0},nextState:"2"},"D|qD|p":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},amount2:{"1|3":{action_:"a=",nextState:"a"}},letters:{"0|1|2|3|a|as|b|p|bp|o":{action_:"o=",nextState:"o"},"q|dq":{action_:["output","o="],nextState:"o"},"d|D|qd|qD":{action_:"o after d",nextState:"o"}},digits:{o:{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},q:{action_:["output","o="],nextState:"o"},a:{action_:"o=",nextState:"o"}},"space A":{"b|p|bp":{}},space:{a:{nextState:"as"},0:{action_:"sb=false"},"1|2":{action_:"sb=true"},"r|rt|rd|rdt|rdq":{action_:"output",nextState:"0"},"*":{action_:["output","sb=true"],nextState:"1"}},"1st-level escape":{"1|2":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}]},"*":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}],nextState:"0"}},"[(...)]":{"r|rt":{action_:"rd=",nextState:"rd"},"rd|rdt":{action_:"rq=",nextState:"rdq"}},"...":{"o|d|D|dq|qd|qD":{action_:["output",{type_:"bond",option:"..."}],nextState:"3"},"*":{action_:[{type_:"output",option:1},{type_:"insert",option:"ellipsis"}],nextState:"1"}},". |* ":{"*":{action_:["output",{type_:"insert",option:"addition compound"}],nextState:"1"}},"state of aggregation $":{"*":{action_:["output","state of aggregation"],nextState:"1"}},"{[(":{"a|as|o":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"0|1|2|3":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"*":{action_:["output","o=","output","parenthesisLevel++"],nextState:"2"}},")]}":{"0|1|2|3|b|p|bp|o":{action_:["o=","parenthesisLevel--"],nextState:"o"},"a|as|d|D|q|qd|qD|dq":{action_:["output","o=","parenthesisLevel--"],nextState:"o"}},", ":{"*":{action_:["output","comma"],nextState:"0"}},"^_":{"*":{}},"^{(...)}|^($...$)":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"D"},q:{action_:"d=",nextState:"qD"},"d|D|qd|qD|dq":{action_:["output","d="],nextState:"D"}},"^a|^\\x{}{}|^\\x{}|^\\x|'":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"d"},q:{action_:"d=",nextState:"qd"},"d|qd|D|qD":{action_:"d="},dq:{action_:["output","d="],nextState:"d"}},"_{(state of aggregation)}$":{"d|D|q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"_{(...)}|_($...$)|_9|_\\x{}{}|_\\x{}|_\\x":{"0|1|2|as":{action_:"p=",nextState:"p"},b:{action_:"p=",nextState:"bp"},"3|o":{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},"q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"=<>":{"0|1|2|3|a|as|o|q|d|D|qd|qD|dq":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"#":{"0|1|2|3|a|as|o":{action_:[{type_:"output",option:2},{type_:"bond",option:"#"}],nextState:"3"}},"{}":{"*":{action_:{type_:"output",option:1},nextState:"1"}},"{...}":{"0|1|2|3|a|as|b|p|bp":{action_:"o=",nextState:"o"},"o|d|D|q|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"$...$":{a:{action_:"a="},"0|1|2|3|as|b|p|bp|o":{action_:"o=",nextState:"o"},"as|o":{action_:"o="},"q|d|D|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"\\bond{(...)}":{"*":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"\\frac{(...)}":{"*":{action_:[{type_:"output",option:1},"frac-output"],nextState:"3"}},"\\overset{(...)}":{"*":{action_:[{type_:"output",option:2},"overset-output"],nextState:"3"}},"\\underset{(...)}":{"*":{action_:[{type_:"output",option:2},"underset-output"],nextState:"3"}},"\\underbrace{(...)}":{"*":{action_:[{type_:"output",option:2},"underbrace-output"],nextState:"3"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:[{type_:"output",option:2},"color-output"],nextState:"3"}},"\\color{(...)}0":{"*":{action_:[{type_:"output",option:2},"color0-output"]}},"\\ce{(...)}":{"*":{action_:[{type_:"output",option:2},"ce"],nextState:"3"}},"\\,":{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"1"}},"\\x{}{}|\\x{}|\\x":{"0|1|2|3|a|as|b|p|bp|o|c0":{action_:["o=","output"],nextState:"3"},"*":{action_:["output","o=","output"],nextState:"3"}},others:{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"3"}},else2:{a:{action_:"a to o",nextState:"o",revisit:!0},as:{action_:["output","sb=true"],nextState:"1",revisit:!0},"r|rt|rd|rdt|rdq":{action_:["output"],nextState:"0",revisit:!0},"*":{action_:["output","copy"],nextState:"3"}}}),actions:{"o after d":function(e,t){var r;if((e.d||"").match(/^[0-9]+$/)){var n=e.d;e.d=void 0,r=this.output(e),e.b=n}else r=this.output(e);return b.actions["o="](e,t),r},"d= kv":function(e,t){e.d=t,e.dType="kv"},"charge or bond":function(e,t){if(e.beginsWithBond){var r=[];return b.concatArray(r,this.output(e)),b.concatArray(r,b.actions.bond(e,t,"-")),r}else e.d=t},"- after o/d":function(e,t,r){var n=b.patterns.match_("orbital",e.o||""),s=b.patterns.match_("one lowercase greek letter $",e.o||""),i=b.patterns.match_("one lowercase latin letter $",e.o||""),u=b.patterns.match_("$one lowercase latin letter$ $",e.o||""),c=t==="-"&&(n&&n.remainder===""||s||i||u);c&&!e.a&&!e.b&&!e.p&&!e.d&&!e.q&&!n&&i&&(e.o="$"+e.o+"$");var h=[];return c?(b.concatArray(h,this.output(e)),h.push({type_:"hyphen"})):(n=b.patterns.match_("digits",e.d||""),r&&n&&n.remainder===""?(b.concatArray(h,b.actions["d="](e,t)),b.concatArray(h,this.output(e))):(b.concatArray(h,this.output(e)),b.concatArray(h,b.actions.bond(e,t,"-")))),h},"a to o":function(e){e.o=e.a,e.a=void 0},"sb=true":function(e){e.sb=!0},"sb=false":function(e){e.sb=!1},"beginsWithBond=true":function(e){e.beginsWithBond=!0},"beginsWithBond=false":function(e){e.beginsWithBond=!1},"parenthesisLevel++":function(e){e.parenthesisLevel++},"parenthesisLevel--":function(e){e.parenthesisLevel--},"state of aggregation":function(e,t){return{type_:"state of aggregation",p1:b.go(t,"o")}},comma:function(e,t){var r=t.replace(/\s*$/,""),n=r!==t;return n&&e.parenthesisLevel===0?{type_:"comma enumeration L",p1:r}:{type_:"comma enumeration M",p1:r}},output:function(e,t,r){var n;if(!e.r)n=[],!e.a&&!e.b&&!e.p&&!e.o&&!e.q&&!e.d&&!r||(e.sb&&n.push({type_:"entitySkip"}),!e.o&&!e.q&&!e.d&&!e.b&&!e.p&&r!==2?(e.o=e.a,e.a=void 0):!e.o&&!e.q&&!e.d&&(e.b||e.p)?(e.o=e.a,e.d=e.b,e.q=e.p,e.a=e.b=e.p=void 0):e.o&&e.dType==="kv"&&b.patterns.match_("d-oxidation$",e.d||"")?e.dType="oxidation":e.o&&e.dType==="kv"&&!e.q&&(e.dType=void 0),n.push({type_:"chemfive",a:b.go(e.a,"a"),b:b.go(e.b,"bd"),p:b.go(e.p,"pq"),o:b.go(e.o,"o"),q:b.go(e.q,"pq"),d:b.go(e.d,e.dType==="oxidation"?"oxidation":"bd"),dType:e.dType}));else{var s;e.rdt==="M"?s=b.go(e.rd,"tex-math"):e.rdt==="T"?s=[{type_:"text",p1:e.rd||""}]:s=b.go(e.rd);var i;e.rqt==="M"?i=b.go(e.rq,"tex-math"):e.rqt==="T"?i=[{type_:"text",p1:e.rq||""}]:i=b.go(e.rq),n={type_:"arrow",r:e.r,rd:s,rq:i}}for(var u in e)u!=="parenthesisLevel"&&u!=="beginsWithBond"&&delete e[u];return n},"oxidation-output":function(e,t){var r=["{"];return b.concatArray(r,b.go(t,"oxidation")),r.push("}"),r},"frac-output":function(e,t){return{type_:"frac-ce",p1:b.go(t[0]),p2:b.go(t[1])}},"overset-output":function(e,t){return{type_:"overset",p1:b.go(t[0]),p2:b.go(t[1])}},"underset-output":function(e,t){return{type_:"underset",p1:b.go(t[0]),p2:b.go(t[1])}},"underbrace-output":function(e,t){return{type_:"underbrace",p1:b.go(t[0]),p2:b.go(t[1])}},"color-output":function(e,t){return{type_:"color",color1:t[0],color2:b.go(t[1])}},"r=":function(e,t){e.r=t},"rdt=":function(e,t){e.rdt=t},"rd=":function(e,t){e.rd=t},"rqt=":function(e,t){e.rqt=t},"rq=":function(e,t){e.rq=t},operator:function(e,t,r){return{type_:"operator",kind_:r||t}}}},a:{transitions:b.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},"$(...)$":{"*":{action_:"tex-math tight",nextState:"1"}},",":{"*":{action_:{type_:"insert",option:"commaDecimal"}}},else2:{"*":{action_:"copy"}}}),actions:{}},o:{transitions:b.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},letters:{"*":{action_:"rm"}},"\\ca":{"*":{action_:{type_:"insert",option:"circa"}}},"\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"{text}"}},else2:{"*":{action_:"copy"}}}),actions:{}},text:{transitions:b.createTransitions({empty:{"*":{action_:"output"}},"{...}":{"*":{action_:"text="}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"\\greek":{"*":{action_:["output","rm"]}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:["output","copy"]}},else:{"*":{action_:"text="}}}),actions:{output:function(e){if(e.text_){var t={type_:"text",p1:e.text_};for(var r in e)delete e[r];return t}}}},pq:{transitions:b.createTransitions({empty:{"*":{}},"state of aggregation $":{"*":{action_:"state of aggregation"}},i$:{0:{nextState:"!f",revisit:!0}},"(KV letters),":{0:{action_:"rm",nextState:"0"}},formula$:{0:{nextState:"f",revisit:!0}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"!f",revisit:!0}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"a-z":{f:{action_:"tex-math"}},letters:{"*":{action_:"rm"}},"-9.,9":{"*":{action_:"9,9"}},",":{"*":{action_:{type_:"insert+p1",option:"comma enumeration S"}}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"state of aggregation":function(e,t){return{type_:"state of aggregation subscript",p1:b.go(t,"o")}},"color-output":function(e,t){return{type_:"color",color1:t[0],color2:b.go(t[1],"pq")}}}},bd:{transitions:b.createTransitions({empty:{"*":{}},x$:{0:{nextState:"!f",revisit:!0}},formula$:{0:{nextState:"f",revisit:!0}},else:{0:{nextState:"!f",revisit:!0}},"-9.,9 no missing 0":{"*":{action_:"9,9"}},".":{"*":{action_:{type_:"insert",option:"electron dot"}}},"a-z":{f:{action_:"tex-math"}},x:{"*":{action_:{type_:"insert",option:"KV x"}}},letters:{"*":{action_:"rm"}},"'":{"*":{action_:{type_:"insert",option:"prime"}}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"color-output":function(e,t){return{type_:"color",color1:t[0],color2:b.go(t[1],"bd")}}}},oxidation:{transitions:b.createTransitions({empty:{"*":{}},"roman numeral":{"*":{action_:"roman-numeral"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},else:{"*":{action_:"copy"}}}),actions:{"roman-numeral":function(e,t){return{type_:"roman numeral",p1:t||""}}}},"tex-math":{transitions:b.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},else:{"*":{action_:"o="}}}),actions:{output:function(e){if(e.o){var t={type_:"tex-math",p1:e.o};for(var r in e)delete e[r];return t}}}},"tex-math tight":{transitions:b.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},"-|+":{"*":{action_:"tight operator"}},else:{"*":{action_:"o="}}}),actions:{"tight operator":function(e,t){e.o=(e.o||"")+"{"+t+"}"},output:function(e){if(e.o){var t={type_:"tex-math",p1:e.o};for(var r in e)delete e[r];return t}}}},"9,9":{transitions:b.createTransitions({empty:{"*":{}},",":{"*":{action_:"comma"}},else:{"*":{action_:"copy"}}}),actions:{comma:function(){return{type_:"commaDecimal"}}}},pu:{transitions:b.createTransitions({empty:{"*":{action_:"output"}},space$:{"*":{action_:["output","space"]}},"{[(|)]}":{"0|a":{action_:"copy"}},"(-)(9)^(-9)":{0:{action_:"number^",nextState:"a"}},"(-)(9.,9)(e)(99)":{0:{action_:"enumber",nextState:"a"}},space:{"0|a":{}},"pm-operator":{"0|a":{action_:{type_:"operator",option:"\\pm"},nextState:"0"}},operator:{"0|a":{action_:"copy",nextState:"0"}},"//":{d:{action_:"o=",nextState:"/"}},"/":{d:{action_:"o=",nextState:"/"}},"{...}|else":{"0|d":{action_:"d=",nextState:"d"},a:{action_:["space","d="],nextState:"d"},"/|q":{action_:"q=",nextState:"q"}}}),actions:{enumber:function(e,t){var r=[];return t[0]==="+-"||t[0]==="+/-"?r.push("\\pm "):t[0]&&r.push(t[0]),t[1]&&(b.concatArray(r,b.go(t[1],"pu-9,9")),t[2]&&(t[2].match(/[,.]/)?b.concatArray(r,b.go(t[2],"pu-9,9")):r.push(t[2])),t[3]=t[4]||t[3],t[3]&&(t[3]=t[3].trim(),t[3]==="e"||t[3].substr(0,1)==="*"?r.push({type_:"cdot"}):r.push({type_:"times"}))),t[3]&&r.push("10^{"+t[5]+"}"),r},"number^":function(e,t){var r=[];return t[0]==="+-"||t[0]==="+/-"?r.push("\\pm "):t[0]&&r.push(t[0]),b.concatArray(r,b.go(t[1],"pu-9,9")),r.push("^{"+t[2]+"}"),r},operator:function(e,t,r){return{type_:"operator",kind_:r||t}},space:function(){return{type_:"pu-space-1"}},output:function(e){var t,r=b.patterns.match_("{(...)}",e.d||"");r&&r.remainder===""&&(e.d=r.match_);var n=b.patterns.match_("{(...)}",e.q||"");if(n&&n.remainder===""&&(e.q=n.match_),e.d&&(e.d=e.d.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),e.d=e.d.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F")),e.q){e.q=e.q.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),e.q=e.q.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F");var s={d:b.go(e.d,"pu"),q:b.go(e.q,"pu")};e.o==="//"?t={type_:"pu-frac",p1:s.d,p2:s.q}:(t=s.d,s.d.length>1||s.q.length>1?t.push({type_:" / "}):t.push({type_:"/"}),b.concatArray(t,s.q))}else t=b.go(e.d,"pu-2");for(var i in e)delete e[i];return t}}},"pu-2":{transitions:b.createTransitions({empty:{"*":{action_:"output"}},"*":{"*":{action_:["output","cdot"],nextState:"0"}},"\\x":{"*":{action_:"rm="}},space:{"*":{action_:["output","space"],nextState:"0"}},"^{(...)}|^(-1)":{1:{action_:"^(-1)"}},"-9.,9":{0:{action_:"rm=",nextState:"0"},1:{action_:"^(-1)",nextState:"0"}},"{...}|else":{"*":{action_:"rm=",nextState:"1"}}}),actions:{cdot:function(){return{type_:"tight cdot"}},"^(-1)":function(e,t){e.rm+="^{"+t+"}"},space:function(){return{type_:"pu-space-2"}},output:function(e){var t=[];if(e.rm){var r=b.patterns.match_("{(...)}",e.rm||"");r&&r.remainder===""?t=b.go(r.match_,"pu"):t={type_:"rm",p1:e.rm}}for(var n in e)delete e[n];return t}}},"pu-9,9":{transitions:b.createTransitions({empty:{0:{action_:"output-0"},o:{action_:"output-o"}},",":{0:{action_:["output-0","comma"],nextState:"o"}},".":{0:{action_:["output-0","copy"],nextState:"o"}},else:{"*":{action_:"text="}}}),actions:{comma:function(){return{type_:"commaDecimal"}},"output-0":function(e){var t=[];if(e.text_=e.text_||"",e.text_.length>4){var r=e.text_.length%3;r===0&&(r=3);for(var n=e.text_.length-3;n>0;n-=3)t.push(e.text_.substr(n,3)),t.push({type_:"1000 separator"});t.push(e.text_.substr(0,r)),t.reverse()}else t.push(e.text_);for(var s in e)delete e[s];return t},"output-o":function(e){var t=[];if(e.text_=e.text_||"",e.text_.length>4){for(var r=e.text_.length-3,n=0;n<r;n+=3)t.push(e.text_.substr(n,3)),t.push({type_:"1000 separator"});t.push(e.text_.substr(n))}else t.push(e.text_);for(var s in e)delete e[s];return t}}}};var M={go:function(e,t){if(!e)return"";for(var r="",n=!1,s=0;s<e.length;s++){var i=e[s];typeof i=="string"?r+=i:(r+=M._go2(i),i.type_==="1st-level escape"&&(n=!0))}return!t&&!n&&r&&(r="{"+r+"}"),r},_goInner:function(e){return e&&M.go(e,!0)},_go2:function(e){var t;switch(e.type_){case"chemfive":t="";var r={a:M._goInner(e.a),b:M._goInner(e.b),p:M._goInner(e.p),o:M._goInner(e.o),q:M._goInner(e.q),d:M._goInner(e.d)};r.a&&(r.a.match(/^[+\-]/)&&(r.a="{"+r.a+"}"),t+=r.a+"\\,"),(r.b||r.p)&&(t+="{\\vphantom{X}}",t+="^{\\hphantom{"+(r.b||"")+"}}_{\\hphantom{"+(r.p||"")+"}}",t+="{\\vphantom{X}}",t+="^{\\smash[t]{\\vphantom{2}}\\mathllap{"+(r.b||"")+"}}",t+="_{\\vphantom{2}\\mathllap{\\smash[t]{"+(r.p||"")+"}}}"),r.o&&(r.o.match(/^[+\-]/)&&(r.o="{"+r.o+"}"),t+=r.o),e.dType==="kv"?((r.d||r.q)&&(t+="{\\vphantom{X}}"),r.d&&(t+="^{"+r.d+"}"),r.q&&(t+="_{\\smash[t]{"+r.q+"}}")):e.dType==="oxidation"?(r.d&&(t+="{\\vphantom{X}}",t+="^{"+r.d+"}"),r.q&&(t+="{{}}",t+="_{\\smash[t]{"+r.q+"}}")):(r.q&&(t+="{{}}",t+="_{\\smash[t]{"+r.q+"}}"),r.d&&(t+="{{}}",t+="^{"+r.d+"}"));break;case"rm":t="\\mathrm{"+e.p1+"}";break;case"text":e.p1.match(/[\^_]/)?(e.p1=e.p1.replace(" ","~").replace("-","\\text{-}"),t="\\mathrm{"+e.p1+"}"):t="\\text{"+e.p1+"}";break;case"roman numeral":t="\\mathrm{"+e.p1+"}";break;case"state of aggregation":t="\\mskip2mu "+M._goInner(e.p1);break;case"state of aggregation subscript":t="\\mskip1mu "+M._goInner(e.p1);break;case"bond":if(t=M._getBond(e.kind_),!t)throw["MhchemErrorBond","mhchem Error. Unknown bond type ("+e.kind_+")"];break;case"frac":var n="\\frac{"+e.p1+"}{"+e.p2+"}";t="\\mathchoice{\\textstyle"+n+"}{"+n+"}{"+n+"}{"+n+"}";break;case"pu-frac":var s="\\frac{"+M._goInner(e.p1)+"}{"+M._goInner(e.p2)+"}";t="\\mathchoice{\\textstyle"+s+"}{"+s+"}{"+s+"}{"+s+"}";break;case"tex-math":t=e.p1+" ";break;case"frac-ce":t="\\frac{"+M._goInner(e.p1)+"}{"+M._goInner(e.p2)+"}";break;case"overset":t="\\overset{"+M._goInner(e.p1)+"}{"+M._goInner(e.p2)+"}";break;case"underset":t="\\underset{"+M._goInner(e.p1)+"}{"+M._goInner(e.p2)+"}";break;case"underbrace":t="\\underbrace{"+M._goInner(e.p1)+"}_{"+M._goInner(e.p2)+"}";break;case"color":t="{\\color{"+e.color1+"}{"+M._goInner(e.color2)+"}}";break;case"color0":t="\\color{"+e.color+"}";break;case"arrow":var i={rd:M._goInner(e.rd),rq:M._goInner(e.rq)},u=M._getArrow(e.r);i.rq&&(u+="[{\\rm "+i.rq+"}]"),i.rd?u+="{\\rm "+i.rd+"}":u+="{}",t=u;break;case"operator":t=M._getOperator(e.kind_);break;case"1st-level escape":t=e.p1+" ";break;case"space":t=" ";break;case"entitySkip":t="~";break;case"pu-space-1":t="~";break;case"pu-space-2":t="\\mkern3mu ";break;case"1000 separator":t="\\mkern2mu ";break;case"commaDecimal":t="{,}";break;case"comma enumeration L":t="{"+e.p1+"}\\mkern6mu ";break;case"comma enumeration M":t="{"+e.p1+"}\\mkern3mu ";break;case"comma enumeration S":t="{"+e.p1+"}\\mkern1mu ";break;case"hyphen":t="\\text{-}";break;case"addition compound":t="\\,{\\cdot}\\,";break;case"electron dot":t="\\mkern1mu \\text{\\textbullet}\\mkern1mu ";break;case"KV x":t="{\\times}";break;case"prime":t="\\prime ";break;case"cdot":t="\\cdot ";break;case"tight cdot":t="\\mkern1mu{\\cdot}\\mkern1mu ";break;case"times":t="\\times ";break;case"circa":t="{\\sim}";break;case"^":t="uparrow";break;case"v":t="downarrow";break;case"ellipsis":t="\\ldots ";break;case"/":t="/";break;case" / ":t="\\,/\\,";break;default:throw["MhchemBugT","mhchem bug T. Please report."]}return t},_getArrow:function(e){switch(e){case"->":return"\\yields";case"→":return"\\yields";case"⟶":return"\\yields";case"<-":return"\\yieldsLeft";case"<->":return"\\mesomerism";case"<-->":return"\\yieldsLeftRight";case"<=>":return"\\equilibrium";case"⇌":return"\\equilibrium";case"<=>>":return"\\equilibriumRight";case"<<=>":return"\\equilibriumLeft";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getBond:function(e){switch(e){case"-":return"{-}";case"1":return"{-}";case"=":return"{=}";case"2":return"{=}";case"#":return"{\\equiv}";case"3":return"{\\equiv}";case"~":return"{\\tripleDash}";case"~-":return"{\\tripleDashOverLine}";case"~=":return"{\\tripleDashOverDoubleLine}";case"~--":return"{\\tripleDashOverDoubleLine}";case"-~-":return"{\\tripleDashBetweenDoubleLine}";case"...":return"{{\\cdot}{\\cdot}{\\cdot}}";case"....":return"{{\\cdot}{\\cdot}{\\cdot}{\\cdot}}";case"->":return"{\\rightarrow}";case"<-":return"{\\leftarrow}";case"<":return"{<}";case">":return"{>}";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getOperator:function(e){switch(e){case"+":return" {}+{} ";case"-":return" {}-{} ";case"=":return" {}={} ";case"<":return" {}<{} ";case">":return" {}>{} ";case"<<":return" {}\\ll{} ";case">>":return" {}\\gg{} ";case"\\pm":return" {}\\pm{} ";case"\\approx":return" {}\\approx{} ";case"$\\approx$":return" {}\\approx{} ";case"v":return" \\downarrow{} ";case"(v)":return" \\downarrow{} ";case"^":return" \\uparrow{} ";case"(^)":return" \\uparrow{} ";default:throw["MhchemBugT","mhchem bug T. Please report."]}}};l("\\darr","\\downarrow");l("\\dArr","\\Downarrow");l("\\Darr","\\Downarrow");l("\\lang","\\langle");l("\\rang","\\rangle");l("\\uarr","\\uparrow");l("\\uArr","\\Uparrow");l("\\Uarr","\\Uparrow");l("\\N","\\mathbb{N}");l("\\R","\\mathbb{R}");l("\\Z","\\mathbb{Z}");l("\\alef","\\aleph");l("\\alefsym","\\aleph");l("\\bull","\\bullet");l("\\clubs","\\clubsuit");l("\\cnums","\\mathbb{C}");l("\\Complex","\\mathbb{C}");l("\\Dagger","\\ddagger");l("\\diamonds","\\diamondsuit");l("\\empty","\\emptyset");l("\\exist","\\exists");l("\\harr","\\leftrightarrow");l("\\hArr","\\Leftrightarrow");l("\\Harr","\\Leftrightarrow");l("\\hearts","\\heartsuit");l("\\image","\\Im");l("\\infin","\\infty");l("\\isin","\\in");l("\\larr","\\leftarrow");l("\\lArr","\\Leftarrow");l("\\Larr","\\Leftarrow");l("\\lrarr","\\leftrightarrow");l("\\lrArr","\\Leftrightarrow");l("\\Lrarr","\\Leftrightarrow");l("\\natnums","\\mathbb{N}");l("\\plusmn","\\pm");l("\\rarr","\\rightarrow");l("\\rArr","\\Rightarrow");l("\\Rarr","\\Rightarrow");l("\\real","\\Re");l("\\reals","\\mathbb{R}");l("\\Reals","\\mathbb{R}");l("\\sdot","\\cdot");l("\\sect","\\S");l("\\spades","\\spadesuit");l("\\sub","\\subset");l("\\sube","\\subseteq");l("\\supe","\\supseteq");l("\\thetasym","\\vartheta");l("\\weierp","\\wp");l("\\quantity","{\\left\\{ #1 \\right\\}}");l("\\qty","{\\left\\{ #1 \\right\\}}");l("\\pqty","{\\left( #1 \\right)}");l("\\bqty","{\\left[ #1 \\right]}");l("\\vqty","{\\left\\vert #1 \\right\\vert}");l("\\Bqty","{\\left\\{ #1 \\right\\}}");l("\\absolutevalue","{\\left\\vert #1 \\right\\vert}");l("\\abs","{\\left\\vert #1 \\right\\vert}");l("\\norm","{\\left\\Vert #1 \\right\\Vert}");l("\\evaluated","{\\left.#1 \\right\\vert}");l("\\eval","{\\left.#1 \\right\\vert}");l("\\order","{\\mathcal{O} \\left( #1 \\right)}");l("\\commutator","{\\left[ #1 , #2 \\right]}");l("\\comm","{\\left[ #1 , #2 \\right]}");l("\\anticommutator","{\\left\\{ #1 , #2 \\right\\}}");l("\\acomm","{\\left\\{ #1 , #2 \\right\\}}");l("\\poissonbracket","{\\left\\{ #1 , #2 \\right\\}}");l("\\pb","{\\left\\{ #1 , #2 \\right\\}}");l("\\vectorbold","{\\boldsymbol{ #1 }}");l("\\vb","{\\boldsymbol{ #1 }}");l("\\vectorarrow","{\\vec{\\boldsymbol{ #1 }}}");l("\\va","{\\vec{\\boldsymbol{ #1 }}}");l("\\vectorunit","{{\\boldsymbol{\\hat{ #1 }}}}");l("\\vu","{{\\boldsymbol{\\hat{ #1 }}}}");l("\\dotproduct","\\mathbin{\\boldsymbol\\cdot}");l("\\vdot","{\\boldsymbol\\cdot}");l("\\crossproduct","\\mathbin{\\boldsymbol\\times}");l("\\cross","\\mathbin{\\boldsymbol\\times}");l("\\cp","\\mathbin{\\boldsymbol\\times}");l("\\gradient","{\\boldsymbol\\nabla}");l("\\grad","{\\boldsymbol\\nabla}");l("\\divergence","{\\grad\\vdot}");l("\\curl","{\\grad\\cross}");l("\\laplacian","\\nabla^2");l("\\tr","{\\operatorname{tr}}");l("\\Tr","{\\operatorname{Tr}}");l("\\rank","{\\operatorname{rank}}");l("\\erf","{\\operatorname{erf}}");l("\\Res","{\\operatorname{Res}}");l("\\principalvalue","{\\mathcal{P}}");l("\\pv","{\\mathcal{P}}");l("\\PV","{\\operatorname{P.V.}}");l("\\qqtext","{\\quad\\text{ #1 }\\quad}");l("\\qq","{\\quad\\text{ #1 }\\quad}");l("\\qcomma","{\\text{,}\\quad}");l("\\qc","{\\text{,}\\quad}");l("\\qcc","{\\quad\\text{c.c.}\\quad}");l("\\qif","{\\quad\\text{if}\\quad}");l("\\qthen","{\\quad\\text{then}\\quad}");l("\\qelse","{\\quad\\text{else}\\quad}");l("\\qotherwise","{\\quad\\text{otherwise}\\quad}");l("\\qunless","{\\quad\\text{unless}\\quad}");l("\\qgiven","{\\quad\\text{given}\\quad}");l("\\qusing","{\\quad\\text{using}\\quad}");l("\\qassume","{\\quad\\text{assume}\\quad}");l("\\qsince","{\\quad\\text{since}\\quad}");l("\\qlet","{\\quad\\text{let}\\quad}");l("\\qfor","{\\quad\\text{for}\\quad}");l("\\qall","{\\quad\\text{all}\\quad}");l("\\qeven","{\\quad\\text{even}\\quad}");l("\\qodd","{\\quad\\text{odd}\\quad}");l("\\qinteger","{\\quad\\text{integer}\\quad}");l("\\qand","{\\quad\\text{and}\\quad}");l("\\qor","{\\quad\\text{or}\\quad}");l("\\qas","{\\quad\\text{as}\\quad}");l("\\qin","{\\quad\\text{in}\\quad}");l("\\differential","{\\text{d}}");l("\\dd","{\\text{d}}");l("\\derivative","{\\frac{\\text{d}{ #1 }}{\\text{d}{ #2 }}}");l("\\dv","{\\frac{\\text{d}{ #1 }}{\\text{d}{ #2 }}}");l("\\partialderivative","{\\frac{\\partial{ #1 }}{\\partial{ #2 }}}");l("\\variation","{\\delta}");l("\\var","{\\delta}");l("\\functionalderivative","{\\frac{\\delta{ #1 }}{\\delta{ #2 }}}");l("\\fdv","{\\frac{\\delta{ #1 }}{\\delta{ #2 }}}");l("\\innerproduct","{\\left\\langle {#1} \\mid { #2} \\right\\rangle}");l("\\outerproduct","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}");l("\\dyad","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}");l("\\ketbra","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}");l("\\op","{\\left\\vert { #1 } \\right\\rangle\\left\\langle { #2} \\right\\vert}");l("\\expectationvalue","{\\left\\langle {#1 } \\right\\rangle}");l("\\expval","{\\left\\langle {#1 } \\right\\rangle}");l("\\ev","{\\left\\langle {#1 } \\right\\rangle}");l("\\matrixelement","{\\left\\langle{ #1 }\\right\\vert{ #2 }\\left\\vert{#3}\\right\\rangle}");l("\\matrixel","{\\left\\langle{ #1 }\\right\\vert{ #2 }\\left\\vert{#3}\\right\\rangle}");l("\\mel","{\\left\\langle{ #1 }\\right\\vert{ #2 }\\left\\vert{#3}\\right\\rangle}");const wr={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class ho{constructor(t,r,n){this.settings=r,this.expansionCount=0,this.feed(t),this.macros=new lo(co,r.macros),this.mode=n,this.stack=[]}feed(t){this.lexer=new Pt(t,this.settings)}switchMode(t){this.mode=t}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(t){this.stack.push(t)}pushTokens(t){this.stack.push(...t)}scanArgument(t){let r,n,s;if(t){if(this.consumeSpaces(),this.future().text!=="[")return null;r=this.popToken(),{tokens:s,end:n}=this.consumeArg(["]"])}else({tokens:s,start:r,end:n}=this.consumeArg());return this.pushToken(new te("EOF",n.loc)),this.pushTokens(s),r.range(n,"")}consumeSpaces(){for(;this.future().text===" ";)this.stack.pop()}consumeArg(t){const r=[],n=t&&t.length>0;n||this.consumeSpaces();const s=this.future();let i,u=0,c=0;do{if(i=this.popToken(),r.push(i),i.text==="{")++u;else if(i.text==="}"){if(--u,u===-1)throw new x("Extra }",i)}else if(i.text==="EOF")throw new x("Unexpected end of input in a macro argument, expected '"+(t&&n?t[c]:"}")+"'",i);if(t&&n)if((u===0||u===1&&t[c]==="{")&&i.text===t[c]){if(++c,c===t.length){r.splice(-c,c);break}}else c=0}while(u!==0||n);return s.text==="{"&&r[r.length-1].text==="}"&&(r.pop(),r.shift()),r.reverse(),{tokens:r,start:s,end:i}}consumeArgs(t,r){if(r){if(r.length!==t+1)throw new x("The length of delimiters doesn't match the number of args!");const s=r[0];for(let i=0;i<s.length;i++){const u=this.popToken();if(s[i]!==u.text)throw new x("Use of the macro doesn't match its definition",u)}}const n=[];for(let s=0;s<t;s++)n.push(this.consumeArg(r&&r[s+1]).tokens);return n}expandOnce(t){const r=this.popToken(),n=r.text,s=r.noexpand?null:this._getExpansion(n);if(s==null||t&&s.unexpandable){if(t&&s==null&&n[0]==="\\"&&!this.isDefined(n))throw new x("Undefined control sequence: "+n);return this.pushToken(r),!1}if(this.expansionCount++,this.expansionCount>this.settings.maxExpand)throw new x("Too many expansions: infinite loop or need to increase maxExpand setting");let i=s.tokens;const u=this.consumeArgs(s.numArgs,s.delimiters);if(s.numArgs){i=i.slice();for(let c=i.length-1;c>=0;--c){let h=i[c];if(h.text==="#"){if(c===0)throw new x("Incomplete placeholder at end of macro body",h);if(h=i[--c],h.text==="#")i.splice(c+1,1);else if(/^[1-9]$/.test(h.text))i.splice(c,2,...u[+h.text-1]);else throw new x("Not a valid argument number",h)}}}return this.pushTokens(i),i.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){const t=this.stack.pop();return t.treatAsRelax&&(t.text="\\relax"),t}throw new Error}expandMacro(t){return this.macros.has(t)?this.expandTokens([new te(t)]):void 0}expandTokens(t){const r=[],n=this.stack.length;for(this.pushTokens(t);this.stack.length>n;)if(this.expandOnce(!0)===!1){const s=this.stack.pop();s.treatAsRelax&&(s.noexpand=!1,s.treatAsRelax=!1),r.push(s)}return r}expandMacroAsText(t){const r=this.expandMacro(t);return r&&r.map(n=>n.text).join("")}_getExpansion(t){const r=this.macros.get(t);if(r==null)return r;if(t.length===1){const s=this.lexer.catcodes[t];if(s!=null&&s!==13)return}const n=typeof r=="function"?r(this):r;if(typeof n=="string"){let s=0;if(n.indexOf("#")!==-1){const y=n.replace(/##/g,"");for(;y.indexOf("#"+(s+1))!==-1;)++s}const i=new Pt(n,this.settings),u=[];let c=i.lex();for(;c.text!=="EOF";)u.push(c),c=i.lex();return u.reverse(),{tokens:u,numArgs:s}}return n}isDefined(t){return this.macros.has(t)||Object.prototype.hasOwnProperty.call(le,t)||Object.prototype.hasOwnProperty.call(P.math,t)||Object.prototype.hasOwnProperty.call(P.text,t)||Object.prototype.hasOwnProperty.call(wr,t)}isExpandable(t){const r=this.macros.get(t);return r!=null?typeof r=="string"||typeof r=="function"||!r.unexpandable:Object.prototype.hasOwnProperty.call(le,t)&&!le[t].primitive}}const Ut=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,De=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g",ʰ:"h","ⁱ":"i",ʲ:"j","ᵏ":"k",ˡ:"l","ᵐ":"m",ⁿ:"n","ᵒ":"o","ᵖ":"p",ʳ:"r",ˢ:"s","ᵗ":"t","ᵘ":"u","ᵛ":"v",ʷ:"w",ˣ:"x",ʸ:"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),Vt=Object.freeze({"𝒜":"A",ℬ:"B","𝒞":"C","𝒟":"D",ℰ:"E",ℱ:"F","𝒢":"G",ℋ:"H",ℐ:"I","𝒥":"J","𝒦":"K",ℒ:"L",ℳ:"M","𝒩":"N","𝒪":"O","𝒫":"P","𝒬":"Q",ℛ:"R","𝒮":"S","𝒯":"T","𝒰":"U","𝒱":"V","𝒲":"W","𝒳":"X","𝒴":"Y","𝒵":"Z"});var Ve={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},Wt={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",č:"č",ĉ:"ĉ",ċ:"ċ",ď:"ď",ḋ:"ḋ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ĺ:"ĺ",ľ:"ľ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ď:"Ď",Ḋ:"Ḋ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ĺ:"Ĺ",Ľ:"Ľ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ť:"Ť",Ṫ:"Ṫ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"};const po=["bin","op","open","punct","rel"];class Pe{constructor(t,r,n=!1){this.mode="math",this.gullet=new ho(t,r,this.mode),this.settings=r,this.isPreamble=n,this.leftrightDepth=0,this.prevAtomType=""}expect(t,r=!0){if(this.fetch().text!==t)throw new x(`Expected '${t}', got '${this.fetch().text}'`,this.fetch());r&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(t){this.mode=t,this.gullet.switchMode(t)}parse(){this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");const t=this.parseExpression(!1);if(this.expect("EOF"),this.isPreamble){const n=Object.create(null);return Object.entries(this.gullet.macros.current).forEach(([s,i])=>{n[s]=i}),this.gullet.endGroup(),n}const r=this.gullet.macros.get("\\df@tag");return this.gullet.endGroup(),r&&(this.gullet.macros.current["\\df@tag"]=r),t}static get endOfExpression(){return["}","\\endgroup","\\end","\\right","\\endtoggle","&"]}subparse(t){const r=this.nextToken;this.consume(),this.gullet.pushToken(new te("}")),this.gullet.pushTokens(t);const n=this.parseExpression(!1);return this.expect("}"),this.nextToken=r,n}parseExpression(t,r,n){const s=[];for(;;){this.mode==="math"&&this.consumeSpaces();const i=this.fetch();if(Pe.endOfExpression.indexOf(i.text)!==-1||r&&i.text===r||n&&i.text==="\\middle"||t&&le[i.text]&&le[i.text].infix)break;const u=this.parseAtom(r);if(u){if(u.type==="internal")continue}else break;s.push(u),this.prevAtomType=u.type==="atom"?u.family:u.type}return this.mode==="text"&&this.formLigatures(s),this.handleInfixNodes(s)}handleInfixNodes(t){let r=-1,n;for(let s=0;s<t.length;s++)if(t[s].type==="infix"){if(r!==-1)throw new x("only one infix operator per group",t[s].token);r=s,n=t[s].replaceWith}if(r!==-1&&n){let s,i;const u=t.slice(0,r),c=t.slice(r+1);u.length===1&&u[0].type==="ordgroup"?s=u[0]:s={type:"ordgroup",mode:this.mode,body:u},c.length===1&&c[0].type==="ordgroup"?i=c[0]:i={type:"ordgroup",mode:this.mode,body:c};let h;return n==="\\\\abovefrac"?h=this.callFunction(n,[s,t[r],i],[]):h=this.callFunction(n,[s,i],[]),[h]}else return t}handleSupSubscript(t){const r=this.fetch(),n=r.text;this.consume(),this.consumeSpaces();const s=this.parseGroup(t);if(!s)throw new x("Expected group after '"+n+"'",r);return s}formatUnsupportedCmd(t){const r=[];for(let i=0;i<t.length;i++)r.push({type:"textord",mode:"text",text:t[i]});const n={type:"text",mode:this.mode,body:r};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[n]}}parseAtom(t){const r=this.parseGroup("atom",t);if(this.mode==="text")return r;let n,s;for(;;){this.consumeSpaces();const i=this.fetch();if(i.text==="\\limits"||i.text==="\\nolimits"){if(r&&r.type==="op"){const u=i.text==="\\limits";r.limits=u,r.alwaysHandleSupSub=!0}else if(r&&r.type==="operatorname")r.alwaysHandleSupSub&&(r.limits=i.text==="\\limits");else throw new x("Limit controls must follow a math operator",i);this.consume()}else if(i.text==="^"){if(n)throw new x("Double superscript",i);n=this.handleSupSubscript("superscript")}else if(i.text==="_"){if(s)throw new x("Double subscript",i);s=this.handleSupSubscript("subscript")}else if(i.text==="'"){if(n)throw new x("Double superscript",i);const u={type:"textord",mode:this.mode,text:"\\prime"},c=[u];for(this.consume();this.fetch().text==="'";)c.push(u),this.consume();this.fetch().text==="^"&&c.push(this.handleSupSubscript("superscript")),n={type:"ordgroup",mode:this.mode,body:c}}else if(De[i.text]){const u=Ut.test(i.text),c=[];for(c.push(new te(De[i.text])),this.consume();;){const y=this.fetch().text;if(!De[y]||Ut.test(y)!==u)break;c.unshift(new te(De[y])),this.consume()}const h=this.subparse(c);u?s={type:"ordgroup",mode:"math",body:h}:n={type:"ordgroup",mode:"math",body:h}}else break}if(n||s){if(r&&r.type==="multiscript"&&!r.postscripts)return r.postscripts={sup:n,sub:s},r;{const i=!r||r.type!=="op"&&r.type!=="operatorname"?void 0:Ie(this.nextToken.text);return{type:"supsub",mode:this.mode,base:r,sup:n,sub:s,isFollowedByDelimiter:i}}}else return r}parseFunction(t,r){const n=this.fetch(),s=n.text,i=le[s];if(!i)return null;if(this.consume(),r&&r!=="atom"&&!i.allowedInArgument)throw new x("Got function '"+s+"' with no arguments"+(r?" as "+r:""),n);if(this.mode==="text"&&!i.allowedInText)throw new x("Can't use function '"+s+"' in text mode",n);if(this.mode==="math"&&i.allowedInMath===!1)throw new x("Can't use function '"+s+"' in math mode",n);const u=this.prevAtomType,{args:c,optArgs:h}=this.parseArguments(s,i);return this.prevAtomType=u,this.callFunction(s,c,h,n,t)}callFunction(t,r,n,s,i){const u={funcName:t,parser:this,token:s,breakOnTokenText:i},c=le[t];if(c&&c.handler)return c.handler(u,r,n);throw new x(`No function handler for ${t}`)}parseArguments(t,r){const n=r.numArgs+r.numOptionalArgs;if(n===0)return{args:[],optArgs:[]};const s=[],i=[];for(let u=0;u<n;u++){let c=r.argTypes&&r.argTypes[u];const h=u<r.numOptionalArgs;(r.primitive&&c==null||r.type==="sqrt"&&u===1&&i[0]==null)&&(c="primitive");const y=this.parseGroupOfType(`argument to '${t}'`,c,h);if(h)i.push(y);else if(y!=null)s.push(y);else throw new x("Null argument, please report this as a bug")}return{args:s,optArgs:i}}parseGroupOfType(t,r,n){switch(r){case"size":return this.parseSizeGroup(n);case"url":return this.parseUrlGroup(n);case"math":case"text":return this.parseArgumentGroup(n,r);case"hbox":{const s=this.parseArgumentGroup(n,"text");return s!=null?{type:"styling",mode:s.mode,body:[s],scriptLevel:"text"}:null}case"raw":{const s=this.parseStringGroup("raw",n);return s!=null?{type:"raw",mode:"text",string:s.text}:null}case"primitive":{if(n)throw new x("A primitive argument cannot be optional");const s=this.parseGroup(t);if(s==null)throw new x("Expected group as "+t,this.fetch());return s}case"original":case null:case void 0:return this.parseArgumentGroup(n);default:throw new x("Unknown group type as "+t,this.fetch())}}consumeSpaces(){for(;;){const t=this.fetch().text;if(t===" "||t===" "||t==="︎")this.consume();else break}}parseStringGroup(t,r){const n=this.gullet.scanArgument(r);if(n==null)return null;let s="",i;for(;(i=this.fetch()).text!=="EOF";)s+=i.text,this.consume();return this.consume(),n.text=s,n}parseRegexGroup(t,r){const n=this.fetch();let s=n,i="",u;for(;(u=this.fetch()).text!=="EOF"&&t.test(i+u.text);)s=u,i+=s.text,this.consume();if(i==="")throw new x("Invalid "+r+": '"+n.text+"'",n);return n.range(s,i)}parseSizeGroup(t){let r,n=!1;if(this.gullet.consumeSpaces(),!t&&this.gullet.future().text!=="{"?r=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):r=this.parseStringGroup("size",t),!r)return null;!t&&r.text.length===0&&(r.text="0pt",n=!0);const s=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(r.text);if(!s)throw new x("Invalid size: '"+r.text+"'",r);const i={number:+(s[1]+s[2]),unit:s[3]};if(!er(i))throw new x("Invalid unit: '"+i.unit+"'",r);return{type:"size",mode:this.mode,value:i,isBlank:n}}parseUrlGroup(t){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);const r=this.parseStringGroup("url",t);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),r==null)return null;let n=r.text.replace(/\\([#$%&~_^{}])/g,"$1");return n=r.text.replace(/{\u2044}/g,"/"),{type:"url",mode:this.mode,url:n}}parseArgumentGroup(t,r){const n=this.gullet.scanArgument(t);if(n==null)return null;const s=this.mode;r&&this.switchMode(r),this.gullet.beginGroup();const i=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();const u={type:"ordgroup",mode:this.mode,loc:n.loc,body:i};return r&&this.switchMode(s),u}parseGroup(t,r){const n=this.fetch(),s=n.text;let i;if(s==="{"||s==="\\begingroup"||s==="\\toggle"){this.consume();const u=s==="{"?"}":s==="\\begingroup"?"\\endgroup":"\\endtoggle";this.gullet.beginGroup();const c=this.parseExpression(!1,u),h=this.fetch();this.expect(u),this.gullet.endGroup(),i={type:h.text==="\\endtoggle"?"toggle":"ordgroup",mode:this.mode,loc:Z.range(n,h),body:c,semisimple:s==="\\begingroup"||void 0}}else i=this.parseFunction(r,t)||this.parseSymbol(),i==null&&s[0]==="\\"&&!Object.prototype.hasOwnProperty.call(wr,s)&&(i=this.formatUnsupportedCmd(s),this.consume());return i}formLigatures(t){let r=t.length-1;for(let n=0;n<r;++n){const s=t[n],i=s.text;i==="-"&&t[n+1].text==="-"&&(n+1<r&&t[n+2].text==="-"?(t.splice(n,3,{type:"textord",mode:"text",loc:Z.range(s,t[n+2]),text:"---"}),r-=2):(t.splice(n,2,{type:"textord",mode:"text",loc:Z.range(s,t[n+1]),text:"--"}),r-=1)),(i==="'"||i==="`")&&t[n+1].text===i&&(t.splice(n,2,{type:"textord",mode:"text",loc:Z.range(s,t[n+1]),text:i+i}),r-=1)}}parseSymbol(){const t=this.fetch();let r=t.text;if(/^\\verb[^a-zA-Z]/.test(r)){this.consume();let i=r.slice(5);const u=i.charAt(0)==="*";if(u&&(i=i.slice(1)),i.length<2||i.charAt(0)!==i.slice(-1))throw new x(`\\verb assertion failed --
                    please report what input caused this bug`);return i=i.slice(1,-1),{type:"verb",mode:"text",body:i,star:u}}if(Object.prototype.hasOwnProperty.call(Wt,r[0])&&!P[this.mode][r[0]]){if(this.settings.strict&&this.mode==="math")throw new x(`Accented Unicode text character "${r[0]}" used in math mode`,t);r=Wt[r[0]]+r.slice(1)}const n=io.exec(r);n&&(r=r.substring(0,n.index),r==="i"?r="ı":r==="j"&&(r="ȷ"));let s;if(P[this.mode][r]){let i=P[this.mode][r].group;i==="bin"&&po.includes(this.prevAtomType)&&(i="open");const u=Z.range(t);let c;if(Object.prototype.hasOwnProperty.call(Hr,i)){const h=i;c={type:"atom",mode:this.mode,family:h,loc:u,text:r}}else{if(Vt[r]){this.consume();const h=this.fetch().text.charCodeAt(0),y=h===65025?"mathscr":"mathcal";return(h===65024||h===65025)&&this.consume(),{type:"font",mode:"math",font:y,body:{type:"mathord",mode:"math",loc:u,text:Vt[r]}}}c={type:i,mode:this.mode,loc:u,text:r}}s=c}else if(r.charCodeAt(0)>=128){if(this.settings.strict&&this.mode==="math")throw new x(`Unicode text character "${r[0]}" used in math mode`,t);s={type:"textord",mode:"text",loc:Z.range(t),text:r}}else return null;if(this.consume(),n)for(let i=0;i<n[0].length;i++){const u=n[0][i];if(!Ve[u])throw new x(`Unknown accent ' ${u}'`,t);const c=Ve[u][this.mode]||Ve[u].text;if(!c)throw new x(`Accent ${u} unsupported in ${this.mode} mode`,t);s={type:"accent",mode:this.mode,loc:Z.range(t),label:c,isStretchy:!1,base:s}}return s}}const vr=function(e,t){if(!(typeof e=="string"||e instanceof String))throw new TypeError("Temml can only parse string typed expression");const r=new Pe(e,t);delete r.gullet.macros.current["\\df@tag"];let n=r.parse();if(!(n.length>0&&n[0].type&&n[0].type==="array"&&n[0].addEqnNum)&&r.gullet.macros.get("\\df@tag")){if(!t.displayMode)throw new x("\\tag works only in display mode");r.gullet.feed("\\df@tag"),n=[{type:"tag",mode:"text",body:n,tag:r.parse()}]}return n},fo=[2,2,3,3];class ut{constructor(t){this.level=t.level,this.color=t.color,this.font=t.font||"",this.fontFamily=t.fontFamily||"",this.fontSize=t.fontSize||1,this.fontWeight=t.fontWeight||"",this.fontShape=t.fontShape||"",this.maxSize=t.maxSize}extend(t){const r={level:this.level,color:this.color,font:this.font,fontFamily:this.fontFamily,fontSize:this.fontSize,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return new ut(r)}withLevel(t){return this.extend({level:t})}incrementLevel(){return this.extend({level:Math.min(this.level+1,3)})}inSubOrSup(){return this.extend({level:fo[this.level]})}withColor(t){return this.extend({color:t})}withFont(t){return this.extend({font:t})}withTextFontFamily(t){return this.extend({fontFamily:t,font:""})}withFontSize(t){return this.extend({fontSize:t})}withTextFontWeight(t){return this.extend({fontWeight:t,font:""})}withTextFontShape(t){return this.extend({fontShape:t,font:""})}getColor(){return this.color}}const go="0.10.22";function bo(e){const t={};let r=0;const n=e.getElementsByClassName("tml-tageqn");for(const i of n){const u=i.getElementsByClassName("tml-eqn");u.length>0&&(r+=1,u[0].id="tml-eqn-"+r);const c=i.getElementsByClassName("tml-label");if(c.length!==0)if(u.length>0)t[c[0].id]=String(r);else{const h=i.getElementsByClassName("tml-tag");h.length>0&&(t[c[0].id]=h[0].textContent)}}[...e.getElementsByClassName("tml-ref")].forEach(i=>{let u=t[i.getAttribute("href").slice(1)];i.className.indexOf("tml-eqref")===-1&&(u=u.replace(/^\(/,""),u=u.replace(/\($/,"")),u.charAt(0)!=="("&&(u="("+u),u.slice(-1)!==")"&&(u=u+")"),i.textContent=u})}let kr=function(e,t,r={}){t.textContent="";const n=t.tagName.toLowerCase()==="math";n&&(r.wrap="none");const s=lt(e,r);n?(t.textContent="",s.children.forEach(i=>{t.appendChild(i.toNode())})):s.children.length>1?(t.textContent="",s.children.forEach(i=>{t.appendChild(i.toNode())})):t.appendChild(s.toNode())};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: Temml doesn't work in quirks mode. Make sure your website has a suitable doctype."),kr=function(){throw new x("Temml doesn't work in quirks mode.")});const xo=function(e,t){return lt(e,t).toMarkup()},yo=function(e,t){const r=new Ke(t);return vr(e,r)},wo=function(e,t){const r=new Ke(t);if(r.macros={},!(typeof e=="string"||e instanceof String))throw new TypeError("Temml can only parse string typed expression");const n=new Pe(e,r,!0);return delete n.gullet.macros.current["\\df@tag"],n.parse()},vo=function(e,t,r){if(r.throwOnError||!(e instanceof x))throw e;const n=new Yt(["temml-error"],[new Gr(t+`
`+e.toString())]);return n.style.color=r.errorColor,n.style.whiteSpace="pre-line",n},lt=function(e,t){const r=new Ke(t);try{const n=vr(e,r),s=new ut({level:r.displayMode?F.DISPLAY:F.TEXT,maxSize:r.maxSize});return rn(n,e,s,r)}catch(n){return vo(n,e,r)}};var Ar={version:go,render:kr,renderToString:xo,postProcess:bo,ParseError:x,definePreamble:wo,__parse:yo,__renderToMathMLTree:lt,__defineSymbol:o,__defineMacro:l};const Ge=[re(2,5),re(2,-5),re(-2,5),re(-2,-5),re(2,["()",-5]),re(["()",-2],["()",-5]),re(2,[-1,["()",-5]]),re(["()",-2],["()",-5])];let ct=Ge.map(e=>`<div>${Ar.renderToString(e.toString())}</div>`).join(`
`);ct+=`<hr>
`;let Ht=0;const Sr=[];for(const e of Ge){if(Ht<4)e.simplify();else{e._remove_brackets();const t=e.clone();Sr.push(t.simplify())}Ht++}Ge.push(...Sr);ct+=Ge.map(e=>`<div>${Ar.renderToString(e.toString())}</div>`).join(`
`);document.querySelector("#app").innerHTML=ct;
